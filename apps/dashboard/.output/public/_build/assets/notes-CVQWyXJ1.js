import{r as y,R as De,n as fu,s as qh,v as hu,w as Jh,x as ht,y as ma,j as g,z as Zh,A as Ue,E as Ei,F as pu,G as Gh,H as Qh,I as Ti,J as Yh,K as Xh,L as rl,M as sl,N as il,Q as ol,S as ep,p as tp,U as np,a as rp,t as Nn,B as Ai}from"./client-CUYRhouX.js";import{c as mu}from"./createLucideIcon-p253zKIi.js";import{S as sp}from"./search-DpXfO936.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ga=mu("Folder",ip);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ri=mu("Plus",op);function Ne(n){this.content=n}Ne.prototype={constructor:Ne,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(t||n,e):(i[s+1]=e,t&&(i[s]=t)),new Ne(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Ne(t)},addToStart:function(n,e){return new Ne([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Ne(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,e,t),new Ne(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Ne.from(n),n.size?new Ne(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Ne.from(n),n.size?new Ne(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Ne.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Ne.from=function(n){if(n instanceof Ne)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Ne(e)};function gu(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),i=e.child(r);if(s==i){t+=s.nodeSize;continue}if(!s.sameMarkup(i))return t;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)t++;return t}if(s.content.size||i.content.size){let o=gu(s.content,i.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function yu(n,e,t,r){for(let s=n.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:t,b:r};let o=n.child(--s),l=e.child(--i),a=o.nodeSize;if(o==l){t-=a,r-=a;continue}if(!o.sameMarkup(l))return{a:t,b:r};if(o.isText&&o.text!=l.text){let c=0,u=Math.min(o.text.length,l.text.length);for(;c<u&&o.text[o.text.length-c-1]==l.text[l.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||l.content.size){let c=yu(o.content,l.content,t-1,r-1);if(c)return c}t-=a,r-=a}}class k{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,i){for(let o=0,l=0;l<t;o++){let a=this.content[o],c=l+a.nodeSize;if(c>e&&r(a,s+l,i||null,o)!==!1&&a.content.size){let u=l+1;a.nodesBetween(Math.max(0,e-u),Math.min(a.content.size,t-u),r,s+u)}l=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let i="",o=!0;return this.nodesBetween(e,t,(l,a)=>{let c=l.isText?l.text.slice(Math.max(e,a)-a,t-a):l.isLeaf?s?typeof s=="function"?s(l):s:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&c||l.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new k(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let i=0,o=0;o<t;i++){let l=this.content[i],a=o+l.nodeSize;a>e&&((o<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,t-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,t-o-1))),r.push(l),s+=l.nodeSize),o=a}return new k(r,s)}cutByIndex(e,t){return e==t?k.empty:e==0&&t==this.content.length?this:new k(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new k(s,i)}addToStart(e){return new k([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new k(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return gu(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return yu(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Kr(0,e);if(e==this.size)return Kr(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,s=0;;r++){let i=this.child(r),o=s+i.nodeSize;if(o>=e)return o==e||t>0?Kr(r+1,o):Kr(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return k.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new k(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return k.empty;let t,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(t||(t=e.slice(0,s)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new k(t||e,r)}static from(e){if(!e)return k.empty;if(e instanceof k)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new k([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}k.empty=new k([],0);const Ni={index:0,offset:0};function Kr(n,e){return Ni.index=n,Ni.offset=e,Ni}function ds(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!ds(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!ds(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let re=class yo{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&ds(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let s=r.create(t.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return yo.none;if(e instanceof yo)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};re.none=[];class fs extends Error{}class O{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=bu(this.content,e+this.openStart,t);return r&&new O(r,this.openStart,this.openEnd)}removeBetween(e,t){return new O(Cu(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return O.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new O(k.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)s++;return new O(e,r,s)}}O.empty=new O(k.empty,0,0);function Cu(n,e,t){let{index:r,offset:s}=n.findIndex(e),i=n.maybeChild(r),{index:o,offset:l}=n.findIndex(t);if(s==e||i.isText){if(l!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(Cu(i.content,e-s-1,t-s-1)))}function bu(n,e,t,r){let{index:s,offset:i}=n.findIndex(e),o=n.maybeChild(s);if(i==e||o.isText)return n.cut(0,e).append(t).append(n.cut(e));let l=bu(o.content,e-i-1,t);return l&&n.replaceChild(s,o.copy(l))}function lp(n,e,t){if(t.openStart>n.depth)throw new fs("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new fs("Inconsistent open depths");return xu(n,e,t,0)}function xu(n,e,t,r){let s=n.index(r),i=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=xu(n,e,t,r+1);return i.copy(i.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,l=o.content;return Cn(o,l.cut(0,n.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=ap(t,n);return Cn(i,ku(n,o,l,e,r))}else return Cn(i,hs(n,e,r))}function vu(n,e){if(!e.type.compatibleContent(n.type))throw new fs("Cannot join "+e.type.name+" onto "+n.type.name)}function Co(n,e,t){let r=n.node(t);return vu(r,e.node(t)),r}function yn(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function lr(n,e,t,r){let s=(e||n).node(t),i=0,o=e?e.index(t):s.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(yn(n.nodeAfter,r),i++));for(let l=i;l<o;l++)yn(s.child(l),r);e&&e.depth==t&&e.textOffset&&yn(e.nodeBefore,r)}function Cn(n,e){return n.type.checkContent(e),n.copy(e)}function ku(n,e,t,r,s){let i=n.depth>s&&Co(n,e,s+1),o=r.depth>s&&Co(t,r,s+1),l=[];return lr(null,n,s,l),i&&o&&e.index(s)==t.index(s)?(vu(i,o),yn(Cn(i,ku(n,e,t,r,s+1)),l)):(i&&yn(Cn(i,hs(n,e,s+1)),l),lr(e,t,s,l),o&&yn(Cn(o,hs(t,r,s+1)),l)),lr(r,null,s,l),new k(l)}function hs(n,e,t){let r=[];if(lr(null,n,t,r),n.depth>t){let s=Co(n,e,t+1);yn(Cn(s,hs(n,e,t+1)),r)}return lr(e,null,t,r),new k(r)}function ap(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)s=e.node(i).copy(k.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class Cr{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return re.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let l=r;r=s,s=l}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new ps(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,i=t;for(let o=e;;){let{index:l,offset:a}=o.content.findIndex(i),c=i-a;if(r.push(o,l,s+a),!c||(o=o.child(l),o.isText))break;i=c-1,s+=a+1}return new Cr(t,r,i)}static resolveCached(e,t){let r=ya.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==t)return o}else ya.set(e,r=new cp);let s=r.elts[r.i]=Cr.resolve(e,t);return r.i=(r.i+1)%up,s}}class cp{constructor(){this.elts=[],this.i=0}}const up=12,ya=new WeakMap;class ps{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const dp=Object.create(null);let Zt=class bo{constructor(e,t,r,s=re.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||k.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&ds(this.attrs,t||e.defaultAttrs||dp)&&re.sameSet(this.marks,r||re.none)}copy(e=null){return e==this.content?this:new bo(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new bo(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return O.empty;let s=this.resolve(e),i=this.resolve(t),o=r?0:s.sharedDepth(t),l=s.start(o),c=s.node(o).content.cut(s.pos-l,i.pos-l);return new O(c,s.depth-o,i.depth-o)}replace(e,t,r){return lp(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return Cr.resolveCached(this,e)}resolveNoCache(e){return Cr.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),wu(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=k.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),l=o&&o.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let a=s;a<i;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=re.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!re.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=k.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};Zt.prototype.text=void 0;class ms extends Zt{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wu(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new ms(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new ms(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function wu(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class kn{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new fp(e,t);if(r.next==null)return kn.empty;let s=Su(r);r.next&&r.err("Unexpected trailing text");let i=bp(Cp(s));return xp(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let i=t;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function i(o,l){let a=o.matchFragment(e,r);if(a&&(!t||a.validEnd))return k.from(l.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(d)==-1){s.push(d);let f=i(d,l.concat(u));if(f)return f}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let l=s;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:l,next:a}=i.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!s.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:s}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}kn.empty=new kn(!0);class fp{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Su(n){let e=[];do e.push(hp(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function hp(n){let e=[];do e.push(pp(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function pp(n){let e=yp(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=mp(n,e);else break;return e}function Ca(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function mp(n,e){let t=Ca(n),r=t;return n.eat(",")&&(n.next!="}"?r=Ca(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function gp(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let i in t){let o=t[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function yp(n){if(n.eat("(")){let e=Su(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=gp(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Cp(n){let e=[[]];return s(i(n,0),t()),e;function t(){return e.push([])-1}function r(o,l,a){let c={term:a,to:l};return e[o].push(c),c}function s(o,l){o.forEach(a=>a.to=l)}function i(o,l){if(o.type=="choice")return o.exprs.reduce((a,c)=>a.concat(i(c,l)),[]);if(o.type=="seq")for(let a=0;;a++){let c=i(o.exprs[a],l);if(a==o.exprs.length-1)return c;s(c,l=t())}else if(o.type=="star"){let a=t();return r(l,a),s(i(o.expr,a),a),[r(a)]}else if(o.type=="plus"){let a=t();return s(i(o.expr,l),a),s(i(o.expr,a),a),[r(a)]}else{if(o.type=="opt")return[r(l)].concat(i(o.expr,l));if(o.type=="range"){let a=l;for(let c=0;c<o.min;c++){let u=t();s(i(o.expr,a),u),a=u}if(o.max==-1)s(i(o.expr,a),a);else for(let c=o.min;c<o.max;c++){let u=t();r(a,u),s(i(o.expr,a),u),a=u}return[r(a)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Mu(n,e){return e-n}function ba(n,e){let t=[];return r(e),t.sort(Mu);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(s);for(let o=0;o<i.length;o++){let{term:l,to:a}=i[o];!l&&t.indexOf(a)==-1&&r(a)}}}function bp(n){let e=Object.create(null);return t(ba(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:l,to:a})=>{if(!l)return;let c;for(let u=0;u<s.length;u++)s[u][0]==l&&(c=s[u][1]);ba(n,a).forEach(u=>{c||s.push([l,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new kn(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let l=s[o][1].sort(Mu);i.next.push({type:s[o][0],next:e[l.join(",")]||t(l)})}return i}}function xp(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],i=!s.validEnd,o=[];for(let l=0;l<s.next.length;l++){let{type:a,next:c}=s.next[l];o.push(a.name),i&&!(a.isText||a.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Eu(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function Tu(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function Au(n,e,t,r){for(let s in e)if(!(s in n))throw new RangeError(`Unsupported attribute ${s} for ${t} of type ${s}`);for(let s in n){let i=n[s];i.validate&&i.validate(e[s])}}function Ru(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new kp(n,r,e[r]);return t}let xa=class Nu{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Ru(e,r.attrs),this.defaultAttrs=Eu(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==kn.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Tu(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Zt(this,this.computeAttrs(e),k.from(t),re.setFrom(r))}createChecked(e=null,t,r){return t=k.from(t),this.checkContent(t),new Zt(this,this.computeAttrs(e),t,re.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=k.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),i=s&&s.fillBefore(k.empty,!0);return i?new Zt(this,e,t.append(i),re.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Au(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:re.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,o)=>r[i]=new Nu(i,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function vp(n,e,t){let r=t.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${i}`)}}class kp{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?vp(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class si{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=Ru(e,s.attrs),this.excluded=null;let i=Eu(this.attrs);this.instance=i?new re(this,i):null}create(e=null){return!e&&this.instance?this.instance:new re(this,Tu(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new si(i,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Au(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Ou{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=Ne.from(e.nodes),t.marks=Ne.from(e.marks||{}),this.nodes=xa.compile(this.spec.nodes,this),this.marks=si.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",l=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=kn.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=l=="_"?null:l?va(this,l.split(" ")):l==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:va(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof xa){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new ms(r,r.defaultAttrs,e,re.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Zt.fromJSON(this,e)}markFromJSON(e){return re.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function va(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],i=n.marks[s],o=i;if(i)t.push(i);else for(let l in n.marks){let a=n.marks[l];(s=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=a)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function wp(n){return n.tag!=null}function Sp(n){return n.style!=null}class Gt{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(s=>{if(wp(s))this.tags.push(s);else if(Sp(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new wa(this,t,!1);return r.addAll(e,re.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new wa(this,t,!0);return r.addAll(e,re.none,t.from,t.to),O.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(Tp(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(o.getAttrs){let a=o.getAttrs(t);if(a===!1)continue;o.attrs=a||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let l=t[o];if((l.priority==null?50:l.priority)<i)break}t.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Sa(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Sa(o)),o.node||o.ignore||o.mark||(o.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Gt(e,Gt.schemaRules(e)))}}const Iu={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Mp={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Du={ol:!0,ul:!0},br=1,xo=2,rs=4;function ka(n,e,t){return e!=null?(e?br:0)|(e==="full"?xo:0):n&&n.whitespace=="pre"?br|xo:t&-5}class Wr{constructor(e,t,r,s,i,o){this.type=e,this.attrs=t,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=re.none,this.match=i||(o&rs?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(k.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&br)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let t=k.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(k.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Iu.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class wa{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=t.topNode,i,o=ka(null,t.preserveWhitespace,0)|(r?rs:0);s?i=new Wr(s.type,s.attrs,re.none,!0,t.topMatch||s.type.contentMatch,o):r?i=new Wr(null,null,re.none,!0,null,o):i=new Wr(e.schema.topNodeType,null,re.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,s=this.top,i=s.options&xo?"full":this.localPreserveWS||(s.options&br)>0;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)i!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=s.content[s.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;Du.hasOwnProperty(o)&&this.parser.normalizeLists&&Ep(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(a?a.ignore:Mp.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let c,u=this.needsBlock;if(Iu.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let d=a&&a.skip?t:this.readStyles(e,t);d&&this.addAll(e,d),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,a,c,a.consuming===!1?l:void 0)}this.localPreserveWS=s}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let l=void 0;;){let a=this.parser.matchStyle(i,o,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?t=t.filter(c=>!a.clearMark(c)):t=t.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return t}addElementByRule(e,t,r,s){let i,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let a=this.enter(o,t.attrs||null,r,t.preserveWhitespace);a&&(i=!0,r=a)}else{let a=this.parser.schema.marks[t.mark];r=r.concat(a.create(t.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r,!1));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a,r),this.findAround(e,a,!1)}i&&this.sync(l)&&this.open--}addAll(e,t,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,l=s==null?null:e.childNodes[s];o!=l;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,t);this.findAtPoint(e,i)}findPlace(e,t,r){let s,i;for(let o=this.open,l=0;o>=0;o--){let a=this.nodes[o],c=a.findWrapping(e);if(c&&(!s||s.length>c.length+l)&&(s=c,i=a,!c.length))break;if(a.solid){if(r)break;l+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)t=this.enterInner(s[o],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let s=this.findPlace(e,t,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=re.none;for(let l of s.concat(e.marks))(i.type?i.type.allowsMarkType(l.type):Ma(l.type,e.type))&&(o=l.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,s){let i=this.findPlace(e.create(t),r,!1);return i&&(i=this.enterInner(e,t,r,!0,s)),i}enterInner(e,t,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=ka(e,i,o.options);o.options&rs&&o.content.length==0&&(l|=rs);let a=re.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):Ma(c.type,e))?(a=c.addToSet(a),!1):!0),this.nodes.push(new Wr(e,t,a,s,null,l)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=br)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(l,a)=>{for(;l>=0;l--){let c=t[l];if(c==""){if(l==t.length-1||l==0)continue;for(;a>=i;a--)if(o(l-1,a))return!0;return!1}else{let u=a>0||a==0&&s?this.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;a--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function Ep(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Du.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function Tp(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Sa(n){let e={};for(let t in n)e[t]=n[t];return e}function Ma(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let i=[],o=l=>{i.push(l);for(let a=0;a<l.edgeCount;a++){let{type:c,next:u}=l.edge(a);if(c==e||i.indexOf(u)<0&&o(u))return!0}};if(o(s.contentMatch))return!0}}class An{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Oi(t).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let l=0,a=0;for(;l<i.length&&a<o.marks.length;){let c=o.marks[a];if(!this.marks[c.type.name]){a++;continue}if(!c.eq(i[l][0])||c.type.spec.spanning===!1)break;l++,a++}for(;l<i.length;)s=i.pop()[1];for(;a<o.marks.length;){let c=o.marks[a++],u=this.serializeMark(c,o.isInline,t);u&&(i.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=ss(Oi(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&ss(Oi(r),s(e,t),null,e.attrs)}static renderSpec(e,t,r=null,s){return ss(e,t,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new An(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Ea(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Ea(e.marks)}}function Ea(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Oi(n){return n.document||window.document}const Ta=new WeakMap;function Ap(n){let e=Ta.get(n);return e===void 0&&Ta.set(n,e=Rp(n)),e}function Rp(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)t(r[s]);else for(let s in r)t(r[s])}return t(n),e}function ss(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=Ap(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(t=s.slice(0,o),s=s.slice(o+1));let l,a=t?n.createElementNS(t,s):n.createElement(s),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let f=d.indexOf(" ");f>0?a.setAttributeNS(d.slice(0,f),d.slice(f+1),c[d]):a.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let f=e[d];if(f===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:h,contentDOM:p}=ss(n,f,t,r);if(a.appendChild(h),p){if(l)throw new RangeError("Multiple content holes");l=p}}}return{dom:a,contentDOM:l}}const Lu=65535,Pu=Math.pow(2,16);function Np(n,e){return n+e*Pu}function Aa(n){return n&Lu}function Op(n){return(n-(n&Lu))/Pu}const ju=1,Bu=2,is=4,Hu=8;class vo{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Hu)>0}get deletedBefore(){return(this.delInfo&(ju|is))>0}get deletedAfter(){return(this.delInfo&(Bu|is))>0}get deletedAcross(){return(this.delInfo&is)>0}}class nt{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&nt.empty)return nt.empty}recover(e){let t=0,r=Aa(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+Op(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?s:0);if(a>e)break;let c=this.ranges[l+i],u=this.ranges[l+o],d=a+c;if(e<=d){let f=c?e==a?-1:e==d?1:t:t,h=a+s+(f<0?0:u);if(r)return h;let p=e==(t<0?a:d)?null:Np(l/3,e-a),m=e==a?Bu:e==d?ju:is;return(t<0?e!=a:e!=d)&&(m|=Hu),new vo(h,m,p)}s+=u-c}return r?e+s:new vo(e+s,0,null)}touches(e,t){let r=0,s=Aa(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let c=this.ranges[l+i],u=a+c;if(e<=u&&l==s*3)return!0;r+=this.ranges[l+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],l=o-(this.inverted?i:0),a=o+(this.inverted?0:i),c=this.ranges[s+t],u=this.ranges[s+r];e(l,l+c,a,a+u),i+=u-c}}invert(){return new nt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?nt.empty:new nt(e<0?[0,-e,0]:[0,0,e])}}nt.empty=new nt([]);class xr{constructor(e,t,r=0,s=e?e.length:0){this.mirror=t,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new xr(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let s=e.getMirror(t);this.appendMap(e._maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e._maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new xr;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],l=o.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(i);if(a!=null&&a>i&&a<this.to){i=a,e=this._maps[a].recover(l.recover);continue}}s|=l.delInfo,e=l.pos}return r?e:new vo(e,s,null)}}const Ii=Object.create(null);class Ve{getMap(){return nt.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ii[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ii)throw new RangeError("Duplicate use of step JSON ID "+e);return Ii[e]=t,t.prototype.jsonID=e,t}}class ve{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ve(e,null)}static fail(e){return new ve(null,e)}static fromReplace(e,t,r,s){try{return ve.ok(e.replace(t,r,s))}catch(i){if(i instanceof fs)return ve.fail(i.message);throw i}}}function ll(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(ll(i.content,e,i))),i.isInline&&(i=e(i,t,s)),r.push(i)}return k.fromArray(r)}class _t extends Ve{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new O(ll(t.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return ve.fromReplace(e,this.from,this.to,i)}invert(){return new vt(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new _t(t.pos,r.pos,this.mark)}merge(e){return e instanceof _t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new _t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new _t(t.from,t.to,e.markFromJSON(t.mark))}}Ve.jsonID("addMark",_t);class vt extends Ve{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new O(ll(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return ve.fromReplace(e,this.from,this.to,r)}invert(){return new _t(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new vt(t.pos,r.pos,this.mark)}merge(e){return e instanceof vt&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new vt(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new vt(t.from,t.to,e.markFromJSON(t.mark))}}Ve.jsonID("removeMark",vt);class qt extends Ve{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ve.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ve.fromReplace(e,this.pos,this.pos+1,new O(k.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new qt(this.pos,t.marks[s]);return new qt(this.pos,this.mark)}}return new wn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new qt(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new qt(t.pos,e.markFromJSON(t.mark))}}Ve.jsonID("addNodeMark",qt);class wn extends Ve{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ve.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ve.fromReplace(e,this.pos,this.pos+1,new O(k.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new qt(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new wn(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new wn(t.pos,e.markFromJSON(t.mark))}}Ve.jsonID("removeNodeMark",wn);class Se extends Ve{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&ko(e,this.from,this.to)?ve.fail("Structure replace would overwrite content"):ve.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new nt([this.from,this.to-this.from,this.slice.size])}invert(e){return new Se(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Se(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Se)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?O.empty:new O(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Se(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?O.empty:new O(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Se(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Se(t.from,t.to,O.fromJSON(e,t.slice),!!t.structure)}}Ve.jsonID("replace",Se);class Me extends Ve{constructor(e,t,r,s,i,o,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=l}apply(e){if(this.structure&&(ko(e,this.from,this.gapFrom)||ko(e,this.gapTo,this.to)))return ve.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ve.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?ve.fromReplace(e,this.from,this.to,r):ve.fail("Content does not fit in gap")}getMap(){return new nt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Me(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||i>r.pos?null:new Me(t.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Me(t.from,t.to,t.gapFrom,t.gapTo,O.fromJSON(e,t.slice),t.insert,!!t.structure)}}Ve.jsonID("replaceAround",Me);function ko(n,e,t){let r=n.resolve(e),s=t-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function Ip(n,e,t,r){let s=[],i=[],o,l;n.doc.nodesBetween(e,t,(a,c,u)=>{if(!a.isInline)return;let d=a.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),h=Math.min(c+a.nodeSize,t),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(o&&o.to==f&&o.mark.eq(d[m])?o.to=h:s.push(o=new vt(f,h,d[m])));l&&l.to==f?l.to=h:i.push(l=new _t(f,h,r))}}),s.forEach(a=>n.step(a)),i.forEach(a=>n.step(a))}function Dp(n,e,t,r){let s=[],i=0;n.doc.nodesBetween(e,t,(o,l)=>{if(!o.isInline)return;i++;let a=null;if(r instanceof si){let c=o.marks,u;for(;u=r.isInSet(c);)(a||(a=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(a=[r]):a=o.marks;if(a&&a.length){let c=Math.min(l+o.nodeSize,t);for(let u=0;u<a.length;u++){let d=a[u],f;for(let h=0;h<s.length;h++){let p=s[h];p.step==i-1&&d.eq(s[h].style)&&(f=p)}f?(f.to=c,f.step=i):s.push({style:d,from:Math.max(l,e),to:c,step:i})}}}),s.forEach(o=>n.step(new vt(o.from,o.to,o.style)))}function al(n,e,t,r=t.contentMatch,s=!0){let i=n.doc.nodeAt(e),o=[],l=e+1;for(let a=0;a<i.childCount;a++){let c=i.child(a),u=l+c.nodeSize,d=r.matchType(c.type);if(!d)o.push(new Se(l,u,O.empty));else{r=d;for(let f=0;f<c.marks.length;f++)t.allowsMarkType(c.marks[f].type)||n.step(new vt(l,u,c.marks[f]));if(s&&c.isText&&t.whitespace!="pre"){let f,h=/\r?\n|\r/g,p;for(;f=h.exec(c.text);)p||(p=new O(k.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new Se(l+f.index,l+f.index+f[0].length,p))}}l=u}if(!r.validEnd){let a=r.fillBefore(k.empty,!0);n.replace(l,l,new O(a,0,0))}for(let a=o.length-1;a>=0;a--)n.step(o[a])}function Lp(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Zn(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),i=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(i,o,t))return r;if(r==0||s.type.spec.isolating||!Lp(s,i,o))break}return null}function Pp(n,e,t){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),l=s.after(i+1),a=o,c=l,u=k.empty,d=0;for(let p=i,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,u=k.from(r.node(p).copy(u)),d++):a--;let f=k.empty,h=0;for(let p=i,m=!1;p>t;p--)m||s.after(p+1)<s.end(p)?(m=!0,f=k.from(s.node(p).copy(f)),h++):c++;n.step(new Me(a,c,o,l,new O(u.append(f),d,h),u.size-d,!0))}function cl(n,e,t=null,r=n){let s=jp(n,e),i=s&&Bp(r,e);return i?s.map(Ra).concat({type:e,attrs:t}).concat(i.map(Ra)):null}function Ra(n){return{type:n,attrs:null}}function jp(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(r,s,o)?i:null}function Bp(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;a&&c<s;c++)a=a.matchType(t.child(c).type);return!a||!a.validEnd?null:o}function Hp(n,e,t){let r=k.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let l=t[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=k.from(t[o].type.create(t[o].attrs,r))}let s=e.start,i=e.end;n.step(new Me(s,i,s,i,new O(r,0,0),t.length,!0))}function Fp(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,l)=>{let a=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,a)&&Vp(n.doc,n.mapping.slice(i).map(l),r)){let c=null;if(r.schema.linebreakReplacement){let h=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);h&&!p?c=!1:!h&&p&&(c=!0)}c===!1&&Vu(n,o,l,i),al(n,n.mapping.slice(i).map(l,1),r,void 0,c===null);let u=n.mapping.slice(i),d=u.map(l,1),f=u.map(l+o.nodeSize,1);return n.step(new Me(d,f,d+1,f-1,new O(k.from(r.create(a,null,o.marks)),0,0),1,!0)),c===!0&&Fu(n,o,l,i),!1}})}function Fu(n,e,t,r){e.forEach((s,i)=>{if(s.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(s.text);){let a=n.mapping.slice(r).map(t+1+i+o.index);n.replaceWith(a,a+1,e.type.schema.linebreakReplacement.create())}}})}function Vu(n,e,t,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function Vp(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function zp(n,e,t,r,s){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new Me(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new O(k.from(o),0,0),1,!0))}function Dt(n,e,t=1,r){let s=n.resolve(e),i=s.depth-t,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=t-2;c>i;c--,u--){let d=s.node(c),f=s.index(c);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(f,d.childCount),p=r&&r[u+1];p&&(h=h.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||d;if(!d.canReplace(f+1,d.childCount)||!m.type.validContent(h))return!1}let l=s.indexAfter(i),a=r&&r[0];return s.node(i).canReplaceWith(l,l,a?a.type:s.node(i+1).type)}function $p(n,e,t=1,r){let s=n.doc.resolve(e),i=k.empty,o=k.empty;for(let l=s.depth,a=s.depth-t,c=t-1;l>a;l--,c--){i=k.from(s.node(l).copy(i));let u=r&&r[c];o=k.from(u?u.type.create(u.attrs,o):s.node(l).copy(o))}n.step(new Se(e,e,new O(i.append(o),t,t),!0))}function nn(n,e){let t=n.resolve(e),r=t.index();return zu(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function Kp(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?n.type.schema.nodes.text:i.type;if(t=t.matchType(o),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function zu(n,e){return!!(n&&e&&!n.isLeaf&&Kp(n,e))}function ii(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let i,o,l=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):t>0?(i=r.node(s+1),l++,o=r.node(s).maybeChild(l)):(i=r.node(s).maybeChild(l-1),o=r.node(s+1)),i&&!i.isTextblock&&zu(i,o)&&r.node(s).canReplace(l,l+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function Wp(n,e,t){let r=null,{linebreakReplacement:s}=n.doc.type.schema,i=n.doc.resolve(e-t),o=i.node().type;if(s&&o.inlineContent){let u=o.whitespace=="pre",d=!!o.contentMatch.matchType(s);u&&!d?r=!1:!u&&d&&(r=!0)}let l=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);Vu(n,u.node(),u.before(),l)}o.inlineContent&&al(n,e+t-1,o,i.node().contentMatchAt(i.index()),r==null);let a=n.mapping.slice(l),c=a.map(e-t);if(n.step(new Se(c,a.map(e+t,-1),O.empty,!0)),r===!0){let u=n.doc.resolve(c);Fu(n,u.node(),u.before(),n.steps.length)}return n}function Up(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,t))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,t))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function $u(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let i=0;i<t.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,a=r.index(o)+(l>0?1:0),c=r.node(o),u=!1;if(i==1)u=c.canReplace(a,a,s);else{let d=c.contentMatchAt(a).findWrapping(s.firstChild.type);u=d&&c.canReplaceWith(a,a,d[0])}if(u)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function oi(n,e,t=e,r=O.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),i=n.resolve(t);return Ku(s,i,r)?new Se(e,t,r):new _p(s,i,r).fit()}function Ku(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class _p{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=k.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=k.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,l=s.depth;for(;o&&l&&i.childCount==1;)i=i.firstChild.content,o--,l--;let a=new O(i,o,l);return e>-1?new Me(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new Se(r.pos,s.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=Di(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:c}=this.frontier[l],u,d=null;if(t==1&&(o?c.matchType(o.type)||(d=c.fillBefore(k.from(o),!1)):i&&a.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:l,parent:i,inject:d};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Di(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new O(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Di(e,t);if(s.childCount<=1&&t>0){let i=e.size-t<=t+s.size;this.unplaced=new O(nr(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new O(nr(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let o=this.unplaced,l=r?r.content:o.content,a=o.openStart-e,c=0,u=[],{match:d,type:f}=this.frontier[t];if(s){for(let m=0;m<s.childCount;m++)u.push(s.child(m));d=d.matchFragment(s)}let h=l.size+e-(o.content.size-o.openEnd);for(;c<l.childCount;){let m=l.child(c),C=d.matchType(m.type);if(!C)break;c++,(c>1||a==0||m.content.size)&&(d=C,u.push(Wu(m.mark(f.allowedMarks(m.marks)),c==1?a:0,c==l.childCount?h:-1)))}let p=c==l.childCount;p||(h=-1),this.placed=rr(this.placed,t,k.from(u)),this.frontier[t].match=d,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,C=l;m<h;m++){let b=C.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),C=b.content}this.unplaced=p?e==0?O.empty:new O(nr(o.content,e-1,1),e-1,h<0?o.openEnd:e-1):new O(nr(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Li(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=Li(e,t,s,r,i);if(o){for(let l=t-1;l>=0;l--){let{match:a,type:c}=this.frontier[l],u=Li(e,l,c,a,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=rr(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=rr(this.placed,this.depth,k.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(k.empty,!0);t.childCount&&(this.placed=rr(this.placed,this.frontier.length,t))}}function nr(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(nr(n.firstChild.content,e-1,t)))}function rr(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(rr(n.lastChild.content,e-1,t)))}function Di(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Wu(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Wu(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(k.empty,!0)))),n.copy(r)}function Li(n,e,t,r,s){let i=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let l=r.fillBefore(i.content,!0,o);return l&&!qp(t,i.content,o)?l:null}function qp(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function Jp(n){return n.spec.defining||n.spec.definingForContent}function Zp(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),i=n.doc.resolve(t);if(Ku(s,i,r))return n.step(new Se(e,t,r));let o=_u(s,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let l=-(s.depth+1);o.unshift(l);for(let f=s.depth,h=s.pos-1;f>0;f--,h--){let p=s.node(f).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(f)>-1?l=f:s.before(f)==h&&o.splice(1,0,-f)}let a=o.indexOf(l),c=[],u=r.openStart;for(let f=r.content,h=0;;h++){let p=f.firstChild;if(c.push(p),h==r.openStart)break;f=p.content}for(let f=u-1;f>=0;f--){let h=c[f],p=Jp(h.type);if(p&&!h.sameMarkup(s.node(Math.abs(l)-1)))u=f;else if(p||!h.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let h=(f+u+1)%(r.openStart+1),p=c[h];if(p)for(let m=0;m<o.length;m++){let C=o[(m+a)%o.length],b=!0;C<0&&(b=!1,C=-C);let v=s.node(C-1),x=s.index(C-1);if(v.canReplaceWith(x,x,p.type,p.marks))return n.replace(s.before(C),b?i.after(C):t,new O(Uu(r.content,0,r.openStart,h),h,r.openEnd))}}let d=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let h=o[f];h<0||(e=s.before(h),t=i.after(h))}}function Uu(n,e,t,r,s){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(Uu(i.content,e+1,t,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(k.empty,!0))}return n}function Gp(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=Up(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new O(k.from(r),0,0))}function Qp(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),i=_u(r,s);for(let o=0;o<i.length;o++){let l=i[o],a=o==i.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),s.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),s.indexAfter(l-1))))return n.delete(r.before(l),s.after(l))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return n.delete(r.before(o),t);n.delete(e,t)}function _u(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&t.push(s)}return t}class Hn extends Ve{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return ve.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return ve.fromReplace(e,this.pos,this.pos+1,new O(k.from(s),0,t.isLeaf?0:1))}getMap(){return nt.empty}invert(e){return new Hn(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Hn(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Hn(t.pos,t.attr,t.value)}}Ve.jsonID("attr",Hn);class vr extends Ve{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return ve.ok(r)}getMap(){return nt.empty}invert(e){return new vr(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new vr(t.attr,t.value)}}Ve.jsonID("docAttr",vr);let $n=class extends Error{};$n=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};$n.prototype=Object.create(Error.prototype);$n.prototype.constructor=$n;$n.prototype.name="TransformError";class qu{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new xr}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new $n(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=O.empty){let s=oi(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new O(k.from(r),0,0))}delete(e,t){return this.replace(e,t,O.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return Zp(this,e,t,r),this}replaceRangeWith(e,t,r){return Gp(this,e,t,r),this}deleteRange(e,t){return Qp(this,e,t),this}lift(e,t){return Pp(this,e,t),this}join(e,t=1){return Wp(this,e,t),this}wrap(e,t){return Hp(this,e,t),this}setBlockType(e,t=e,r,s=null){return Fp(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return zp(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new Hn(e,t,r)),this}setDocAttribute(e,t){return this.step(new vr(e,t)),this}addNodeMark(e,t){return this.step(new qt(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof re)t.isInSet(r.marks)&&this.step(new wn(e,t));else{let s=r.marks,i,o=[];for(;i=t.isInSet(s);)o.push(new wn(e,i)),s=i.removeFromSet(s);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,t=1,r){return $p(this,e,t,r),this}addMark(e,t,r){return Ip(this,e,t,r),this}removeMark(e,t,r){return Dp(this,e,t,r),this}clearIncompatible(e,t,r){return al(this,e,t,r),this}}const Pi=Object.create(null);let K=class{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new Yp(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=O.empty){let r=t.content.lastChild,s=null;for(let l=0;l<t.openEnd;l++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:c}=o[l],u=e.mapping.slice(i);e.replaceRange(u.map(a.pos),u.map(c.pos),l?O.empty:t),l==0&&Ia(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:l}=s[i],a=e.mapping.slice(r),c=a.map(o.pos),u=a.map(l.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Ia(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new $(e):Dn(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=t<0?Dn(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):Dn(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new st(e.node(0))}static atStart(e){return Dn(e,e,0,0,1)||new st(e)}static atEnd(e){return Dn(e,e,e.content.size,e.childCount,-1)||new st(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Pi[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Pi)throw new RangeError("Duplicate use of selection JSON ID "+e);return Pi[e]=t,t.prototype.jsonID=e,t}getBookmark(){return $.between(this.$anchor,this.$head).getBookmark()}};K.prototype.visible=!0;class Yp{constructor(e,t){this.$from=e,this.$to=t}}let Na=!1;function Oa(n){!Na&&!n.parent.inlineContent&&(Na=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class $ extends K{constructor(e,t=e){Oa(e),Oa(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return K.near(r);let s=e.resolve(t.map(this.anchor));return new $(s.parent.inlineContent?s:r,r)}replace(e,t=O.empty){if(super.replace(e,t),t==O.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof $&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new li(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new $(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let i=K.findFrom(t,r,!0)||K.findFrom(t,-r,!0);if(i)t=i.$head;else return K.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(K.findFrom(e,-r,!0)||K.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new $(e,t)}}K.jsonID("text",$);class li{constructor(e,t){this.anchor=e,this.head=t}map(e){return new li(e.map(this.anchor),e.map(this.head))}resolve(e){return $.between(e.resolve(this.anchor),e.resolve(this.head))}}class B extends K{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),i=e.resolve(s);return r?K.near(i):new B(i)}content(){return new O(k.from(this.node),0,0)}eq(e){return e instanceof B&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ul(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new B(e.resolve(t.anchor))}static create(e,t){return new B(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}B.prototype.visible=!1;K.jsonID("node",B);class ul{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new li(r,r):new ul(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&B.isSelectable(r)?new B(t):K.near(t)}}class st extends K{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=O.empty){if(t==O.empty){e.delete(0,e.doc.content.size);let r=K.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new st(e)}map(e){return new st(e)}eq(e){return e instanceof st}getBookmark(){return Xp}}K.jsonID("all",st);const Xp={map(){return this},resolve(n){return new st(n)}};function Dn(n,e,t,r,s,i=!1){if(e.inlineContent)return $.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let l=e.child(o);if(l.isAtom){if(!i&&B.isSelectable(l))return B.create(n,t-(s<0?l.nodeSize:0))}else{let a=Dn(n,l,t+s,s<0?l.childCount:0,s,i);if(a)return a}t+=l.nodeSize*s}return null}function Ia(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof Se||s instanceof Me))return;let i=n.mapping.maps[r],o;i.forEach((l,a,c,u)=>{o==null&&(o=u)}),n.setSelection(K.near(n.doc.resolve(o),t))}const Da=1,La=2,Pa=4;class e1 extends qu{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Da)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&Da)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=La,this}ensureMarks(e){return re.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&La)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||re.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,i)),this.selection.empty||this.setSelection(K.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Pa,this}get scrolledIntoView(){return(this.updated&Pa)>0}}function ja(n,e){return!e||!n?n:n.bind(e)}class sr{constructor(e,t,r){this.name=e,this.init=ja(t.init,r),this.apply=ja(t.apply,r)}}const t1=[new sr("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new sr("selection",{init(n,e){return n.selection||K.atStart(e.doc)},apply(n){return n.selection}}),new sr("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new sr("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class ji{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=t1.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new sr(r.key,r.spec.state,r))})}}class jn{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let a=s?s[o].n:0,c=s?s[o].state:this,u=a<t.length&&l.spec.appendTransaction.call(l,a?t.slice(a):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!s){s=[];for(let d=0;d<this.config.plugins.length;d++)s.push(d<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}s&&(s[o]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new jn(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new e1(this)}static create(e){let t=new ji(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new jn(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new ji(this.schema,e.plugins),r=t.fields,s=new jn(t);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new ji(e.schema,e.plugins),i=new jn(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=Zt.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=K.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],c=a.spec.state;if(a.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){i[o.name]=c.fromJSON.call(a,e,t[l],i);return}}i[o.name]=o.init(e,i)}}),i}}function Ju(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=Ju(s,e,{})),t[r]=s}return t}class ke{constructor(e){this.spec=e,this.props={},e.props&&Ju(e.props,this,this.props),this.key=e.key?e.key.key:Zu("plugin")}getState(e){return e[this.key]}}const Bi=Object.create(null);function Zu(n){return n in Bi?n+"$"+ ++Bi[n]:(Bi[n]=0,n+"$")}class Ze{constructor(e="key"){this.key=Zu(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Le=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Kn=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let wo=null;const Nt=function(n,e,t){let r=wo||(wo=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},n1=function(){wo=null},Sn=function(n,e,t,r){return t&&(Ba(n,e,t,r,-1)||Ba(n,e,t,r,1))},r1=/^(img|br|input|textarea|hr)$/i;function Ba(n,e,t,r,s){for(var i;;){if(n==t&&e==r)return!0;if(e==(s<0?0:ut(n))){let o=n.parentNode;if(!o||o.nodeType!=1||Nr(n)||r1.test(n.nodeName)||n.contentEditable=="false")return!1;e=Le(n)+(s<0?0:1),n=o}else if(n.nodeType==1){let o=n.childNodes[e+(s<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((i=o.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=s;else return!1;else n=o,e=s<0?ut(n):0}else return!1}}function ut(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function s1(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=ut(n)}else if(n.parentNode&&!Nr(n))e=Le(n),n=n.parentNode;else return null}}function i1(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Nr(n))e=Le(n)+1,n=n.parentNode;else return null}}function o1(n,e,t){for(let r=e==0,s=e==ut(n);r||s;){if(n==t)return!0;let i=Le(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==ut(n)}}function Nr(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const ai=function(n){return n.focusNode&&Sn(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function dn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function l1(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function a1(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(ut(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(ut(r.startContainer),r.startOffset)}}}const kt=typeof navigator<"u"?navigator:null,Ha=typeof document<"u"?document:null,rn=kt&&kt.userAgent||"",So=/Edge\/(\d+)/.exec(rn),Gu=/MSIE \d/.exec(rn),Mo=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(rn),Xe=!!(Gu||Mo||So),Qt=Gu?document.documentMode:Mo?+Mo[1]:So?+So[1]:0,mt=!Xe&&/gecko\/(\d+)/i.test(rn);mt&&+(/Firefox\/(\d+)/.exec(rn)||[0,0])[1];const Eo=!Xe&&/Chrome\/(\d+)/.exec(rn),Fe=!!Eo,Qu=Eo?+Eo[1]:0,_e=!Xe&&!!kt&&/Apple Computer/.test(kt.vendor),Wn=_e&&(/Mobile\/\w+/.test(rn)||!!kt&&kt.maxTouchPoints>2),ct=Wn||(kt?/Mac/.test(kt.platform):!1),c1=kt?/Win/.test(kt.platform):!1,It=/Android \d/.test(rn),Or=!!Ha&&"webkitFontSmoothing"in Ha.documentElement.style,u1=Or?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function d1(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Et(n,e){return typeof n=="number"?n:n[e]}function f1(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function Fa(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;){if(o.nodeType!=1){o=Kn(o);continue}let l=o,a=l==i.body,c=a?d1(i):f1(l),u=0,d=0;if(e.top<c.top+Et(r,"top")?d=-(c.top-e.top+Et(s,"top")):e.bottom>c.bottom-Et(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Et(s,"top")-c.top:e.bottom-c.bottom+Et(s,"bottom")),e.left<c.left+Et(r,"left")?u=-(c.left-e.left+Et(s,"left")):e.right>c.right-Et(r,"right")&&(u=e.right-c.right+Et(s,"right")),u||d)if(a)i.defaultView.scrollBy(u,d);else{let h=l.scrollLeft,p=l.scrollTop;d&&(l.scrollTop+=d),u&&(l.scrollLeft+=u);let m=l.scrollLeft-h,C=l.scrollTop-p;e={left:e.left-m,top:e.top-C,right:e.right-m,bottom:e.bottom-C}}let f=a?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(f))break;o=f=="absolute"?o.offsetParent:Kn(o)}}function h1(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=n.root.elementFromPoint(i,o);if(!l||l==n.dom||!n.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=t-20){r=l,s=a.top;break}}return{refDOM:r,refTop:s,stack:Yu(n.dom)}}function Yu(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Kn(r));return e}function p1({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Xu(t,r==0?0:r-e)}function Xu(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:i}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let On=null;function m1(n){if(n.setActive)return n.setActive();if(On)return n.focus(On);let e=Yu(n);n.focus(On==null?{get preventScroll(){return On={preventScroll:!0},!0}}:void 0),On||(On=!1,Xu(e,0))}function ed(n,e){let t,r=2e8,s,i=0,o=e.top,l=e.top,a,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=Nt(u).getClientRects();else continue;for(let h=0;h<f.length;h++){let p=f[h];if(p.top<=o&&p.bottom>=l){o=Math.max(p.bottom,o),l=Math.min(p.top,l);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=u,r=m,s=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&m&&(i=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!a&&p.left<=e.left&&p.right>=e.left&&(a=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(i=d+1)}}return!t&&a&&(t=a,s=c,r=0),t&&t.nodeType==3?g1(t,s):!t||r&&t.nodeType==1?{node:n,offset:i}:ed(t,s)}function g1(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let i=Bt(r,1);if(i.top!=i.bottom&&dl(e,i))return{node:n,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function dl(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function y1(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function C1(n,e,t){let{node:r,offset:s}=ed(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function b1(n,e,t,r){let s=-1;for(let i=e,o=!1;i!=n.dom;){let l=n.docView.nearestDesc(i,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&(!o&&a.left>r.left||a.top>r.top?s=l.posBefore:(!o&&a.right<r.left||a.bottom<r.top)&&(s=l.posAfter),o=!0),!l.contentDOM&&s<0&&!l.node.isText))return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;i=l.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function td(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let l=o.getClientRects();for(let a=0;a<l.length;a++){let c=l[a];if(dl(e,c))return td(o,e,c)}}if((i=(i+1)%r)==s)break}return n}function x1(n,e){let t=n.dom.ownerDocument,r,s=0,i=a1(t,e.left,e.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),l;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!dl(e,c)||(o=td(n.dom,e,c),!o))return null}if(_e)for(let c=o;r&&c;c=Kn(c))c.draggable&&(r=void 0);if(o=y1(o,e),r){if(mt&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&s++}let c;Or&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(l=b1(n,r,s,e))}l==null&&(l=C1(n,o,e));let a=n.docView.nearestDesc(o,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function Va(n){return n.top<n.bottom||n.left<n.right}function Bt(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Va(r))return r}return Array.prototype.find.call(t,Va)||n.getBoundingClientRect()}const v1=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function nd(n,e,t){let{node:r,offset:s,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=Or||mt;if(r.nodeType==3)if(o&&(v1.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let a=Bt(Nt(r,s,s),t);if(mt&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=Bt(Nt(r,s-1,s-1),-1);if(c.top==a.top){let u=Bt(Nt(r,s,s+1),-1);if(u.top!=a.top)return Xn(u,u.left<c.left)}}return a}else{let a=s,c=s,u=t<0?1:-1;return t<0&&!s?(c++,u=-1):t>=0&&s==r.nodeValue.length?(a--,u=1):t<0?a--:c++,Xn(Bt(Nt(r,a,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(t<0||s==ut(r))){let a=r.childNodes[s-1];if(a.nodeType==1)return Hi(a.getBoundingClientRect(),!1)}if(i==null&&s<ut(r)){let a=r.childNodes[s];if(a.nodeType==1)return Hi(a.getBoundingClientRect(),!0)}return Hi(r.getBoundingClientRect(),t>=0)}if(i==null&&s&&(t<0||s==ut(r))){let a=r.childNodes[s-1],c=a.nodeType==3?Nt(a,ut(a)-(o?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(c)return Xn(Bt(c,1),!1)}if(i==null&&s<ut(r)){let a=r.childNodes[s];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let c=a?a.nodeType==3?Nt(a,0,o?0:1):a.nodeType==1?a:null:null;if(c)return Xn(Bt(c,-1),!0)}return Xn(Bt(r.nodeType==3?Nt(r):r,-t),t>=0)}function Xn(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Hi(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function rd(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function k1(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return rd(n,e,()=>{let{node:i}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(i,!0);if(!l)break;if(l.node.isBlock){i=l.contentDOM||l.dom;break}i=l.dom.parentNode}let o=nd(n,s.pos,1);for(let l=i.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Nt(l,0,l.nodeValue.length).getClientRects();else continue;for(let c=0;c<a.length;c++){let u=a[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const w1=/[\u0590-\u08ac]/;function S1(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,l=n.domSelection();return l?!w1.test(r.parent.textContent)||!l.modify?t=="left"||t=="backward"?i:o:rd(n,e,()=>{let{focusNode:a,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),f=l.caretBidiLevel;l.modify("move",t,"character");let h=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),C=p&&!h.contains(p.nodeType==1?p:p.parentNode)||a==p&&c==m;try{l.collapse(u,d),a&&(a!=u||c!=d)&&l.extend&&l.extend(a,c)}catch{}return f!=null&&(l.caretBidiLevel=f),C}):r.pos==r.start()||r.pos==r.end()}let za=null,$a=null,Ka=!1;function M1(n,e,t){return za==e&&$a==t?Ka:(za=e,$a=t,Ka=t=="up"||t=="down"?k1(n,e,t):S1(n,e,t))}const dt=0,Wa=1,hn=2,wt=3;class Ir{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=dt,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>Le(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!t||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let l=s.children[o];if(l.size){s=l;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],l=i+o.size;if(l>e||o instanceof id){s=e-i;break}i=l}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof sd&&i.side>=0;r--);if(t<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?Le(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?Le(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,l=0;;l++){let a=this.children[l],c=o+a.size;if(s==-1&&e<=c){let u=o+a.border;if(e>=u&&t<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,u);e=o;for(let d=l;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){s=Le(f.dom)+1;break}e-=f.size}s==-1&&(s=0)}if(s>-1&&(c>t||l==this.children.length-1)){t=c;for(let u=l+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=Le(d.dom);break}t+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let h=0,p=0;h<this.children.length;h++){let m=this.children[h],C=p+m.size;if(i>p&&o<C)return m.setSelection(e-p-m.border,t-p-m.border,r,s);p=C}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((mt||_e)&&e==t){let{node:h,offset:p}=l;if(h.nodeType==3){if(d=!!(p&&h.nodeValue[p-1]==`
`),d&&p==h.nodeValue.length)for(let m=h,C;m;m=m.parentNode){if(C=m.nextSibling){C.nodeName=="BR"&&(l=a={node:C.parentNode,offset:Le(C)+1});break}let b=m.pmViewDesc;if(b&&b.node&&b.node.isBlock)break}}else{let m=h.childNodes[p-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(mt&&u.focusNode&&u.focusNode!=a.node&&u.focusNode.nodeType==1){let h=u.focusNode.childNodes[u.focusOffset];h&&h.contentEditable=="false"&&(s=!0)}if(!(s||d&&_e)&&Sn(l.node,l.offset,u.anchorNode,u.anchorOffset)&&Sn(a.node,a.offset,u.focusNode,u.focusOffset))return;let f=!1;if((c.extend||e==t)&&!d){c.collapse(l.node,l.offset);try{e!=t&&c.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>t){let p=l;l=a,a=p}let h=document.createRange();h.setEnd(a.node,a.offset),h.setStart(l.node,l.offset),c.removeAllRanges(),c.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let l=r+i.border,a=o-i.border;if(e>=l&&t<=a){this.dirty=e==r||t==o?hn:Wa,e==l&&t==a&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=wt:i.markDirty(e-l,t-l);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?hn:wt}r=o}this.dirty=hn}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?hn:Wa;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class sd extends Ir{constructor(e,t,r,s){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==dt&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class E1 extends Ir{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Mn extends Ir{constructor(e,t,r,s,i){super(e,[],r,s),this.mark=t,this.spec=i}static create(e,t,r,s){let i=s.nodeViews[t.type.name],o=i&&i(t,s,r);return(!o||!o.dom)&&(o=An.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new Mn(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&wt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=wt&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=dt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=dt}}slice(e,t,r){let s=Mn.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;t<o&&(i=Ao(i,t,o,r)),e>0&&(i=Ao(i,0,e,r));for(let l=0;l<i.length;l++)i[l].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Yt extends Ir{constructor(e,t,r,s,i,o,l,a,c){super(e,[],i,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=l}static create(e,t,r,s,i,o){let l=i.nodeViews[t.type.name],a,c=l&&l(t,i,()=>{if(!a)return o;if(a.parent)return a.parent.posBeforeChild(a)},r,s),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=An.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let f=u;return u=ad(u,r,t),c?a=new T1(e,t,r,s,u,d||null,f,c,i,o+1):t.isText?new ci(e,t,r,s,u,f,i):new Yt(e,t,r,s,u,d||null,f,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>k.empty)}return e}matchesNode(e,t,r){return this.dirty==dt&&e.eq(this.node)&&gs(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,l=i&&i.pos<0,a=new R1(this,o&&o.node,e);I1(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?a.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&a.syncToMarks(u==this.node.childCount?re.none:this.node.child(u).marks,r,e),a.placeWidget(c,e,s)},(c,u,d,f)=>{a.syncToMarks(c.marks,r,e);let h;a.findNodeMatch(c,u,d,f)||l&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(h=a.findIndexWithChild(i.node))>-1&&a.updateNodeAt(c,u,d,h,e)||a.updateNextNode(c,u,d,e,f,s)||a.addNode(c,u,d,e,s),s+=c.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==hn)&&(o&&this.protectLocalComposition(e,o),od(this.contentDOM,this.children,e),Wn&&D1(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof $)||r<t||s>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,l=L1(this.node.content,o,r-t,s-t);return l<0?null:{node:i,pos:l,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new E1(this,i,t,s);e.input.compositionNodes.push(o),this.children=Ao(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==wt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=dt}updateOuterDeco(e){if(gs(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=ld(this.dom,this.nodeDOM,To(this.outerDeco,this.node,t),To(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Ua(n,e,t,r,s){ad(r,e,n);let i=new Yt(void 0,n,e,t,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class ci extends Yt{constructor(e,t,r,s,i,o,l){super(e,t,r,s,i,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==wt||this.dirty!=dt&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=dt||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=dt,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),i=document.createTextNode(s.text);return new ci(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=wt)}get domAtom(){return!1}isText(e){return this.node.text==e}}class id extends Ir{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==dt&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class T1 extends Yt{constructor(e,t,r,s,i,o,l,a,c,u){super(e,t,r,s,i,o,l,c,u),this.spec=a}update(e,t,r,s){if(this.dirty==wt)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function od(n,e,t){let r=n.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],l=o.dom;if(l.parentNode==n){for(;l!=r;)r=_a(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(l,r);if(o instanceof Mn){let a=r?r.previousSibling:n.lastChild;od(o.contentDOM,o.children,t),r=a?a.nextSibling:n.firstChild}}for(;r;)r=_a(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const ar=function(n){n&&(this.nodeName=n)};ar.prototype=Object.create(null);const pn=[new ar];function To(n,e,t){if(n.length==0)return pn;let r=t?pn[0]:new ar,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new ar(o.nodeName));for(let l in o){let a=o[l];a!=null&&(t&&s.length==1&&s.push(r=new ar(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return s}function ld(n,e,t,r){if(t==pn&&r==pn)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],l=t[i];if(i){let a;l&&l.nodeName==o.nodeName&&s!=n&&(a=s.parentNode)&&a.nodeName.toLowerCase()==o.nodeName||(a=document.createElement(o.nodeName),a.pmIsDeco=!0,a.appendChild(s),l=pn[0]),s=a}A1(s,l||pn[0],o)}return s}function A1(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function ad(n,e,t){return ld(n,n,pn,To(e,t,n.nodeType!=1))}function gs(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function _a(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class R1{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=N1(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=dt,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let c=this.top.children[a];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=Mn.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))i=this.top.children.indexOf(o,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let c=this.top.children[l];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=l;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,s,i){let o=this.top.children[s];return o.dirty==wt&&o.dom==o.contentDOM&&(o.dirty=hn),o.update(e,t,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,i,o){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof Yt){let c=this.preMatch.matched.get(a);if(c!=null&&c!=i)return!1;let u=a.dom,d,f=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=wt&&gs(t,a.outerDeco));if(!f&&a.update(e,t,r,s))return this.destroyBetween(this.index,l),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(a,e,t,r,s,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=hn,d.updateChildren(s,o+1),d.dirty=dt),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!gs(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let l=Yt.create(this.top,t,r,s,i,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,t,r,s,i){let o=Yt.create(this.top,e,t,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new sd(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Mn;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof ci)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((_e||Fe)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new id(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function N1(n,e){let t=e,r=t.children.length,s=n.childCount,i=new Map,o=[];e:for(;s>0;){let l;for(;;)if(r){let c=t.children[r-1];if(c instanceof Mn)t=c,r=c.children.length;else{l=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let a=l.node;if(a){if(a!=n.child(s-1))break;--s,i.set(l,s),o.push(l)}}return{index:s,matched:i,matches:o.reverse()}}function O1(n,e){return n.type.side-e.type.side}function I1(n,e,t,r){let s=e.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,s,e.forChild(i,u),c),i+=u.nodeSize}return}let o=0,l=[],a=null;for(let c=0;;){let u,d;for(;o<s.length&&s[o].to==i;){let C=s[o++];C.widget&&(u?(d||(d=[u])).push(C):u=C)}if(u)if(d){d.sort(O1);for(let C=0;C<d.length;C++)t(d[C],c,!!a)}else t(u,c,!!a);let f,h;if(a)h=-1,f=a,a=null;else if(c<n.childCount)h=c,f=n.child(c++);else break;for(let C=0;C<l.length;C++)l[C].to<=i&&l.splice(C--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)l.push(s[o++]);let p=i+f.nodeSize;if(f.isText){let C=p;o<s.length&&s[o].from<C&&(C=s[o].from);for(let b=0;b<l.length;b++)l[b].to<C&&(C=l[b].to);C<p&&(a=f.cut(C-i),f=f.cut(0,C-i),p=C,h=-1)}else for(;o<s.length&&s[o].to<p;)o++;let m=f.isInline&&!f.isLeaf?l.filter(C=>!C.inline):l.slice();r(f,m,e.forChild(i,f),h),i=p}}function D1(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function L1(n,e,t,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),l=i;if(i+=o.nodeSize,!o.isText)continue;let a=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;a+=c.text}if(i>=t){if(i>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let c=l<r?a.lastIndexOf(e,r-l-1):-1;if(c>=0&&c+e.length+l>=t)return l+c;if(t==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function Ao(n,e,t,r,s){let i=[];for(let o=0,l=0;o<n.length;o++){let a=n[o],c=l,u=l+=a.size;c>=t||u<=e?i.push(a):(c<e&&i.push(a.slice(0,e-c,r)),s&&(i.push(s),s=void 0),u>t&&i.push(a.slice(t-c,a.size,r)))}return i}function fl(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let l=r.resolve(o),a,c;if(ai(t)){for(a=o;s&&!s.node;)s=s.parent;let d=s.node;if(s&&d.isAtom&&B.isSelectable(d)&&s.parent&&!(d.isInline&&o1(t.focusNode,t.focusOffset,s.dom))){let f=s.posBefore;c=new B(o==f?l:r.resolve(f))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let d=o,f=o;for(let h=0;h<t.rangeCount;h++){let p=t.getRangeAt(h);d=Math.min(d,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),f=Math.max(f,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[a,o]=f==n.state.selection.anchor?[f,d]:[d,f],l=r.resolve(o)}else a=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(a<0)return null}let u=r.resolve(a);if(!c){let d=e=="pointer"||n.state.selection.head<l.pos&&!i?1:-1;c=hl(n,u,l,d)}return c}function cd(n){return n.editable?n.hasFocus():dd(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Lt(n,e=!1){let t=n.state.selection;if(ud(n,t),!!cd(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Fe){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Sn(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)j1(n);else{let{anchor:r,head:s}=t,i,o;qa&&!(t instanceof $)&&(t.$from.parent.inlineContent||(i=Ja(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=Ja(n,t.to))),n.docView.setSelection(r,s,n,e),qa&&(i&&Za(i),o&&Za(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&P1(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const qa=_e||Fe&&Qu<63;function Ja(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(_e&&s&&s.contentEditable=="false")return Fi(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return Fi(s);if(i)return Fi(i)}}function Fi(n){return n.contentEditable="true",_e&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Za(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function P1(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!cd(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function j1(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?t.setStart(r.parentNode,Le(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!s&&!n.state.selection.visible&&Xe&&Qt<=11&&(r.disabled=!0,r.disabled=!1)}function ud(n,e){if(e instanceof B){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Ga(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Ga(n)}function Ga(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function hl(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||$.between(e,t,r)}function Qa(n){return n.editable&&!n.hasFocus()?!1:dd(n)}function dd(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function B1(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Sn(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Ro(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return i&&K.findFrom(i,e)}function Ft(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Ya(n,e,t){let r=n.state.selection;if(r instanceof $)if(t.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return Ft(n,new $(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=Ro(n.state,e);return s&&s instanceof B?Ft(n,s):!1}else if(!(ct&&t.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let l=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(l))&&!o.contentDOM?B.isSelectable(i)?Ft(n,new B(e<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):Or?Ft(n,new $(n.state.doc.resolve(e<0?l:l+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof B&&r.node.isInline)return Ft(n,new $(e>0?r.$to:r.$from));{let s=Ro(n.state,e);return s?Ft(n,s):!1}}}function ys(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function cr(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function In(n,e){return e<0?H1(n):F1(n)}function H1(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,i,o=!1;for(mt&&t.nodeType==1&&r<ys(t)&&cr(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(cr(l,-1))s=t,i=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(fd(t))break;{let l=t.previousSibling;for(;l&&cr(l,-1);)s=t.parentNode,i=Le(l),l=l.previousSibling;if(l)t=l,r=ys(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?No(n,t,r):s&&No(n,s,i)}function F1(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=ys(t),i,o;for(;;)if(r<s){if(t.nodeType!=1)break;let l=t.childNodes[r];if(cr(l,1))i=t,o=++r;else break}else{if(fd(t))break;{let l=t.nextSibling;for(;l&&cr(l,1);)i=l.parentNode,o=Le(l)+1,l=l.nextSibling;if(l)t=l,r=0,s=ys(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}i&&No(n,i,o)}function fd(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function V1(n,e){for(;n&&e==n.childNodes.length&&!Nr(n);)e=Le(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function z1(n,e){for(;n&&!e&&!Nr(n);)e=Le(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function No(n,e,t){if(e.nodeType!=3){let i,o;(o=V1(e,t))?(e=o,t=0):(i=z1(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(!r)return;if(ai(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&Lt(n)},50)}function Xa(n,e){let t=n.state.doc.resolve(e);if(!(Fe||c1)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function ec(n,e,t){let r=n.state.selection;if(r instanceof $&&!r.empty||t.indexOf("s")>-1||ct&&t.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=Ro(n.state,e);if(o&&o instanceof B)return Ft(n,o)}if(!s.parent.inlineContent){let o=e<0?s:i,l=r instanceof st?K.near(o,e):K.findFrom(o,e);return l?Ft(n,l):!1}return!1}function tc(n,e){if(!(n.state.selection instanceof $))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function nc(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function $1(n){if(!_e||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;nc(n,r,"true"),setTimeout(()=>nc(n,r,"false"),20)}return!1}function K1(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function W1(n,e){let t=e.keyCode,r=K1(e);if(t==8||ct&&t==72&&r=="c")return tc(n,-1)||In(n,-1);if(t==46&&!e.shiftKey||ct&&t==68&&r=="c")return tc(n,1)||In(n,1);if(t==13||t==27)return!0;if(t==37||ct&&t==66&&r=="c"){let s=t==37?Xa(n,n.state.selection.from)=="ltr"?-1:1:-1;return Ya(n,s,r)||In(n,s)}else if(t==39||ct&&t==70&&r=="c"){let s=t==39?Xa(n,n.state.selection.from)=="ltr"?1:-1:1;return Ya(n,s,r)||In(n,s)}else{if(t==38||ct&&t==80&&r=="c")return ec(n,-1,r)||In(n,-1);if(t==40||ct&&t==78&&r=="c")return $1(n)||ec(n,1,r)||In(n,1);if(r==(ct?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function pl(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let o=n.someProp("clipboardSerializer")||An.fromSchema(n.state.schema),l=Cd(),a=l.createElement("div");a.appendChild(o.serializeFragment(r,{document:l}));let c=a.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=yd[c.nodeName.toLowerCase()]);){for(let h=u.length-1;h>=0;h--){let p=l.createElement(u[h]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),d++}c=a.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${d?` -${d}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:f,slice:e}}function hd(n,e,t,r,s){let i=s.parent.type.spec.code,o,l;if(!t&&!e)return null;let a=e&&(r||i||!t);if(a){if(n.someProp("transformPastedText",f=>{e=f(e,i||r,n)}),i)return e?new O(k.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):O.empty;let d=n.someProp("clipboardTextParser",f=>f(e,s,r,n));if(d)l=d;else{let f=s.marks(),{schema:h}=n.state,p=An.fromSchema(h);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let C=o.appendChild(document.createElement("p"));m&&C.appendChild(p.serializeNode(h.text(m,f)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),o=J1(t),Or&&Z1(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||Gt.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(a||u),context:s,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!U1.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)l=G1(rc(l,+u[1],+u[2]),u[4]);else if(l=O.maxOpen(_1(l.content,s),!0),l.openStart||l.openEnd){let d=0,f=0;for(let h=l.content.firstChild;d<l.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=l.content.lastChild;f<l.openEnd&&!h.type.spec.isolating;f++,h=h.lastChild);l=rc(l,d,f)}return n.someProp("transformPasted",d=>{l=d(l,n)}),l}const U1=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function _1(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(l=>{if(!o)return;let a=s.findWrapping(l.type),c;if(!a)return o=null;if(c=o.length&&i.length&&md(a,i,l,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=gd(o[o.length-1],i.length));let u=pd(l,a);o.push(u),s=s.matchType(u.type),i=a}}),o)return k.from(o)}return n}function pd(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,k.from(n));return n}function md(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let i=md(n,e,t,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(k.from(pd(t,n,s+1))))}}function gd(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,gd(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(k.empty,!0);return n.copy(t.append(r))}function Oo(n,e,t,r,s,i){let o=e<0?n.firstChild:n.lastChild,l=o.content;return n.childCount>1&&(i=0),s<r-1&&(l=Oo(l,e,t,r,s+1,i)),s>=t&&(l=e<0?o.contentMatchAt(0).fillBefore(l,i<=s).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(k.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(l))}function rc(n,e,t){return e<n.openStart&&(n=new O(Oo(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new O(Oo(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const yd={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let sc=null;function Cd(){return sc||(sc=document.implementation.createHTMLDocument("title"))}let Vi=null;function q1(n){let e=window.trustedTypes;return e?(Vi||(Vi=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),Vi.createHTML(n)):n}function J1(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Cd().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&yd[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=q1(n),s)for(let i=0;i<s.length;i++)t=t.querySelector(s[i])||t;return t}function Z1(n){let e=n.querySelectorAll(Fe?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function G1(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:i,openEnd:o}=n;for(let l=r.length-2;l>=0;l-=2){let a=t.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;s=k.from(a.create(r[l+1],s)),i++,o++}return new O(s,i,o)}const qe={},Je={},Q1={touchstart:!0,touchmove:!0};class Y1{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function X1(n){for(let e in qe){let t=qe[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{tm(n,r)&&!ml(n,r)&&(n.editable||!(r.type in Je))&&t(n,r)},Q1[e]?{passive:!0}:void 0)}_e&&n.dom.addEventListener("input",()=>null),Io(n)}function Jt(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function em(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Io(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>ml(n,r))})}function ml(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function tm(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function nm(n,e){!ml(n,e)&&qe[e.type]&&(n.editable||!(e.type in Je))&&qe[e.type](n,e)}Je.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!xd(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(It&&Fe&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Wn&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,dn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||W1(n,t)?t.preventDefault():Jt(n,"key")};Je.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Je.keypress=(n,e)=>{let t=e;if(xd(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||ct&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof $)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode),i=()=>n.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,s,i))&&n.dispatch(i()),t.preventDefault()}};function ui(n){return{left:n.clientX,top:n.clientY}}function rm(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function gl(n,e,t,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,l=>o>i.depth?l(n,t,i.nodeAfter,i.before(o),s,!0):l(n,t,i.node(o),i.before(o),s,!1)))return!0;return!1}function Fn(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function sm(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&B.isSelectable(r)?(Fn(n,new B(t)),!0):!1}function im(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof B&&(r=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let l=o>i.depth?i.nodeAfter:i.node(o);if(B.isSelectable(l)){r&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?s=i.before(t.$from.depth):s=i.before(o);break}}return s!=null?(Fn(n,B.create(n.state.doc,s)),!0):!1}function om(n,e,t,r,s){return gl(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(s?im(n,t):sm(n,t))}function lm(n,e,t,r){return gl(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function am(n,e,t,r){return gl(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||cm(n,t,r)}function cm(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Fn(n,$.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),l=s.before(i);if(o.inlineContent)Fn(n,$.create(r,l+1,l+1+o.content.size));else if(B.isSelectable(o))Fn(n,B.create(r,l));else continue;return!0}}function yl(n){return Cs(n)}const bd=ct?"metaKey":"ctrlKey";qe.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=yl(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&rm(t,n.input.lastClick)&&!t[bd]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:i,button:t.button};let o=n.posAtCoords(ui(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new um(n,o,t,!!r)):(i=="doubleClick"?lm:am)(n,o.pos,o.inside,t)?t.preventDefault():Jt(n,"pointer"))};class um{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[bd],this.allowDefault=r.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,o=u.depth?u.before():0}const l=s?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.dom.nodeType==1?a.dom:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof B&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&mt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Jt(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Lt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(ui(e))),this.updateAllowDefault(e),this.allowDefault||!t?Jt(this.view,"pointer"):om(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||_e&&this.mightDrag&&!this.mightDrag.node.isAtom||Fe&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Fn(this.view,K.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):Jt(this.view,"pointer")}move(e){this.updateAllowDefault(e),Jt(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}qe.touchstart=n=>{n.input.lastTouch=Date.now(),yl(n),Jt(n,"pointer")};qe.touchmove=n=>{n.input.lastTouch=Date.now(),Jt(n,"pointer")};qe.contextmenu=n=>yl(n);function xd(n,e){return n.composing?!0:_e&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const dm=It?5e3:-1;Je.compositionstart=Je.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof $&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Cs(n,!0),n.markCursor=null;else if(Cs(n,!e.selection.empty),mt&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let l=n.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}vd(n,dm)};Je.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,vd(n,20))};function vd(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Cs(n),e))}function kd(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=hm());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function fm(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=s1(e.focusNode,e.focusOffset),r=i1(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return r}}return t||r}function hm(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Cs(n,e=!1){if(!(It&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),kd(n),e||n.docView&&n.docView.dirty){let t=fl(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function pm(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const kr=Xe&&Qt<15||Wn&&u1<604;qe.copy=Je.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let i=kr?null:t.clipboardData,o=r.content(),{dom:l,text:a}=pl(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",l.innerHTML),i.setData("text/plain",a)):pm(n,l),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function mm(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function gm(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?wr(n,r.value,null,s,e):wr(n,r.textContent,r.innerHTML,s,e)},50)}function wr(n,e,t,r,s){let i=hd(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,s,i||O.empty)))return!0;if(!i)return!1;let o=mm(i),l=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function wd(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Je.paste=(n,e)=>{let t=e;if(n.composing&&!It)return;let r=kr?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&wr(n,wd(r),r.getData("text/html"),s,t)?t.preventDefault():gm(n,t)};class Sd{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const ym=ct?"altKey":"ctrlKey";function Md(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[ym]}qe.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(ui(t)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof B?s.to-1:s.to))){if(r&&r.mightDrag)o=B.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let d=n.docView.nearestDesc(t.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&(o=B.create(n.state.doc,d.posBefore))}}let l=(o||n.state.selection).content(),{dom:a,text:c,slice:u}=pl(n,l);(!t.dataTransfer.files.length||!Fe||Qu>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(kr?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",kr||t.dataTransfer.setData("text/plain",c),n.dragging=new Sd(u,Md(n,t),o)};qe.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Je.dragover=Je.dragenter=(n,e)=>e.preventDefault();Je.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(ui(t));if(!s)return;let i=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",p=>{o=p(o,n)}):o=hd(n,wd(t.dataTransfer),kr?null:t.dataTransfer.getData("text/html"),!1,i);let l=!!(r&&Md(n,t));if(n.someProp("handleDrop",p=>p(n,t,o||O.empty,l))){t.preventDefault();return}if(!o)return;t.preventDefault();let a=o?$u(n.state.doc,i.pos,o):i.pos;a==null&&(a=i.pos);let c=n.state.tr;if(l){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(a),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(f))return;let h=c.doc.resolve(u);if(d&&B.isSelectable(o.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new B(h));else{let p=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((m,C,b,v)=>p=v),c.setSelection(hl(n,h,c.doc.resolve(p)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};qe.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Lt(n)},20))};qe.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};qe.beforeinput=(n,e)=>{if(Fe&&It&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,dn(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in Je)qe[n]=Je[n];function Sr(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class bs{constructor(e,t){this.toDOM=e,this.spec=t||bn,this.side=this.spec.side||0}map(e,t,r,s){let{pos:i,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new rt(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof bs&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Sr(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Xt{constructor(e,t){this.attrs=e,this.spec=t||bn}map(e,t,r,s){let i=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new rt(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Xt&&Sr(this.attrs,e.attrs)&&Sr(this.spec,e.spec)}static is(e){return e.type instanceof Xt}destroy(){}}class Cl{constructor(e,t){this.attrs=e,this.spec=t||bn}map(e,t,r,s){let i=e.mapResult(t.from+s,1);if(i.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=i.pos?null:new rt(i.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),i;return s==t.from&&!(i=e.child(r)).isText&&s+i.nodeSize==t.to}eq(e){return this==e||e instanceof Cl&&Sr(this.attrs,e.attrs)&&Sr(this.spec,e.spec)}destroy(){}}class rt{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new rt(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new rt(e,e,new bs(t,r))}static inline(e,t,r,s){return new rt(e,t,new Xt(r,s))}static node(e,t,r,s){return new rt(e,t,new Cl(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Xt}get widget(){return this.type instanceof bs}}const Ln=[],bn={};class xe{constructor(e,t){this.local=e.length?e:Ln,this.children=t.length?t:Ln}static create(e,t){return t.length?xs(t,e,0,bn):Be}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,i){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=t&&l.to>=e&&(!i||i(l.spec))&&r.push(l.copy(l.from+s,l.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,t-l,r,s+l,i)}}map(e,t,r){return this==Be||e.maps.length==0?this:this.mapInner(e,t,0,0,r||bn)}mapInner(e,t,r,s,i){let o;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,s);a&&a.type.valid(t,a)?(o||(o=[])).push(a):i.onRemove&&i.onRemove(this.local[l].spec)}return this.children.length?Cm(this.children,o||[],e,t,r,s,i):o?new xe(o.sort(xn),Ln):Be}add(e,t){return t.length?this==Be?xe.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,i=0;e.forEach((l,a)=>{let c=a+r,u;if(u=Td(t,l,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<a;)i+=3;s[i]==a?s[i+2]=s[i+2].addInner(l,u,c+1):s.splice(i,0,a,a+l.nodeSize,xs(u,l,c+1,bn)),i+=3}});let o=Ed(i?Ad(t):t,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new xe(o.length?this.local.concat(o).sort(xn):this.local,s||this.children)}remove(e){return e.length==0||this==Be?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,l=r[i]+t,a=r[i+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>l&&d.to<a&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,l+1);c!=Be?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let l=0;l<s.length;l++)s[l].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(l--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new xe(s,r):Be}forChild(e,t){if(this==Be)return this;if(t.isLeaf)return xe.empty;let r,s;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let i=e+1,o=i+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<o&&a.to>i&&a.type instanceof Xt){let c=Math.max(i,a.from)-i,u=Math.min(o,a.to)-i;c<u&&(s||(s=[])).push(a.copy(c,u))}}if(s){let l=new xe(s.sort(xn),Ln);return r?new Wt([l,r]):l}return r||Be}eq(e){if(this==e)return!0;if(!(e instanceof xe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return bl(this.localsInner(e))}localsInner(e){if(this==Be)return Ln;if(e.inlineContent||!this.local.some(Xt.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Xt||t.push(this.local[r]);return t}forEachSet(e){e(this)}}xe.empty=new xe([],[]);xe.removeOverlap=bl;const Be=xe.empty;class Wt{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,bn));return Wt.from(r)}forChild(e,t){if(t.isLeaf)return xe.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,t);i!=Be&&(i instanceof Wt?r=r.concat(i.members):r.push(i))}return Wt.from(r)}eq(e){if(!(e instanceof Wt)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?bl(r?t:t.sort(xn)):Ln}static from(e){switch(e.length){case 0:return Be;case 1:return e[0];default:return new Wt(e.every(t=>t instanceof xe)?e:e.reduce((t,r)=>t.concat(r instanceof xe?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function Cm(n,e,t,r,s,i,o){let l=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let d=0;t.maps[c].forEach((f,h,p,m)=>{let C=m-p-(h-f);for(let b=0;b<l.length;b+=3){let v=l[b+1];if(v<0||f>v+u-d)continue;let x=l[b]+u-d;h>=x?l[b+1]=f<=x?-2:-1:f>=u&&C&&(l[b]+=C,l[b+1]+=C)}d+=C}),u=t.maps[c].map(u,-1)}let a=!1;for(let c=0;c<l.length;c+=3)if(l[c+1]<0){if(l[c+1]==-2){a=!0,l[c+1]=-1;continue}let u=t.map(n[c]+i),d=u-s;if(d<0||d>=r.content.size){a=!0;continue}let f=t.map(n[c+1]+i,-1),h=f-s,{index:p,offset:m}=r.content.findIndex(d),C=r.maybeChild(p);if(C&&m==d&&m+C.nodeSize==h){let b=l[c+2].mapInner(t,C,u+1,n[c]+i+1,o);b!=Be?(l[c]=d,l[c+1]=h,l[c+2]=b):(l[c+1]=-2,a=!0)}else a=!0}if(a){let c=bm(l,n,e,t,s,i,o),u=xs(c,r,0,o);e=u.local;for(let d=0;d<l.length;d+=3)l[d+1]<0&&(l.splice(d,3),d-=3);for(let d=0,f=0;d<u.children.length;d+=3){let h=u.children[d];for(;f<l.length&&l[f]<h;)f+=3;l.splice(f,0,u.children[d],u.children[d+1],u.children[d+2])}}return new xe(e.sort(xn),l)}function Ed(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new rt(s.from+e,s.to+e,s.type))}return t}function bm(n,e,t,r,s,i,o){function l(a,c){for(let u=0;u<a.local.length;u++){let d=a.local[u].map(r,s,c);d?t.push(d):o.onRemove&&o.onRemove(a.local[u].spec)}for(let u=0;u<a.children.length;u+=3)l(a.children[u+2],a.children[u]+c+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&l(n[a+2],e[a]+i+1);return t}function Td(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function Ad(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function xs(n,e,t,r){let s=[],i=!1;e.forEach((l,a)=>{let c=Td(n,l,a+t);if(c){i=!0;let u=xs(c,l,t+a+1,r);u!=Be&&s.push(a,a+l.nodeSize,u)}});let o=Ed(i?Ad(n):n,-t).sort(xn);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||s.length?new xe(o,s):Be}function xn(n,e){return n.from-e.from||n.to-e.to}function bl(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[s]=i.copy(i.from,r.to),ic(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),ic(e,s,r.copy(i.from,r.to)));break}}}return e}function ic(n,e,t){for(;e<n.length&&xn(t,n[e])>0;)e++;n.splice(e,0,t)}function zi(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Be&&e.push(r)}),n.cursorWrapper&&e.push(xe.create(n.state.doc,[n.cursorWrapper.deco])),Wt.from(e)}const xm={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},vm=Xe&&Qt<=11;class km{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class wm{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new km,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);Xe&&Qt<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),vm&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,xm)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Qa(this.view)){if(this.suppressingSelectionUpdates)return Lt(this.view);if(Xe&&Qt<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Sn(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=Kn(i))t.add(i);for(let i=e.anchorNode;i;i=Kn(i))if(t.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Qa(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,l=!1,a=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],a);d&&(i=i<0?d.from:Math.min(d.from,i),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(l=!0))}if(mt&&a.length){let u=a.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,f]=u;d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let f of u){let h=f.parentNode;h&&h.nodeName=="LI"&&(!d||Em(e,d)!=h)&&f.remove()}}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ai(r)&&(c=fl(e))&&c.eq(K.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Lt(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),Sm(e)),this.handleDOMChange(i,o,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Lt(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];t.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(Xe&&Qt<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:f}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(s=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f)}let o=s&&s.parentNode==e.target?Le(s)+1:0,l=r.localPosFromDOM(e.target,o,-1),a=i&&i.parentNode==e.target?Le(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,a,1);return{from:l,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let oc=new WeakMap,lc=!1;function Sm(n){if(!oc.has(n)&&(oc.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=mt,lc)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),lc=!0}}function ac(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return Sn(o.node,o.offset,s,i)&&([t,r,s,i]=[s,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:i}}function Mm(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return ac(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?ac(n,t):null}function Em(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function Tm(n,e,t){let{node:r,fromOffset:s,toOffset:i,from:o,to:l}=n.docView.parseRange(e,t),a=n.domSelectionRange(),c,u=a.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:a.anchorOffset}],ai(a)||c.push({node:a.focusNode,offset:a.focusOffset})),Fe&&n.input.lastKeyCode===8)for(let C=i;C>s;C--){let b=r.childNodes[C-1],v=b.pmViewDesc;if(b.nodeName=="BR"&&!v){i=C;break}if(!v||v.size)break}let d=n.state.doc,f=n.someProp("domParser")||Gt.fromSchema(n.state.schema),h=d.resolve(o),p=null,m=f.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:s,to:i,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:Am,context:h});if(c&&c[0].pos!=null){let C=c[0].pos,b=c[1]&&c[1].pos;b==null&&(b=C),p={anchor:C+o,head:b+o}}return{doc:m,sel:p,from:o,to:l}}function Am(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(_e&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||_e&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Rm=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Nm(n,e,t,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let R=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,z=fl(n,R);if(z&&!n.state.selection.eq(z)){if(Fe&&It&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",Y=>Y(n,dn(13,"Enter"))))return;let j=n.state.tr.setSelection(z);R=="pointer"?j.setMeta("pointer",!0):R=="key"&&j.scrollIntoView(),i&&j.setMeta("composition",i),n.dispatch(j)}return}let o=n.state.doc.resolve(e),l=o.sharedDepth(t);e=o.before(l+1),t=n.state.doc.resolve(t).after(l+1);let a=n.state.selection,c=Tm(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),f,h;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,h="end"):(f=n.state.selection.from,h="start"),n.input.lastKeyCode=null;let p=Dm(d.content,c.doc.content,c.from,f,h);if(p&&n.input.domChangeCount++,(Wn&&n.input.lastIOSEnter>Date.now()-225||It)&&s.some(R=>R.nodeType==1&&!Rm.test(R.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",R=>R(n,dn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&a instanceof $&&!a.empty&&a.$head.sameParent(a.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:a.from,endA:a.to,endB:a.to};else{if(c.sel){let R=cc(n,n.state.doc,c.sel);if(R&&!R.eq(n.state.selection)){let z=n.state.tr.setSelection(R);i&&z.setMeta("composition",i),n.dispatch(z)}}return}n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof $&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),Xe&&Qt<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)=="  "&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),C=c.doc.resolveNoCache(p.endB-c.from),b=u.resolve(p.start),v=m.sameParent(C)&&m.parent.inlineContent&&b.end()>=p.endA,x;if((Wn&&n.input.lastIOSEnter>Date.now()-225&&(!v||s.some(R=>R.nodeName=="DIV"||R.nodeName=="P"))||!v&&m.pos<c.doc.content.size&&(!m.sameParent(C)||!m.parent.inlineContent)&&!/\S/.test(c.doc.textBetween(m.pos,C.pos,"",""))&&(x=K.findFrom(c.doc.resolve(m.pos+1),1,!0))&&x.head>m.pos)&&n.someProp("handleKeyDown",R=>R(n,dn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&Im(u,p.start,p.endA,m,C)&&n.someProp("handleKeyDown",R=>R(n,dn(8,"Backspace")))){It&&Fe&&n.domObserver.suppressSelectionUpdates();return}Fe&&p.endB==p.start&&(n.input.lastChromeDelete=Date.now()),It&&!v&&m.start()!=C.start()&&C.parentOffset==0&&m.depth==C.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,C=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(R){return R(n,dn(13,"Enter"))})},20));let w=p.start,M=p.endA,T=R=>{let z=R||n.state.tr.replace(w,M,c.doc.slice(p.start-c.from,p.endB-c.from));if(c.sel){let j=cc(n,z.doc,c.sel);j&&!(Fe&&n.composing&&j.empty&&(p.start!=p.endB||n.input.lastChromeDelete<Date.now()-100)&&(j.head==w||j.head==z.mapping.map(M)-1)||Xe&&j.empty&&j.head==w)&&z.setSelection(j)}return i&&z.setMeta("composition",i),z.scrollIntoView()},P;if(v){if(m.pos==C.pos){Xe&&Qt<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Lt(n),20));let R=T(n.state.tr.delete(w,M)),z=u.resolve(p.start).marksAcross(u.resolve(p.endA));z&&R.ensureMarks(z),n.dispatch(R)}else if(p.endA==p.endB&&(P=Om(m.parent.content.cut(m.parentOffset,C.parentOffset),b.parent.content.cut(b.parentOffset,p.endA-b.start())))){let R=T(n.state.tr);P.type=="add"?R.addMark(w,M,P.mark):R.removeMark(w,M,P.mark),n.dispatch(R)}else if(m.parent.child(m.index()).isText&&m.index()==C.index()-(C.textOffset?0:1)){let R=m.parent.textBetween(m.parentOffset,C.parentOffset),z=()=>T(n.state.tr.insertText(R,w,M));n.someProp("handleTextInput",j=>j(n,w,M,R,z))||n.dispatch(z())}}else n.dispatch(T())}function cc(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:hl(n,e.resolve(t.anchor),e.resolve(t.head))}function Om(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,i=r,o,l,a;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(s.length==1&&i.length==0)l=s[0],o="add",a=u=>u.mark(l.addToSet(u.marks));else if(s.length==0&&i.length==1)l=i[0],o="remove",a=u=>u.mark(l.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(a(e.child(u)));if(k.from(c).eq(n))return{mark:l,type:o}}function Im(n,e,t,r,s){if(t-e<=s.pos-r.pos||$i(r,!0,!1)<s.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let l=i.nodeAfter;return l!=null&&t==e+l.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve($i(i,!0,!0));return!o.parent.isTextblock||o.pos>t||$i(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function $i(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function Dm(n,e,t,r,s){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:l}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let a=Math.max(0,i-Math.min(o,l));r-=o+a-i}if(o<i&&n.size<e.size){let a=r<=i&&r>=o?i-r:0;i-=a,i&&i<e.size&&uc(e.textBetween(i-1,i+1))&&(i+=a?1:-1),l=i+(l-o),o=i}else if(l<i){let a=r<=i&&r>=l?i-r:0;i-=a,i&&i<n.size&&uc(n.textBetween(i-1,i+1))&&(i+=a?1:-1),o=i+(o-l),l=i}return{start:i,endA:o,endB:l}}function uc(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class Rd{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Y1,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(mc),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=hc(this),fc(this),this.nodeViews=pc(this),this.docView=Ua(this.state.doc,dc(this),zi(this),this.dom,this),this.domObserver=new wm(this,(r,s,i,o)=>Nm(this,r,s,i,o)),this.domObserver.start(),X1(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Io(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(mc),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(kd(this),o=!0),this.state=e;let l=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let h=pc(this);Pm(h,this.nodeViews)&&(this.nodeViews=h,i=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&Io(this),this.editable=hc(this),fc(this);let a=zi(this),c=dc(this),u=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",d=i||!this.docView.matchesNode(e.doc,c,a);(d||!e.selection.eq(s.selection))&&(o=!0);let f=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&h1(this);if(o){this.domObserver.stop();let h=d&&(Xe||Fe)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&Lm(s.selection,e.selection);if(d){let p=Fe?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=fm(this)),(i||!this.docView.update(e.doc,c,a,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Ua(e.doc,c,a,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&B1(this))?Lt(this,h):(ud(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():f&&p1(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof B){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Fa(this,t.getBoundingClientRect(),e)}else Fa(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new Sd(e.slice,e.move,s<0?void 0:B.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(s=t?t(l):l))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let l=i[o].props[e];if(l!=null&&(s=t?t(l):l))return s}}hasFocus(){if(Xe){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&m1(this.dom),Lt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return x1(this,e)}coordsAtPos(e,t=1){return nd(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return M1(this,t||this.state,e)}pasteHTML(e,t){return wr(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return wr(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return pl(this,e)}destroy(){this.docView&&(em(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],zi(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,n1())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return nm(this,e)}domSelectionRange(){let e=this.domSelection();return e?_e&&this.root.nodeType===11&&l1(this.dom.ownerDocument)==this.dom&&Mm(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}Rd.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function dc(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[rt.node(0,n.state.doc.content.size,e)]}function fc(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:rt.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function hc(n){return!n.someProp("editable",e=>e(n.state)===!1)}function Lm(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function pc(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function Pm(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function mc(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var en={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},vs={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},jm=typeof navigator<"u"&&/Mac/.test(navigator.platform),Bm=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Pe=0;Pe<10;Pe++)en[48+Pe]=en[96+Pe]=String(Pe);for(var Pe=1;Pe<=24;Pe++)en[Pe+111]="F"+Pe;for(var Pe=65;Pe<=90;Pe++)en[Pe]=String.fromCharCode(Pe+32),vs[Pe]=String.fromCharCode(Pe);for(var Ki in en)vs.hasOwnProperty(Ki)||(vs[Ki]=en[Ki]);function Hm(n){var e=jm&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Bm&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?vs:en)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Fm=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Vm=typeof navigator<"u"&&/Win/.test(navigator.platform);function zm(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,i,o;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))s=!0;else if(/^s(hift)?$/i.test(a))i=!0;else if(/^mod$/i.test(a))Fm?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function $m(n){let e=Object.create(null);for(let t in n)e[zm(t)]=n[t];return e}function Wi(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function Km(n){return new ke({props:{handleKeyDown:Nd(n)}})}function Nd(n){let e=$m(n);return function(t,r){let s=Hm(r),i,o=e[Wi(s,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let l=e[Wi(s,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(Vm&&r.ctrlKey&&r.altKey)&&(i=en[r.keyCode])&&i!=s){let l=e[Wi(i,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const xl=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Od(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Id=(n,e,t)=>{let r=Od(n,t);if(!r)return!1;let s=vl(r);if(!s){let o=r.blockRange(),l=o&&Zn(o);return l==null?!1:(e&&e(n.tr.lift(o,l).scrollIntoView()),!0)}let i=s.nodeBefore;if(zd(n,s,e,-1))return!0;if(r.parent.content.size==0&&(Un(i,"end")||B.isSelectable(i)))for(let o=r.depth;;o--){let l=oi(n.doc,r.before(o),r.after(o),O.empty);if(l&&l.slice.size<l.to-l.from){if(e){let a=n.tr.step(l);a.setSelection(Un(i,"end")?K.findFrom(a.doc.resolve(a.mapping.map(s.pos,-1)),-1):B.create(a.doc,s.pos-i.nodeSize)),e(a.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},Wm=(n,e,t)=>{let r=Od(n,t);if(!r)return!1;let s=vl(r);return s?Dd(n,s,e):!1},Um=(n,e,t)=>{let r=Pd(n,t);if(!r)return!1;let s=kl(r);return s?Dd(n,s,e):!1};function Dd(n,e,t){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let u=s.lastChild;if(!u)return!1;s=u}let o=e.nodeAfter,l=o,a=e.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let u=l.firstChild;if(!u)return!1;l=u}let c=oi(n.doc,i,a,O.empty);if(!c||c.from!=i||c instanceof Se&&c.slice.size>=a-i)return!1;if(t){let u=n.tr.step(c);u.setSelection($.create(u.doc,i)),t(u.scrollIntoView())}return!0}function Un(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const Ld=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=vl(r)}let o=i&&i.nodeBefore;return!o||!B.isSelectable(o)?!1:(e&&e(n.tr.setSelection(B.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function vl(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function Pd(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const jd=(n,e,t)=>{let r=Pd(n,t);if(!r)return!1;let s=kl(r);if(!s)return!1;let i=s.nodeAfter;if(zd(n,s,e,1))return!0;if(r.parent.content.size==0&&(Un(i,"start")||B.isSelectable(i))){let o=oi(n.doc,r.before(),r.after(),O.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=n.tr.step(o);l.setSelection(Un(i,"start")?K.findFrom(l.doc.resolve(l.mapping.map(s.pos)),1):B.create(l.doc,l.mapping.map(s.pos))),e(l.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},Bd=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=kl(r)}let o=i&&i.nodeAfter;return!o||!B.isSelectable(o)?!1:(e&&e(n.tr.setSelection(B.create(n.doc,i.pos)).scrollIntoView()),!0)};function kl(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const _m=(n,e)=>{let t=n.selection,r=t instanceof B,s;if(r){if(t.node.isTextblock||!nn(n.doc,t.from))return!1;s=t.from}else if(s=ii(n.doc,t.from,-1),s==null)return!1;if(e){let i=n.tr.join(s);r&&i.setSelection(B.create(i.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},qm=(n,e)=>{let t=n.selection,r;if(t instanceof B){if(t.node.isTextblock||!nn(n.doc,t.to))return!1;r=t.to}else if(r=ii(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},Jm=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),i=s&&Zn(s);return i==null?!1:(e&&e(n.tr.lift(s,i).scrollIntoView()),!0)},Hd=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function wl(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const Zm=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),i=t.indexAfter(-1),o=wl(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let l=t.after(),a=n.tr.replaceWith(l,l,o.createAndFill());a.setSelection(K.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},Fd=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof st||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=wl(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,l=n.tr.insert(o,i.createAndFill());l.setSelection($.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},Vd=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(Dt(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),s=r&&Zn(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)};function Gm(n){return(e,t)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof B&&e.selection.node.isBlock)return!r.parentOffset||!Dt(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,l,a=!1,c=!1;for(let h=r.depth;;h--)if(r.node(h).isBlock){a=r.end(h)==r.pos+(r.depth-h),c=r.start(h)==r.pos-(r.depth-h),l=wl(r.node(h-1).contentMatchAt(r.indexAfter(h-1))),i.unshift(a&&l?{type:l}:null),o=h;break}else{if(h==1)return!1;i.unshift(null)}let u=e.tr;(e.selection instanceof $||e.selection instanceof st)&&u.deleteSelection();let d=u.mapping.map(r.pos),f=Dt(u.doc,d,i.length,i);if(f||(i[0]=l?{type:l}:null,f=Dt(u.doc,d,i.length,i)),!f)return!1;if(u.split(d,i.length,i),!a&&c&&r.node(o).type!=l){let h=u.mapping.map(r.before(o)),p=u.doc.resolve(h);l&&r.node(o-1).canReplaceWith(p.index(),p.index()+1,l)&&u.setNodeMarkup(u.mapping.map(r.before(o)),l)}return t&&t(u.scrollIntoView()),!0}}const Qm=Gm(),Ym=(n,e)=>{let{$from:t,to:r}=n.selection,s,i=t.sharedDepth(r);return i==0?!1:(s=t.before(i),e&&e(n.tr.setSelection(B.create(n.doc,s))),!0)};function Xm(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||nn(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function zd(n,e,t,r){let s=e.nodeBefore,i=e.nodeAfter,o,l,a=s.type.spec.isolating||i.type.spec.isolating;if(!a&&Xm(n,e,t))return!0;let c=!a&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(l=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&l.matchType(o[0]||i.type).validEnd){if(t){let h=e.pos+i.nodeSize,p=k.empty;for(let b=o.length-1;b>=0;b--)p=k.from(o[b].create(null,p));p=k.from(s.copy(p));let m=n.tr.step(new Me(e.pos-1,h,e.pos,h,new O(p,1,0),o.length,!0)),C=m.doc.resolve(h+2*o.length);C.nodeAfter&&C.nodeAfter.type==s.type&&nn(m.doc,C.pos)&&m.join(C.pos),t(m.scrollIntoView())}return!0}let u=i.type.spec.isolating||r>0&&a?null:K.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),f=d&&Zn(d);if(f!=null&&f>=e.depth)return t&&t(n.tr.lift(d,f).scrollIntoView()),!0;if(c&&Un(i,"start",!0)&&Un(s,"end")){let h=s,p=[];for(;p.push(h),!h.isTextblock;)h=h.lastChild;let m=i,C=1;for(;!m.isTextblock;m=m.firstChild)C++;if(h.canReplace(h.childCount,h.childCount,m.content)){if(t){let b=k.empty;for(let x=p.length-1;x>=0;x--)b=k.from(p[x].copy(b));let v=n.tr.step(new Me(e.pos-p.length,e.pos+i.nodeSize,e.pos+C,e.pos+i.nodeSize-C,new O(b,p.length,0),0,!0));t(v.scrollIntoView())}return!0}}return!1}function $d(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(t&&t(e.tr.setSelection($.create(e.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const eg=$d(-1),tg=$d(1);function ng(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),l=o&&cl(o,n,e);return l?(r&&r(t.tr.wrap(o,l).scrollIntoView()),!0):!1}}function gc(n,e=null){return function(t,r){let s=!1;for(let i=0;i<t.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:l}}=t.selection.ranges[i];t.doc.nodesBetween(o,l,(a,c)=>{if(s)return!1;if(!(!a.isTextblock||a.hasMarkup(n,e)))if(a.type==n)s=!0;else{let u=t.doc.resolve(c),d=u.index();s=u.parent.canReplaceWith(d,d+1,n)}})}if(!s)return!1;if(r){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:a}}=t.selection.ranges[o];i.setBlockType(l,a,n,e)}r(i.scrollIntoView())}return!0}}function Sl(...n){return function(e,t,r){for(let s=0;s<n.length;s++)if(n[s](e,t,r))return!0;return!1}}Sl(xl,Id,Ld);Sl(xl,jd,Bd);Sl(Hd,Fd,Vd,Qm);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function rg(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i);if(!o)return!1;let l=r?t.tr:null;return sg(l,o,n,e)?(r&&r(l.scrollIntoView()),!0):!1}}function sg(n,e,t,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let a=o.resolve(e.start-2);i=new ps(a,a,e.depth),e.endIndex<e.parent.childCount&&(e=new ps(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let l=cl(i,t,r,e);return l?(n&&ig(n,e,l,s,t),!0):!1}function ig(n,e,t,r,s){let i=k.empty;for(let u=t.length-1;u>=0;u--)i=k.from(t[u].type.create(t[u].attrs,i));n.step(new Me(e.start-(r?2:0),e.end,e.start,e.end,new O(i,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==s&&(o=u+1);let l=t.length-o,a=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,f=!0;u<d;u++,f=!1)!f&&Dt(n.doc,a,l)&&(n.split(a,l),a+=2*l),a+=c.child(u).nodeSize;return n}function og(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?lg(e,t,n,i):ag(e,t,i):!0:!1}}function lg(n,e,t,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new Me(i-1,o,i,o,new O(k.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new ps(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const l=Zn(r);if(l==null)return!1;s.lift(r,l);let a=s.doc.resolve(s.mapping.map(i,-1)-1);return nn(s.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&s.join(a.pos),e(s.scrollIntoView()),!0}function ag(n,e,t){let r=n.tr,s=t.parent;for(let h=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)h-=s.child(p).nodeSize,r.delete(h-1,h+1);let i=r.doc.resolve(t.start),o=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let l=t.startIndex==0,a=t.endIndex==s.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(l?0:1),u+1,o.content.append(a?k.empty:k.from(s))))return!1;let d=i.pos,f=d+o.nodeSize;return r.step(new Me(d-(l?1:0),f+(a?1:0),d+1,f-1,new O((l?k.empty:k.from(s.copy(k.empty))).append(a?k.empty:k.from(s.copy(k.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function cg(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let l=i.parent,a=l.child(o-1);if(a.type!=n)return!1;if(t){let c=a.lastChild&&a.lastChild.type==l.type,u=k.from(c?n.create():null),d=new O(k.from(n.create(null,k.from(l.type.create(null,u)))),c?3:1,0),f=i.start,h=i.end;t(e.tr.step(new Me(f-(c?3:1),h,f,h,d,1,!0)).scrollIntoView())}return!0}}function di(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,i=t.storedMarks,t}}}class fi{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:s}=t,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([l,a])=>[l,(...u)=>{const d=a(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,l=[],a=!!e,c=e||i.tr,u=()=>(!a&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),l.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,h])=>[f,(...m)=>{const C=this.buildProps(c,t),b=h(...m)(C);return l.push(b),d}])),run:u};return d}createCan(e){const{rawCommands:t,state:r}=this,s=!1,i=e||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(t).map(([a,c])=>[a,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,l={tr:e,editor:s,view:o,state:di({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([a,c])=>[a,(...u)=>c(...u)(l)]))}};return l}}class ug{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(s=>s!==t):delete this.callbacks[e]),this}once(e,t){const r=(...s)=>{this.off(e,r),t.apply(this,s)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function L(n,e,t){return n.config[e]===void 0&&n.parent?L(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?L(n.parent,e,t):null}):n.config[e]}function hi(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function Kd(n){const e=[],{nodeExtensions:t,markExtensions:r}=hi(n),s=[...t,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage,extensions:s},a=L(o,"addGlobalAttributes",l);if(!a)return;a().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([f,h])=>{e.push({type:d,name:f,attribute:{...i,...h}})})})})}),s.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},a=L(o,"addAttributes",l);if(!a)return;const c=a();Object.entries(c).forEach(([u,d])=>{const f={...i,...d};typeof f?.default=="function"&&(f.default=f.default()),f?.isRequired&&f?.default===void 0&&delete f.default,e.push({type:o.name,name:u,attribute:f})})}),e}function Ae(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function ae(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const l=i?String(i).split(" "):[],a=r[s]?r[s].split(" "):[],c=l.filter(u=>!a.includes(u));r[s]=[...a,...c].join(" ")}else if(s==="style"){const l=i?i.split(";").map(u=>u.trim()).filter(Boolean):[],a=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;a.forEach(u=>{const[d,f]=u.split(":").map(h=>h.trim());c.set(d,f)}),l.forEach(u=>{const[d,f]=u.split(":").map(h=>h.trim());c.set(d,f)}),r[s]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[s]=i}),r},{})}function ks(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>ae(t,r),{})}function Wd(n){return typeof n=="function"}function J(n,e=void 0,...t){return Wd(n)?e?n.bind(e)(...t):n(...t):n}function dg(n={}){return Object.keys(n).length===0&&n.constructor===Object}function fg(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function yc(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(t):fg(t.getAttribute(o.name));return l==null?i:{...i,[o.name]:l}},{});return{...r,...s}}}}function Cc(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&dg(t)?!1:t!=null))}function hg(n,e){var t;const r=Kd(n),{nodeExtensions:s,markExtensions:i}=hi(n),o=(t=s.find(c=>L(c,"topNode")))===null||t===void 0?void 0:t.name,l=Object.fromEntries(s.map(c=>{const u=r.filter(b=>b.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((b,v)=>{const x=L(v,"extendNodeSchema",d);return{...b,...x?x(c):{}}},{}),h=Cc({...f,content:J(L(c,"content",d)),marks:J(L(c,"marks",d)),group:J(L(c,"group",d)),inline:J(L(c,"inline",d)),atom:J(L(c,"atom",d)),selectable:J(L(c,"selectable",d)),draggable:J(L(c,"draggable",d)),code:J(L(c,"code",d)),whitespace:J(L(c,"whitespace",d)),linebreakReplacement:J(L(c,"linebreakReplacement",d)),defining:J(L(c,"defining",d)),isolating:J(L(c,"isolating",d)),attrs:Object.fromEntries(u.map(b=>{var v;return[b.name,{default:(v=b?.attribute)===null||v===void 0?void 0:v.default}]}))}),p=J(L(c,"parseHTML",d));p&&(h.parseDOM=p.map(b=>yc(b,u)));const m=L(c,"renderHTML",d);m&&(h.toDOM=b=>m({node:b,HTMLAttributes:ks(b,u)}));const C=L(c,"renderText",d);return C&&(h.toText=C),[c.name,h]})),a=Object.fromEntries(i.map(c=>{const u=r.filter(C=>C.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((C,b)=>{const v=L(b,"extendMarkSchema",d);return{...C,...v?v(c):{}}},{}),h=Cc({...f,inclusive:J(L(c,"inclusive",d)),excludes:J(L(c,"excludes",d)),group:J(L(c,"group",d)),spanning:J(L(c,"spanning",d)),code:J(L(c,"code",d)),attrs:Object.fromEntries(u.map(C=>{var b;return[C.name,{default:(b=C?.attribute)===null||b===void 0?void 0:b.default}]}))}),p=J(L(c,"parseHTML",d));p&&(h.parseDOM=p.map(C=>yc(C,u)));const m=L(c,"renderHTML",d);return m&&(h.toDOM=C=>m({mark:C,HTMLAttributes:ks(C,u)})),[c.name,h]}));return new Ou({topNode:o,nodes:l,marks:a})}function Ui(n,e){return e.nodes[n]||e.marks[n]||null}function bc(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function Ml(n,e){const t=An.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}const pg=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,l)=>{var a,c;const u=((c=(a=s.type.spec).toText)===null||c===void 0?void 0:c.call(a,{node:s,pos:i,parent:o,index:l}))||s.textContent||"%leaf%";t+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-i))}),t};function El(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Dr{constructor(e){this.find=e.find,this.handler=e.handler}}const mg=(n,e)=>{if(El(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Ur(n){var e;const{editor:t,from:r,to:s,text:i,rules:o,plugin:l}=n,{view:a}=t;if(a.composing)return!1;const c=a.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code))return!1;let u=!1;const d=pg(c)+i;return o.forEach(f=>{if(u)return;const h=mg(d,f.find);if(!h)return;const p=a.state.tr,m=di({state:a.state,transaction:p}),C={from:r-(h[0].length-i.length),to:s},{commands:b,chain:v,can:x}=new fi({editor:t,state:m});f.handler({state:m,range:C,match:h,commands:b,chain:v,can:x})===null||!p.steps.length||(p.setMeta(l,{transform:p,from:r,to:s,text:i}),a.dispatch(p),u=!0)}),u}function gg(n){const{editor:e,rules:t}=n,r=new ke({state:{init(){return null},apply(s,i,o){const l=s.getMeta(r);if(l)return l;const a=s.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:u}=a;typeof u=="string"?u=u:u=Ml(k.from(u),o.schema);const{from:d}=a,f=d+u.length;Ur({editor:e,from:d,to:f,text:u,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,l){return Ur({editor:e,from:i,to:o,text:l,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&Ur({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?Ur({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function yg(n){return Object.prototype.toString.call(n).slice(8,-1)}function _r(n){return yg(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function pi(n,e){const t={...n};return _r(n)&&_r(e)&&Object.keys(e).forEach(r=>{_r(e[r])&&_r(n[r])?t[r]=pi(n[r],e[r]):t[r]=e[r]}),t}class it{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=J(L(this,"addOptions",{name:this.name}))),this.storage=J(L(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new it(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>pi(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new it(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=J(L(t,"addOptions",{name:t.name})),t.storage=J(L(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>c?.type.name===t.name))return!1;const a=o.find(c=>c?.type.name===t.name);return a&&r.removeStoredMark(a),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}function Cg(n){return typeof n=="number"}class bg{constructor(e){this.find=e.find,this.handler=e.handler}}const xg=(n,e,t)=>{if(El(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=n,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function vg(n){const{editor:e,state:t,from:r,to:s,rule:i,pasteEvent:o,dropEvent:l}=n,{commands:a,chain:c,can:u}=new fi({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,s,(h,p)=>{if(!h.isTextblock||h.type.spec.code)return;const m=Math.max(r,p),C=Math.min(s,p+h.content.size),b=h.textBetween(m-p,C-p,void 0,"￼");xg(b,i.find,o).forEach(x=>{if(x.index===void 0)return;const w=m+x.index+1,M=w+x[0].length,T={from:t.tr.mapping.map(w),to:t.tr.mapping.map(M)},P=i.handler({state:t,range:T,match:x,commands:a,chain:c,can:u,pasteEvent:o,dropEvent:l});d.push(P)})}),d.every(h=>h!==null)}let qr=null;const kg=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function wg(n){const{editor:e,rules:t}=n;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const a=({state:u,from:d,to:f,rule:h,pasteEvt:p})=>{const m=u.tr,C=di({state:u,transaction:m});if(!(!vg({editor:e,state:C,from:Math.max(d-1,0),to:f.b-1,rule:h,pasteEvent:p,dropEvent:l})||!m.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return t.map(u=>new ke({view(d){const f=p=>{var m;r=!((m=d.dom.parentElement)===null||m===void 0)&&m.contains(p.target)?d.dom.parentElement:null,r&&(qr=e)},h=()=>{qr&&(qr=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(d,f)=>{if(i=r===d.dom.parentElement,l=f,!i){const h=qr;h&&setTimeout(()=>{const p=h.state.selection;p&&h.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(d,f)=>{var h;const p=(h=f.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return o=f,s=!!p?.includes("data-pm-slice"),!1}}},appendTransaction:(d,f,h)=>{const p=d[0],m=p.getMeta("uiEvent")==="paste"&&!s,C=p.getMeta("uiEvent")==="drop"&&!i,b=p.getMeta("applyPasteRules"),v=!!b;if(!m&&!C&&!v)return;if(v){let{text:M}=b;typeof M=="string"?M=M:M=Ml(k.from(M),h.schema);const{from:T}=b,P=T+M.length,R=kg(M);return a({rule:u,state:h,from:T,to:{b:P},pasteEvt:R})}const x=f.doc.content.findDiffStart(h.doc.content),w=f.doc.content.findDiffEnd(h.doc.content);if(!(!Cg(x)||!w||x===w.b))return a({rule:u,state:h,from:x,to:w,pasteEvt:o})}}))}function Sg(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}class Bn{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Bn.resolve(e),this.schema=hg(this.extensions,t),this.setupExtensions()}static resolve(e){const t=Bn.sort(Bn.flatten(e)),r=Sg(t.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},s=L(t,"addExtensions",r);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((r,s)=>{const i=L(r,"priority")||100,o=L(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Ui(t.name,this.schema)},s=L(t,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=Bn.sort([...this.extensions].reverse()),r=[],s=[],i=t.map(o=>{const l={name:o.name,options:o.options,storage:o.storage,editor:e,type:Ui(o.name,this.schema)},a=[],c=L(o,"addKeyboardShortcuts",l);let u={};if(o.type==="mark"&&L(o,"exitable",l)&&(u.ArrowRight=()=>it.handleExit({editor:e,mark:o})),c){const m=Object.fromEntries(Object.entries(c()).map(([C,b])=>[C,()=>b({editor:e})]));u={...u,...m}}const d=Km(u);a.push(d);const f=L(o,"addInputRules",l);bc(o,e.options.enableInputRules)&&f&&r.push(...f());const h=L(o,"addPasteRules",l);bc(o,e.options.enablePasteRules)&&h&&s.push(...h());const p=L(o,"addProseMirrorPlugins",l);if(p){const m=p();a.push(...m)}return a}).flat();return[gg({editor:e,rules:r}),...wg({editor:e,rules:s}),...i]}get attributes(){return Kd(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=hi(this.extensions);return Object.fromEntries(t.filter(r=>!!L(r,"addNodeView")).map(r=>{const s=this.attributes.filter(a=>a.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:Ae(r.name,this.schema)},o=L(r,"addNodeView",i);if(!o)return[];const l=(a,c,u,d,f)=>{const h=ks(a,s);return o()({node:a,view:c,getPos:u,decorations:d,innerDecorations:f,editor:e,extension:r,HTMLAttributes:h})};return[r.name,l]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Ui(e.name,this.schema)};e.type==="mark"&&(!((t=J(L(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const s=L(e,"onBeforeCreate",r),i=L(e,"onCreate",r),o=L(e,"onUpdate",r),l=L(e,"onSelectionUpdate",r),a=L(e,"onTransaction",r),c=L(e,"onFocus",r),u=L(e,"onBlur",r),d=L(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),a&&this.editor.on("transaction",a),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class we{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=J(L(this,"addOptions",{name:this.name}))),this.storage=J(L(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new we(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>pi(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new we({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=J(L(t,"addOptions",{name:t.name})),t.storage=J(L(t,"addStorage",{name:t.name,options:t.options})),t}}function Ud(n,e,t){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=t||{};let l="";return n.nodesBetween(r,s,(a,c,u,d)=>{var f;a.isBlock&&c>r&&(l+=i);const h=o?.[a.type.name];if(h)return u&&(l+=h({node:a,pos:c,parent:u,index:d,range:e})),!1;a.isText&&(l+=(f=a?.text)===null||f===void 0?void 0:f.slice(Math.max(r,c)-c,s-c))}),l}function _d(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const Mg=we.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new ke({key:new Ze("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(u=>u.$from.pos)),l=Math.max(...i.map(u=>u.$to.pos)),a=_d(t);return Ud(r,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}}),Eg=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),Tg=(n=!1)=>({commands:e})=>e.setContent("",n),Ag=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(l,a)=>{if(l.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(a)),f=c.resolve(u.map(a+l.nodeSize)),h=d.blockRange(f);if(!h)return;const p=Zn(h);if(l.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,m)}(p||p===0)&&e.lift(h,p)})}),!0},Rg=n=>e=>n(e),Ng=()=>({state:n,dispatch:e})=>Fd(n,e),Og=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,i=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new $(r.doc.resolve(o-1))),!0},Ig=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const l=s.before(i),a=s.after(i);n.delete(l,a).scrollIntoView()}return!0}return!1},Dg=n=>({tr:e,state:t,dispatch:r})=>{const s=Ae(n,t.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const a=i.before(o),c=i.after(o);e.delete(a,c).scrollIntoView()}return!0}return!1},Lg=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},Pg=()=>({state:n,dispatch:e})=>xl(n,e),jg=()=>({commands:n})=>n.keyboardShortcut("Enter"),Bg=()=>({state:n,dispatch:e})=>Zm(n,e);function ws(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:El(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function qd(n,e,t={}){return n.find(r=>r.type===e&&ws(Object.fromEntries(Object.keys(t).map(s=>[s,r.attrs[s]])),t))}function xc(n,e,t={}){return!!qd(n,e,t)}function mi(n,e,t){var r;if(!n||!e)return;let s=n.parent.childAfter(n.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===e))&&(s=n.parent.childBefore(n.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===e)||(t=t||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!qd([...s.node.marks],e,t)))return;let o=s.index,l=n.start()+s.offset,a=o+1,c=l+s.node.nodeSize;for(;o>0&&xc([...n.parent.child(o-1).marks],e,t);)o-=1,l-=n.parent.child(o).nodeSize;for(;a<n.parent.childCount&&xc([...n.parent.child(a).marks],e,t);)c+=n.parent.child(a).nodeSize,a+=1;return{from:l,to:c}}function sn(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const Hg=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const i=sn(n,r.schema),{doc:o,selection:l}=t,{$from:a,from:c,to:u}=l;if(s){const d=mi(a,i,e);if(d&&d.from<=c&&d.to>=u){const f=$.create(o,d.from,d.to);t.setSelection(f)}}return!0},Fg=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Jd(n){return n instanceof $}function mn(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function Zd(n,e=null){if(!e)return null;const t=K.atStart(n),r=K.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,i=r.to;return e==="all"?$.create(n,mn(0,s,i),mn(n.content.size,s,i)):$.create(n,mn(e,s,i),mn(e,s,i))}function Gd(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function gi(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Vg=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(gi()||Gd())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!Jd(t.state.selection))return o(),!0;const l=Zd(s.doc,n)||t.state.selection,a=t.state.selection.eq(l);return i&&(a||s.setSelection(l),a&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},zg=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),$g=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),Qd=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&Qd(r)}return n};function Jr(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return Qd(t)}function Mr(n,e,t){if(n instanceof Zt||n instanceof k)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return k.fromArray(n.map(l=>e.nodeFromJSON(l)));const o=e.nodeFromJSON(n);return t.errorOnInvalidContent&&o.check(),o}catch(i){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),Mr("",e,t)}if(s){if(t.errorOnInvalidContent){let o=!1,l="";const a=new Ou({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,l=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?Gt.fromSchema(a).parseSlice(Jr(n),t.parseOptions):Gt.fromSchema(a).parse(Jr(n),t.parseOptions),t.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const i=Gt.fromSchema(e);return t.slice?i.parseSlice(Jr(n),t.parseOptions).content:i.parse(Jr(n),t.parseOptions)}return Mr("",e,t)}function Kg(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof Se||s instanceof Me))return;const i=n.mapping.maps[r];let o=0;i.forEach((l,a,c,u)=>{o===0&&(o=u)}),n.setSelection(K.near(n.doc.resolve(o),t))}const Wg=n=>!("type"in n),Ug=(n,e,t)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){t={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let l;const a=C=>{i.emit("contentError",{editor:i,error:C,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{Mr(e,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(C){a(C)}try{l=Mr(e,i.schema,{parseOptions:c,errorOnInvalidContent:(o=t.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(C){return a(C),!1}let{from:u,to:d}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},f=!0,h=!0;if((Wg(l)?l:[l]).forEach(C=>{C.check(),f=f?C.isText&&C.marks.length===0:!1,h=h?C.isBlock:!1}),u===d&&h){const{parent:C}=r.doc.resolve(u);C.isTextblock&&!C.type.spec.code&&!C.childCount&&(u-=1,d+=1)}let m;if(f){if(Array.isArray(e))m=e.map(C=>C.text||"").join("");else if(e instanceof k){let C="";e.forEach(b=>{b.text&&(C+=b.text)}),m=C}else typeof e=="object"&&e&&e.text?m=e.text:m=e;r.insertText(m,u,d)}else m=l,r.replaceWith(u,d,m);t.updateSelection&&Kg(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:m}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:m})}return!0},_g=()=>({state:n,dispatch:e})=>_m(n,e),qg=()=>({state:n,dispatch:e})=>qm(n,e),Jg=()=>({state:n,dispatch:e})=>Id(n,e),Zg=()=>({state:n,dispatch:e})=>jd(n,e),Gg=()=>({state:n,dispatch:e,tr:t})=>{try{const r=ii(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},Qg=()=>({state:n,dispatch:e,tr:t})=>{try{const r=ii(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},Yg=()=>({state:n,dispatch:e})=>Wm(n,e),Xg=()=>({state:n,dispatch:e})=>Um(n,e);function Yd(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function e0(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,i,o;for(let l=0;l<e.length-1;l+=1){const a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))s=!0;else if(/^s(hift)?$/i.test(a))i=!0;else if(/^mod$/i.test(a))gi()||Yd()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const t0=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const i=e0(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,l))});return a?.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function Er(n,e,t={}){const{from:r,to:s,empty:i}=n.selection,o=e?Ae(e,n.schema):null,l=[];n.doc.nodesBetween(r,s,(d,f)=>{if(d.isText)return;const h=Math.max(r,f),p=Math.min(s,f+d.nodeSize);l.push({node:d,from:h,to:p})});const a=s-r,c=l.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>ws(d.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((d,f)=>d+f.to-f.from,0)>=a}const n0=(n,e={})=>({state:t,dispatch:r})=>{const s=Ae(n,t.schema);return Er(t,s,e)?Jm(t,r):!1},r0=()=>({state:n,dispatch:e})=>Vd(n,e),s0=n=>({state:e,dispatch:t})=>{const r=Ae(n,e.schema);return og(r)(e,t)},i0=()=>({state:n,dispatch:e})=>Hd(n,e);function yi(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function vc(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}const o0=(n,e)=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const l=yi(typeof n=="string"?n:n.name,r.schema);return l?(l==="node"&&(i=Ae(n,r.schema)),l==="mark"&&(o=sn(n,r.schema)),s&&t.selection.ranges.forEach(a=>{r.doc.nodesBetween(a.$from.pos,a.$to.pos,(c,u)=>{i&&i===c.type&&t.setNodeMarkup(u,void 0,vc(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&t.addMark(u,u+c.nodeSize,o.create(vc(d.attrs,e)))})})}),!0):!1},l0=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),a0=()=>({tr:n,dispatch:e})=>{if(e){const t=new st(n.doc);n.setSelection(t)}return!0},c0=()=>({state:n,dispatch:e})=>Ld(n,e),u0=()=>({state:n,dispatch:e})=>Bd(n,e),d0=()=>({state:n,dispatch:e})=>Ym(n,e),f0=()=>({state:n,dispatch:e})=>tg(n,e),h0=()=>({state:n,dispatch:e})=>eg(n,e);function Do(n,e,t={},r={}){return Mr(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const p0=(n,e=!1,t={},r={})=>({editor:s,tr:i,dispatch:o,commands:l})=>{var a,c;const{doc:u}=i;if(t.preserveWhitespace!=="full"){const d=Do(n,s.schema,t,{errorOnInvalidContent:(a=r.errorOnInvalidContent)!==null&&a!==void 0?a:s.options.enableContentCheck});return o&&i.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return o&&i.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck})};function Xd(n,e){const t=sn(e,n.schema),{from:r,to:s,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,a=>{o.push(...a.marks)});const l=o.find(a=>a.type.name===t.name);return l?{...l.attrs}:{}}function m0(n,e){const t=new qu(n);return e.forEach(r=>{r.steps.forEach(s=>{t.step(s)})}),t}function g0(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function y0(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(s,i)=>{t(s)&&r.push({node:s,pos:i})}),r}function C0(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Tl(n){return e=>C0(e.$from,n)}function b0(n,e){const t={from:0,to:n.content.size};return Ud(n,t,e)}function x0(n,e){const t=Ae(e,n.schema),{from:r,to:s}=n.selection,i=[];n.doc.nodesBetween(r,s,l=>{i.push(l)});const o=i.reverse().find(l=>l.type.name===t.name);return o?{...o.attrs}:{}}function ef(n,e){const t=yi(typeof e=="string"?e:e.name,n.schema);return t==="node"?x0(n,e):t==="mark"?Xd(n,e):{}}function v0(n,e=JSON.stringify){const t={};return n.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(t,s)?!1:t[s]=!0})}function k0(n){const e=v0(n);return e.length===1?e:e.filter((t,r)=>!e.filter((i,o)=>o!==r).some(i=>t.oldRange.from>=i.oldRange.from&&t.oldRange.to<=i.oldRange.to&&t.newRange.from>=i.newRange.from&&t.newRange.to<=i.newRange.to))}function w0(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((s,i)=>{const o=[];if(s.ranges.length)s.forEach((l,a)=>{o.push({from:l,to:a})});else{const{from:l,to:a}=t[i];if(l===void 0||a===void 0)return;o.push({from:l,to:a})}o.forEach(({from:l,to:a})=>{const c=e.slice(i).map(l,-1),u=e.slice(i).map(a),d=e.invert().map(c,-1),f=e.invert().map(u);r.push({oldRange:{from:d,to:f},newRange:{from:c,to:u}})})}),k0(r)}function Al(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const i=t.resolve(n),o=mi(i,s.type);o&&r.push({mark:s,...o})}):t.nodesBetween(n,e,(s,i)=>{!s||s?.nodeSize===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function ls(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function Lo(n,e,t={}){const{empty:r,ranges:s}=n.selection,i=e?sn(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>i?i.name===d.type.name:!0).find(d=>ws(d.attrs,t,{strict:!1}));let o=0;const l=[];if(s.forEach(({$from:d,$to:f})=>{const h=d.pos,p=f.pos;n.doc.nodesBetween(h,p,(m,C)=>{if(!m.isText&&!m.marks.length)return;const b=Math.max(h,C),v=Math.min(p,C+m.nodeSize),x=v-b;o+=x,l.push(...m.marks.map(w=>({mark:w,from:b,to:v})))})}),o===0)return!1;const a=l.filter(d=>i?i.name===d.mark.type.name:!0).filter(d=>ws(d.mark.attrs,t,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),c=l.filter(d=>i?d.mark.type!==i&&d.mark.type.excludes(i):!0).reduce((d,f)=>d+f.to-f.from,0);return(a>0?a+c:a)>=o}function S0(n,e,t={}){if(!e)return Er(n,null,t)||Lo(n,null,t);const r=yi(e,n.schema);return r==="node"?Er(n,e,t):r==="mark"?Lo(n,e,t):!1}function kc(n,e){const{nodeExtensions:t}=hi(e),r=t.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=J(L(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function Rl(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let s=!0;return n.content.forEach(i=>{s!==!1&&(Rl(i,{ignoreWhitespace:t,checkChildren:e})||(s=!1))}),s}return!1}function gt(n){return n instanceof B}function M0(n,e,t){var r;const{selection:s}=e;let i=null;if(Jd(s)&&(i=s.$cursor),i){const l=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!t.isInSet(l)||!l.some(a=>a.type.excludes(t))}const{ranges:o}=s;return o.some(({$from:l,$to:a})=>{let c=l.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(l.pos,a.pos,(u,d,f)=>{if(c)return!1;if(u.isInline){const h=!f||f.type.allowsMarkType(t),p=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=h&&p}return!c}),c})}const E0=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:i}=t,{empty:o,ranges:l}=i,a=sn(n,r.schema);if(s)if(o){const c=Xd(r,a);t.addStoredMark(a.create({...c,...e}))}else l.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(f,h)=>{const p=Math.max(h,u),m=Math.min(h+f.nodeSize,d);f.marks.find(b=>b.type===a)?f.marks.forEach(b=>{a===b.type&&t.addMark(p,m,a.create({...b.attrs,...e}))}):t.addMark(p,m,a.create(e))})});return M0(r,t,a)},T0=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),A0=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const i=Ae(n,t.schema);let o;return t.selection.$anchor.sameParent(t.selection.$head)&&(o=t.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:l})=>gc(i,{...o,...e})(t)?!0:l.clearNodes()).command(({state:l})=>gc(i,{...o,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},R0=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=mn(n,0,r.content.size),i=B.create(r,s);e.setSelection(i)}return!0},N0=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:i}=typeof n=="number"?{from:n,to:n}:n,o=$.atStart(r).from,l=$.atEnd(r).to,a=mn(s,o,l),c=mn(i,o,l),u=$.create(r,a,c);e.setSelection(u)}return!0},O0=n=>({state:e,dispatch:t})=>{const r=Ae(n,e.schema);return cg(r)(e,t)};function wc(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e?.includes(s.type.name));n.tr.ensureMarks(r)}}const I0=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:l,$to:a}=i,c=s.extensionManager.attributes,u=ls(c,l.node().type.name,l.node().attrs);if(i instanceof B&&i.node.isBlock)return!l.parentOffset||!Dt(o,l.pos)?!1:(r&&(n&&wc(t,s.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const d=a.parentOffset===a.parent.content.size,f=l.depth===0?void 0:g0(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=d&&f?[{type:f,attrs:u}]:void 0,p=Dt(e.doc,e.mapping.map(l.pos),1,h);if(!h&&!p&&Dt(e.doc,e.mapping.map(l.pos),1,f?[{type:f}]:void 0)&&(p=!0,h=f?[{type:f,attrs:u}]:void 0),r){if(p&&(i instanceof $&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,h),f&&!d&&!l.parentOffset&&l.parent.type!==f)){const m=e.mapping.map(l.before()),C=e.doc.resolve(m);l.node(-1).canReplaceWith(C.index(),C.index()+1,f)&&e.setNodeMarkup(e.mapping.map(l.before()),f)}n&&wc(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return p},D0=(n,e={})=>({tr:t,state:r,dispatch:s,editor:i})=>{var o;const l=Ae(n,r.schema),{$from:a,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||a.depth<2||!a.sameParent(c))return!1;const d=a.node(-1);if(d.type!==l)return!1;const f=i.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==l||a.index(-2)!==a.node(-2).childCount-1)return!1;if(s){let b=k.empty;const v=a.index(-1)?1:a.index(-2)?2:3;for(let R=a.depth-v;R>=a.depth-3;R-=1)b=k.from(a.node(R).copy(b));const x=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,w={...ls(f,a.node().type.name,a.node().attrs),...e},M=((o=l.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(w))||void 0;b=b.append(k.from(l.createAndFill(null,M)||void 0));const T=a.before(a.depth-(v-1));t.replace(T,a.after(-x),new O(b,4-v,0));let P=-1;t.doc.nodesBetween(T,t.doc.content.size,(R,z)=>{if(P>-1)return!1;R.isTextblock&&R.content.size===0&&(P=z+1)}),P>-1&&t.setSelection($.near(t.doc.resolve(P))),t.scrollIntoView()}return!0}const h=c.pos===a.end()?d.contentMatchAt(0).defaultType:null,p={...ls(f,d.type.name,d.attrs),...e},m={...ls(f,a.node().type.name,a.node().attrs),...e};t.delete(a.pos,c.pos);const C=h?[{type:l,attrs:p},{type:h,attrs:m}]:[{type:l,attrs:p}];if(!Dt(t.doc,a.pos,2))return!1;if(s){const{selection:b,storedMarks:v}=r,{splittableMarks:x}=i.extensionManager,w=v||b.$to.parentOffset&&b.$from.marks();if(t.split(a.pos,2,C).scrollIntoView(),!w||!s)return!0;const M=w.filter(T=>x.includes(T.type.name));t.ensureMarks(M)}return!0},_i=(n,e)=>{const t=Tl(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===s?.type&&nn(n.doc,t.pos)&&n.join(t.pos),!0},qi=(n,e)=>{const t=Tl(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===s?.type&&nn(n.doc,r)&&n.join(r),!0},L0=(n,e,t,r={})=>({editor:s,tr:i,state:o,dispatch:l,chain:a,commands:c,can:u})=>{const{extensions:d,splittableMarks:f}=s.extensionManager,h=Ae(n,o.schema),p=Ae(e,o.schema),{selection:m,storedMarks:C}=o,{$from:b,$to:v}=m,x=b.blockRange(v),w=C||m.$to.parentOffset&&m.$from.marks();if(!x)return!1;const M=Tl(T=>kc(T.type.name,d))(m);if(x.depth>=1&&M&&x.depth-M.depth<=1){if(M.node.type===h)return c.liftListItem(p);if(kc(M.node.type.name,d)&&h.validContent(M.node.content)&&l)return a().command(()=>(i.setNodeMarkup(M.pos,h),!0)).command(()=>_i(i,h)).command(()=>qi(i,h)).run()}return!t||!w||!l?a().command(()=>u().wrapInList(h,r)?!0:c.clearNodes()).wrapInList(h,r).command(()=>_i(i,h)).command(()=>qi(i,h)).run():a().command(()=>{const T=u().wrapInList(h,r),P=w.filter(R=>f.includes(R.type.name));return i.ensureMarks(P),T?!0:c.clearNodes()}).wrapInList(h,r).command(()=>_i(i,h)).command(()=>qi(i,h)).run()},P0=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=t,o=sn(n,r.schema);return Lo(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},j0=(n,e,t={})=>({state:r,commands:s})=>{const i=Ae(n,r.schema),o=Ae(e,r.schema),l=Er(r,i,t);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),l?s.setNode(o,a):s.setNode(i,{...a,...t})},B0=(n,e={})=>({state:t,commands:r})=>{const s=Ae(n,t.schema);return Er(t,s,e)?r.lift(s):r.wrapIn(s,e)},H0=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let i;if(s.spec.isInputRules&&(i=s.getState(n))){if(e){const o=n.tr,l=i.transform;for(let a=l.steps.length-1;a>=0;a-=1)o.step(l.steps[a].invert(l.docs[a]));if(i.text){const a=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,a))}else o.delete(i.from,i.to)}return!0}}return!1},F0=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},V0=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=t,a=sn(n,r.schema),{$from:c,empty:u,ranges:d}=l;if(!s)return!0;if(u&&o){let{from:f,to:h}=l;const p=(i=c.marks().find(C=>C.type===a))===null||i===void 0?void 0:i.attrs,m=mi(c,a,p);m&&(f=m.from,h=m.to),t.removeMark(f,h,a)}else d.forEach(f=>{t.removeMark(f.$from.pos,f.$to.pos,a)});return t.removeStoredMark(a),!0},z0=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const l=yi(typeof n=="string"?n:n.name,r.schema);return l?(l==="node"&&(i=Ae(n,r.schema)),l==="mark"&&(o=sn(n,r.schema)),s&&t.selection.ranges.forEach(a=>{const c=a.$from.pos,u=a.$to.pos;let d,f,h,p;t.selection.empty?r.doc.nodesBetween(c,u,(m,C)=>{i&&i===m.type&&(h=Math.max(C,c),p=Math.min(C+m.nodeSize,u),d=C,f=m)}):r.doc.nodesBetween(c,u,(m,C)=>{C<c&&i&&i===m.type&&(h=Math.max(C,c),p=Math.min(C+m.nodeSize,u),d=C,f=m),C>=c&&C<=u&&(i&&i===m.type&&t.setNodeMarkup(C,void 0,{...m.attrs,...e}),o&&m.marks.length&&m.marks.forEach(b=>{if(o===b.type){const v=Math.max(C,c),x=Math.min(C+m.nodeSize,u);t.addMark(v,x,o.create({...b.attrs,...e}))}}))}),f&&(d!==void 0&&t.setNodeMarkup(d,void 0,{...f.attrs,...e}),o&&f.marks.length&&f.marks.forEach(m=>{o===m.type&&t.addMark(h,p,o.create({...m.attrs,...e}))}))}),!0):!1},$0=(n,e={})=>({state:t,dispatch:r})=>{const s=Ae(n,t.schema);return ng(s,e)(t,r)},K0=(n,e={})=>({state:t,dispatch:r})=>{const s=Ae(n,t.schema);return rg(s,e)(t,r)};var W0=Object.freeze({__proto__:null,blur:Eg,clearContent:Tg,clearNodes:Ag,command:Rg,createParagraphNear:Ng,cut:Og,deleteCurrentNode:Ig,deleteNode:Dg,deleteRange:Lg,deleteSelection:Pg,enter:jg,exitCode:Bg,extendMarkRange:Hg,first:Fg,focus:Vg,forEach:zg,insertContent:$g,insertContentAt:Ug,joinBackward:Jg,joinDown:qg,joinForward:Zg,joinItemBackward:Gg,joinItemForward:Qg,joinTextblockBackward:Yg,joinTextblockForward:Xg,joinUp:_g,keyboardShortcut:t0,lift:n0,liftEmptyBlock:r0,liftListItem:s0,newlineInCode:i0,resetAttributes:o0,scrollIntoView:l0,selectAll:a0,selectNodeBackward:c0,selectNodeForward:u0,selectParentNode:d0,selectTextblockEnd:f0,selectTextblockStart:h0,setContent:p0,setMark:E0,setMeta:T0,setNode:A0,setNodeSelection:R0,setTextSelection:N0,sinkListItem:O0,splitBlock:I0,splitListItem:D0,toggleList:L0,toggleMark:P0,toggleNode:j0,toggleWrap:B0,undoInputRule:H0,unsetAllMarks:F0,unsetMark:V0,updateAttributes:z0,wrapIn:$0,wrapInList:K0});const U0=we.create({name:"commands",addCommands(){return{...W0}}}),_0=we.create({name:"drop",addProseMirrorPlugins(){return[new ke({key:new Ze("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),q0=we.create({name:"editable",addProseMirrorPlugins(){return[new ke({key:new Ze("editable"),props:{editable:()=>this.editor.options.editable}})]}}),J0=new Ze("focusEvents"),Z0=we.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new ke({key:J0,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),G0=we.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:a,doc:c}=l,{empty:u,$anchor:d}=a,{pos:f,parent:h}=d,p=d.parent.isTextblock&&f>0?l.doc.resolve(f-1):d,m=p.parent.type.spec.isolating,C=d.pos-d.parentOffset,b=m&&p.parent.childCount===1?C===d.pos:K.atStart(c).from===f;return!u||!h.type.isTextblock||h.textContent.length||!b||b&&d.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return gi()||Yd()?i:s},addProseMirrorPlugins(){return[new ke({key:new Ze("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(m=>m.getMeta("composition")))return;const r=n.some(m=>m.docChanged)&&!e.doc.eq(t.doc),s=n.some(m=>m.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:l}=e.selection,a=K.atStart(e.doc).from,c=K.atEnd(e.doc).to;if(i||!(o===a&&l===c)||!Rl(t.doc))return;const f=t.tr,h=di({state:t,transaction:f}),{commands:p}=new fi({editor:this.editor,state:h});if(p.clearNodes(),!!f.steps.length)return f}})]}}),Q0=we.create({name:"paste",addProseMirrorPlugins(){return[new ke({key:new Ze("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),Y0=we.create({name:"tabindex",addProseMirrorPlugins(){return[new ke({key:new Ze("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class fn{get name(){return this.node.type.name}constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new fn(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new fn(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new fn(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,o=this.pos+r+(i?0:1),l=this.resolvedPos.doc.resolve(o);if(!s&&l.depth<=this.depth)return;const a=new fn(l,this.editor,s,s?t:null);s&&(a.actualDepth=this.depth+1),e.push(new fn(l,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const i=s.node.attrs,o=Object.keys(t);for(let l=0;l<o.length;l+=1){const a=o[l];if(i[a]!==t[a])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(t);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(a=>t[a]===o.node.attrs[a])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,t,r))))}),s}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const X0=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function e2(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}class t2 extends ug{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:r,moved:s})=>this.options.onDrop(t,r,s)),this.on("paste",({event:t,slice:r})=>this.options.onPaste(t,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=e2(X0,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=Wd(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;r=r.filter(l=>!l.key.startsWith(o))}),t.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[q0,Mg.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),U0,Z0,G0,Y0,_0,Q0].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Bn(s,this)}createCommandManager(){this.commandManager=new fi({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=Do(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(l=>l.name!=="collaboration"),this.createExtensionManager()}}),t=Do(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=Zd(t,this.options.autofocus);this.view=new Rd(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:jn.create({doc:t,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return ef(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return S0(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ml(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return b0(this.state.doc,{blockSeparator:t,textSerializers:{..._d(this.schema),...r}})}get isEmpty(){return Rl(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new fn(t,this)}get $doc(){return this.$pos(0)}}function En(n){return new Dr({find:n.find,handler:({state:e,range:t,match:r})=>{const s=J(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],l=r[0];if(o){const a=l.search(/\S/),c=t.from+l.indexOf(o),u=c+o.length;if(Al(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===n.type&&m!==h.mark.type)).filter(h=>h.to>c).length)return null;u<t.to&&i.delete(u,t.to),c>t.from&&i.delete(t.from+a,c);const f=t.from+a+o.length;i.addMark(t.from+a,f,n.type.create(s||{})),i.removeStoredMark(n.type)}}})}function tf(n){return new Dr({find:n.find,handler:({state:e,range:t,match:r})=>{const s=J(n.getAttributes,void 0,r)||{},{tr:i}=e,o=t.from;let l=t.to;const a=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>l?u=l:l=u+r[1].length;const d=r[0][r[0].length-1];i.insertText(d,o+r[0].length-1),i.replaceWith(u,l,a)}else if(r[0]){const c=n.type.isInline?o:o-1;i.insert(c,n.type.create(s)).delete(i.mapping.map(o),i.mapping.map(l))}i.scrollIntoView()}})}function Po(n){return new Dr({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),i=J(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function me(n){return new Dr({find:n.find,handler:({state:e,range:t,match:r})=>{let s=n.replace,i=t.from;const o=t.to;if(r[1]){const l=r[0].lastIndexOf(r[1]);s+=r[0].slice(l+r[1].length),i+=l;const a=i-o;a>0&&(s=r[0].slice(l-a,l)+s,i=o)}e.tr.insertText(s,i,o)}})}function _n(n){return new Dr({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const i=J(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),a=o.doc.resolve(t.from).blockRange(),c=a&&cl(a,n.type,i);if(!c)return null;if(o.wrap(a,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:h}=n.editor.extensionManager,p=f||d.$to.parentOffset&&d.$from.marks();if(p){const m=p.filter(C=>h.includes(C.type.name));o.ensureMarks(m)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,i).run()}const u=o.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&nn(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(t.from-1)}})}let Ge=class jo{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=J(L(this,"addOptions",{name:this.name}))),this.storage=J(L(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new jo(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>pi(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new jo(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=J(L(t,"addOptions",{name:t.name})),t.storage=J(L(t,"addStorage",{name:t.name,options:t.options})),t}};class n2{constructor(e,t,r){this.isDragging=!1,this.component=e,this.editor=t.editor,this.options={stopEvent:null,ignoreMutation:null,...r},this.extension=t.extension,this.node=t.node,this.decorations=t.decorations,this.innerDecorations=t.innerDecorations,this.view=t.view,this.HTMLAttributes=t.HTMLAttributes,this.getPos=t.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var t,r,s,i,o,l,a;const{view:c}=this.editor,u=e.target,d=u.nodeType===3?(t=u.parentElement)===null||t===void 0?void 0:t.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||!((r=this.contentDOM)===null||r===void 0)&&r.contains(u)||!d)return;let f=0,h=0;if(this.dom!==d){const v=this.dom.getBoundingClientRect(),x=d.getBoundingClientRect(),w=(s=e.offsetX)!==null&&s!==void 0?s:(i=e.nativeEvent)===null||i===void 0?void 0:i.offsetX,M=(o=e.offsetY)!==null&&o!==void 0?o:(l=e.nativeEvent)===null||l===void 0?void 0:l.offsetY;f=x.x-v.x+w,h=x.y-v.y+M}const p=this.dom.cloneNode(!0);(a=e.dataTransfer)===null||a===void 0||a.setDragImage(p,f,h);const m=this.getPos();if(typeof m!="number")return;const C=B.create(c.state.doc,m),b=c.state.tr.setSelection(C);c.dispatch(b)}stopEvent(e){var t;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:e});const r=e.target;if(!(this.dom.contains(r)&&!(!((t=this.contentDOM)===null||t===void 0)&&t.contains(r))))return!1;const i=e.type.startsWith("drag"),o=e.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(r.tagName)||r.isContentEditable)&&!o&&!i)return!0;const{isEditable:a}=this.editor,{isDragging:c}=this,u=!!this.node.type.spec.draggable,d=B.isSelectable(this.node),f=e.type==="copy",h=e.type==="paste",p=e.type==="cut",m=e.type==="mousedown";if(!u&&d&&i&&e.target===this.dom&&e.preventDefault(),u&&i&&!c&&e.target===this.dom)return e.preventDefault(),!1;if(u&&a&&!c&&m){const C=r.closest("[data-drag-handle]");C&&(this.dom===C||this.dom.contains(C))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(c||o||f||h||p||m&&d)}ignoreMutation(e){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:e}):this.node.isLeaf||this.node.isAtom?!0:e.type==="selection"||this.dom.contains(e.target)&&e.type==="childList"&&(gi()||Gd())&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(r=>r.isContentEditable)?!1:this.contentDOM===e.target&&e.type==="attributes"?!0:!this.contentDOM.contains(e.target)}updateAttributes(e){this.editor.commands.command(({tr:t})=>{const r=this.getPos();return typeof r!="number"?!1:(t.setNodeMarkup(r,void 0,{...this.node.attrs,...e}),!0)})}deleteNode(){const e=this.getPos();if(typeof e!="number")return;const t=e+this.node.nodeSize;this.editor.commands.deleteRange({from:e,to:t})}}function tn(n){return new bg({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const i=J(n.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,l=r[r.length-1],a=r[0];let c=t.to;if(l){const u=a.search(/\S/),d=t.from+a.indexOf(l),f=d+l.length;if(Al(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(C=>C===n.type&&C!==p.mark.type)).filter(p=>p.to>d).length)return null;f<t.to&&o.delete(f,t.to),d>t.from&&o.delete(t.from+u,d),c=t.from+u+l.length,o.addMark(t.from+u,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function r2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var nf={exports:{}},Ji={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sc;function s2(){if(Sc)return Ji;Sc=1;var n=De;function e(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,i=n.useLayoutEffect,o=n.useDebugValue;function l(d,f){var h=f(),p=r({inst:{value:h,getSnapshot:f}}),m=p[0].inst,C=p[1];return i(function(){m.value=h,m.getSnapshot=f,a(m)&&C({inst:m})},[d,h,f]),s(function(){return a(m)&&C({inst:m}),d(function(){a(m)&&C({inst:m})})},[d]),o(h),h}function a(d){var f=d.getSnapshot;d=d.value;try{var h=f();return!t(d,h)}catch{return!0}}function c(d,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:l;return Ji.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,Ji}nf.exports=s2();var Nl=nf.exports;const i2=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},o2=({contentComponent:n})=>{const e=Nl.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return De.createElement(De.Fragment,null,Object.values(e))};function l2(){const n=new Set;let e={};return{subscribe(t){return n.add(t),()=>{n.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,r){e={...e,[t]:qh.createPortal(r.reactElement,r.element,t)},n.forEach(s=>s())},removeRenderer(t){const r={...e};delete r[t],e=r,n.forEach(s=>s())}}}class a2 extends De.Component{constructor(e){var t;super(e),this.editorContentRef=De.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((t=e.editor)===null||t===void 0)&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=l2(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...r}=this.props;return De.createElement(De.Fragment,null,De.createElement("div",{ref:i2(t,this.editorContentRef),...r}),e?.contentComponent&&De.createElement(o2,{contentComponent:e.contentComponent}))}}const c2=y.forwardRef((n,e)=>{const t=De.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return De.createElement(a2,{key:t,innerRef:e,...n})}),u2=De.memo(c2);var d2=function n(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(!n(e[s],t[s]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;for(s of e.entries())if(!n(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(e[s]!==t[s])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!(o==="_owner"&&e.$$typeof)&&!n(e[o],t[o]))return!1}return!0}return e!==e&&t!==t},f2=r2(d2),rf={exports:{}},Zi={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mc;function h2(){if(Mc)return Zi;Mc=1;var n=De,e=Nl;function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,i=n.useRef,o=n.useEffect,l=n.useMemo,a=n.useDebugValue;return Zi.useSyncExternalStoreWithSelector=function(c,u,d,f,h){var p=i(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=l(function(){function b(T){if(!v){if(v=!0,x=T,T=f(T),h!==void 0&&m.hasValue){var P=m.value;if(h(P,T))return w=P}return w=T}if(P=w,r(x,T))return P;var R=f(T);return h!==void 0&&h(P,R)?P:(x=T,w=R)}var v=!1,x,w,M=d===void 0?null:d;return[function(){return b(u())},M===null?void 0:function(){return b(M())}]},[u,d,f,h]);var C=s(c,p[0],p[1]);return o(function(){m.hasValue=!0,m.value=C},[C]),a(C),C},Zi}rf.exports=h2();var p2=rf.exports;const m2=typeof window<"u"?y.useLayoutEffect:y.useEffect;class g2{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(s=>s())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}}function y2(n){var e;const[t]=y.useState(()=>new g2(n.editor)),r=p2.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,n.selector,(e=n.equalityFn)!==null&&e!==void 0?e:f2);return m2(()=>t.watch(n.editor),[n.editor,t]),y.useDebugValue(r),r}const C2=!1,Bo=typeof window>"u",b2=Bo||!!(typeof window<"u"&&window.next);class Ol{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Bo||b2?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onBeforeCreate)===null||i===void 0?void 0:i.call(s,...r)},onBlur:(...r)=>{var s,i;return(i=(s=this.options.current).onBlur)===null||i===void 0?void 0:i.call(s,...r)},onCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onCreate)===null||i===void 0?void 0:i.call(s,...r)},onDestroy:(...r)=>{var s,i;return(i=(s=this.options.current).onDestroy)===null||i===void 0?void 0:i.call(s,...r)},onFocus:(...r)=>{var s,i;return(i=(s=this.options.current).onFocus)===null||i===void 0?void 0:i.call(s,...r)},onSelectionUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onSelectionUpdate)===null||i===void 0?void 0:i.call(s,...r)},onTransaction:(...r)=>{var s,i;return(i=(s=this.options.current).onTransaction)===null||i===void 0?void 0:i.call(s,...r)},onUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onUpdate)===null||i===void 0?void 0:i.call(s,...r)},onContentError:(...r)=>{var s,i;return(i=(s=this.options.current).onContentError)===null||i===void 0?void 0:i.call(s,...r)},onDrop:(...r)=>{var s,i;return(i=(s=this.options.current).onDrop)===null||i===void 0?void 0:i.call(s,...r)},onPaste:(...r)=>{var s,i;return(i=(s=this.options.current).onPaste)===null||i===void 0?void 0:i.call(s,...r)}};return new t2(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&t.extensions?e.extensions.length!==t.extensions.length?!1:e.extensions.every((s,i)=>{var o;return s===((o=t.extensions)===null||o===void 0?void 0:o[i])}):e[r]===t[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Ol.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function x2(n={},e=[]){const t=y.useRef(n);t.current=n;const[r]=y.useState(()=>new Ol(t)),s=Nl.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return y.useDebugValue(s),y.useEffect(r.onRender(e)),y2({editor:s,selector:({transactionNumber:i})=>n.shouldRerenderOnTransaction===!1?null:n.immediatelyRender&&i===0?0:i+1}),s}const Il=y.createContext({editor:null});Il.Consumer;const v2=()=>y.useContext(Il),sf=y.createContext({onDragStart:void 0}),k2=()=>y.useContext(sf),w2=De.forwardRef((n,e)=>{const{onDragStart:t}=k2(),r=n.as||"div";return De.createElement(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});function S2(n){return!!(typeof n=="function"&&n.prototype&&n.prototype.isReactComponent)}function M2(n){var e;return typeof n=="object"&&((e=n.$$typeof)===null||e===void 0?void 0:e.toString())==="Symbol(react.forward_ref)"}function E2(){try{if(y.version)return parseInt(y.version.split(".")[0],10)>=19}catch{}return!1}class T2{constructor(e,{editor:t,props:r={},as:s="div",className:i=""}){this.ref=null,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=e,this.editor=t,this.props=r,this.element=document.createElement(s),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?fu.flushSync(()=>{this.render()}):this.render()}render(){var e;const t=this.component,r=this.props,s=this.editor,i=E2(),o=S2(t),l=M2(t),a={...r};a.ref||(i?a.ref=c=>{this.ref=c}:(o||l)&&(a.ref=c=>{this.ref=c})),this.reactElement=De.createElement(t,{...a}),(e=s?.contentComponent)===null||e===void 0||e.setRenderer(this.id,this)}updateProps(e={}){this.props={...this.props,...e},this.render()}destroy(){var e;const t=this.editor;(e=t?.contentComponent)===null||e===void 0||e.removeRenderer(this.id)}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}}class A2 extends n2{mount(){const e={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(c={})=>this.updateAttributes(c),deleteNode:()=>this.deleteNode(),ref:y.createRef()};if(!this.component.displayName){const c=u=>u.charAt(0).toUpperCase()+u.substring(1);this.component.displayName=c(this.extension.name)}const s={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:c=>{c&&this.contentDOMElement&&c.firstChild!==this.contentDOMElement&&c.appendChild(this.contentDOMElement)}},i=this.component,o=y.memo(c=>De.createElement(sf.Provider,{value:s},y.createElement(i,c)));o.displayName="ReactNodeView",this.node.isLeaf?this.contentDOMElement=null:this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.style.whiteSpace="inherit");let l=this.node.isInline?"span":"div";this.options.as&&(l=this.options.as);const{className:a=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new T2(o,{editor:this.editor,props:e,as:l,className:`node-${this.node.type.name} ${a}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var e;if(this.renderer.element.firstElementChild&&!(!((e=this.renderer.element.firstElementChild)===null||e===void 0)&&e.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){const{from:e,to:t}=this.editor.state.selection,r=this.getPos();if(typeof r=="number")if(e<=r&&t>=r+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}}update(e,t,r){const s=i=>{this.renderer.updateProps(i),typeof this.options.attrs=="function"&&this.updateElementAttributes()};if(e.type!==this.node.type)return!1;if(typeof this.options.update=="function"){const i=this.node,o=this.decorations,l=this.innerDecorations;return this.node=e,this.decorations=t,this.innerDecorations=r,this.options.update({oldNode:i,oldDecorations:o,newNode:e,newDecorations:t,oldInnerDecorations:l,innerDecorations:r,updateProps:()=>s({node:e,decorations:t,innerDecorations:r})})}return e===this.node&&this.decorations===t&&this.innerDecorations===r||(this.node=e,this.decorations=t,this.innerDecorations=r,s({node:e,decorations:t,innerDecorations:r})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null}updateElementAttributes(){if(this.options.attrs){let e={};if(typeof this.options.attrs=="function"){const t=this.editor.extensionManager.attributes,r=ks(this.node,t);e=this.options.attrs({node:this.node,HTMLAttributes:r})}else e=this.options.attrs;this.renderer.updateAttributes(e)}}}function R2(n,e){return t=>t.editor.contentComponent?new A2(n,t,e):{}}var N2=typeof global=="object"&&global&&global.Object===Object&&global,O2=typeof self=="object"&&self&&self.Object===Object&&self,of=N2||O2||Function("return this")(),Ss=of.Symbol,lf=Object.prototype,I2=lf.hasOwnProperty,D2=lf.toString,er=Ss?Ss.toStringTag:void 0;function L2(n){var e=I2.call(n,er),t=n[er];try{n[er]=void 0;var r=!0}catch{}var s=D2.call(n);return r&&(e?n[er]=t:delete n[er]),s}var P2=Object.prototype,j2=P2.toString;function B2(n){return j2.call(n)}var H2="[object Null]",F2="[object Undefined]",Ec=Ss?Ss.toStringTag:void 0;function V2(n){return n==null?n===void 0?F2:H2:Ec&&Ec in Object(n)?L2(n):B2(n)}function z2(n){return n!=null&&typeof n=="object"}var $2="[object Symbol]";function K2(n){return typeof n=="symbol"||z2(n)&&V2(n)==$2}var W2=/\s/;function U2(n){for(var e=n.length;e--&&W2.test(n.charAt(e)););return e}var _2=/^\s+/;function q2(n){return n&&n.slice(0,U2(n)+1).replace(_2,"")}function Ho(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Tc=NaN,J2=/^[-+]0x[0-9a-f]+$/i,Z2=/^0b[01]+$/i,G2=/^0o[0-7]+$/i,Q2=parseInt;function Ac(n){if(typeof n=="number")return n;if(K2(n))return Tc;if(Ho(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Ho(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=q2(n);var t=Z2.test(n);return t||G2.test(n)?Q2(n.slice(2),t?2:8):J2.test(n)?Tc:+n}var Gi=function(){return of.Date.now()},Y2="Expected a function",X2=Math.max,ey=Math.min;function ty(n,e,t){var r,s,i,o,l,a,c=0,u=!1,d=!1,f=!0;if(typeof n!="function")throw new TypeError(Y2);e=Ac(e)||0,Ho(t)&&(u=!!t.leading,d="maxWait"in t,i=d?X2(Ac(t.maxWait)||0,e):i,f="trailing"in t?!!t.trailing:f);function h(T){var P=r,R=s;return r=s=void 0,c=T,o=n.apply(R,P),o}function p(T){return c=T,l=setTimeout(b,e),u?h(T):o}function m(T){var P=T-a,R=T-c,z=e-P;return d?ey(z,i-R):z}function C(T){var P=T-a,R=T-c;return a===void 0||P>=e||P<0||d&&R>=i}function b(){var T=Gi();if(C(T))return v(T);l=setTimeout(b,m(T))}function v(T){return l=void 0,f&&r?h(T):(r=s=void 0,o)}function x(){l!==void 0&&clearTimeout(l),c=0,r=a=s=l=void 0}function w(){return l===void 0?o:v(Gi())}function M(){var T=Gi(),P=C(T);if(r=arguments,s=this,a=T,P){if(l===void 0)return p(a);if(d)return clearTimeout(l),l=setTimeout(b,e),h(a)}return l===void 0&&(l=setTimeout(b,e)),o}return M.cancel=x,M.flush=w,M}const ny=/^\s*>\s$/,ry=Ge.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[_n({find:ny,type:this.type})]}}),sy=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,iy=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,oy=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,ly=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,ay=it.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[En({find:sy,type:this.type}),En({find:oy,type:this.type})]},addPasteRules(){return[tn({find:iy,type:this.type}),tn({find:ly,type:this.type})]}}),cy="listItem",Rc="textStyle",Nc=/^\s*([-+*])\s$/,uy=Ge.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(cy,this.editor.getAttributes(Rc)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=_n({find:Nc,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=_n({find:Nc,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Rc),editor:this.editor})),[n]}}),dy=/(^|[^`])`([^`]+)`(?!`)/,fy=/(^|[^`])`([^`]+)`(?!`)/g,hy=it.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[En({find:dy,type:this.type})]},addPasteRules(){return[tn({find:fy,type:this.type})]}}),py=/^```([a-z]+)?[\s\n]$/,my=/^~~~([a-z]+)?[\s\n]$/,gy=Ge.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",ae(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:i}=t;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const l=s.after();return l===void 0?!1:r.nodeAt(l)?n.commands.command(({tr:c})=>(c.setSelection(K.near(r.resolve(l))),!0)):n.commands.exitCode()}}},addInputRules(){return[Po({find:py,type:this.type,getAttributes:n=>({language:n[1]})}),Po({find:my,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new ke({key:new Ze("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s?.mode;if(!t||!i)return!1;const{tr:o,schema:l}=n.state,a=l.text(t.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},a)),o.selection.$from.parent.type!==this.type&&o.setSelection($.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),yy=Ge.create({name:"doc",topNode:!0,content:"block+"});function Cy(n={}){return new ke({view(e){return new by(e,n)}})}class by{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,l=i.height/s.offsetHeight;if(t){let d=e.nodeBefore,f=e.nodeAfter;if(d||f){let h=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(h){let p=h.getBoundingClientRect(),m=d?p.bottom:p.top;d&&f&&(m=(m+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let C=this.width/2*l;r={left:p.left,right:p.right,top:m-C,bottom:m+C}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),f=this.width/2*o;r={left:d.left-f,right:d.left+f,top:d.top,bottom:d.bottom}}let a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,u;if(!a||a==document.body&&getComputedStyle(a).position=="static")c=-pageXOffset,u=-pageYOffset;else{let d=a.getBoundingClientRect(),f=d.width/a.offsetWidth,h=d.height/a.offsetHeight;c=d.left-a.scrollLeft*f,u=d.top-a.scrollTop*h}this.element.style.left=(r.left-c)/o+"px",this.element.style.top=(r.top-u)/l+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!i){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=$u(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const xy=we.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Cy(this.options)]}});class pe extends K{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return pe.valid(r)?new pe(r):K.near(r)}content(){return O.empty}eq(e){return e instanceof pe&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new pe(e.resolve(t.pos))}getBookmark(){return new Dl(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!vy(e)||!ky(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&pe.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let l=e.node(o);if(t>0?e.indexAfter(o)<l.childCount:e.index(o)>0){i=l.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=t;let a=e.doc.resolve(s);if(pe.valid(a))return a}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!B.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*t),r=!1;continue e}break}i=o,s+=t;let l=e.doc.resolve(s);if(pe.valid(l))return l}return null}}}pe.prototype.visible=!1;pe.findFrom=pe.findGapCursorFrom;K.jsonID("gapcursor",pe);class Dl{constructor(e){this.pos=e}map(e){return new Dl(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return pe.valid(t)?new pe(t):K.near(t)}}function vy(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function ky(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function wy(){return new ke({props:{decorations:Ty,createSelectionBetween(n,e,t){return e.pos==t.pos&&pe.valid(t)?new pe(t):null},handleClick:My,handleKeyDown:Sy,handleDOMEvents:{beforeinput:Ey}}})}const Sy=Nd({ArrowLeft:Zr("horiz",-1),ArrowRight:Zr("horiz",1),ArrowUp:Zr("vert",-1),ArrowDown:Zr("vert",1)});function Zr(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,l=e>0?o.$to:o.$from,a=o.empty;if(o instanceof $){if(!i.endOfTextblock(t)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let c=pe.findGapCursorFrom(l,e,a);return c?(s&&s(r.tr.setSelection(new pe(c))),!0):!1}}function My(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!pe.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&B.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new pe(r))),!0)}function Ey(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof pe))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=k.empty;for(let o=r.length-1;o>=0;o--)s=k.from(r[o].createAndFill(null,s));let i=n.state.tr.replace(t.pos,t.pos,new O(s,0,0));return i.setSelection($.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function Ty(n){if(!(n.selection instanceof pe))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",xe.create(n.doc,[rt.widget(n.selection.head,e,{key:"gapcursor"})])}const Ay=we.create({name:"gapCursor",addProseMirrorPlugins(){return[wy()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=J(L(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),Ry=Ge.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",ae(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:i}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,a=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&a&&o){const d=a.filter(f=>l.includes(f.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Ny=Ge.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,ae(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>Po({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Ms=200,Ee=function(){};Ee.prototype.append=function(e){return e.length?(e=Ee.from(e),!this.length&&e||e.length<Ms&&this.leafAppend(e)||this.length<Ms&&e.leafPrepend(this)||this.appendInner(e)):this};Ee.prototype.prepend=function(e){return e.length?Ee.from(e).append(this):this};Ee.prototype.appendInner=function(e){return new Oy(this,e)};Ee.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Ee.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Ee.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ee.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};Ee.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},t,r),s};Ee.from=function(e){return e instanceof Ee?e:e&&e.length?new af(e):Ee.empty};var af=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,l){for(var a=i;a<o;a++)if(s(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,l){for(var a=i-1;a>=o;a--)if(s(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Ms)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Ms)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Ee);Ee.empty=new af([]);var Oy=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var l=this.left.length;if(s<l&&this.left.forEachInner(r,s,Math.min(i,l),o)===!1||i>l&&this.right.forEachInner(r,Math.max(s-l,0),Math.min(this.length,i)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var l=this.left.length;if(s>l&&this.right.forEachInvertedInner(r,s-l,Math.max(i,l)-l,o+l)===!1||i<l&&this.left.forEachInvertedInner(r,Math.min(s,l),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Ee);const Iy=500;class pt{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,l,a,c=[],u=[];return this.items.forEach((d,f)=>{if(!d.step){s||(s=this.remapping(r,f+1),i=s.maps.length),i--,u.push(d);return}if(s){u.push(new yt(d.map));let h=d.step.map(s.slice(i)),p;h&&o.maybeStep(h).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new yt(p,void 0,void 0,c.length+u.length))),i--,p&&s.appendMap(p,i)}else o.maybeStep(d.step);if(d.selection)return l=s?d.selection.map(s.slice(i)):d.selection,a=new pt(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:l}}addTransform(e,t,r,s){let i=[],o=this.eventCount,l=this.items,a=!s&&l.length?l.get(l.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),f=new yt(e.mapping.maps[u],d,t),h;(h=a&&a.merge(f))&&(f=h,u?i.pop():l=l.slice(0,l.length-1)),i.push(f),t&&(o++,t=void 0),s||(a=f)}let c=o-r.depth;return c>Ly&&(l=Dy(l,c),o-=c),new pt(l.append(i),o)}remapping(e,t){let r=new xr;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new pt(this.items.append(e.map(t=>new yt(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(f=>{f.selection&&l--},s);let a=t;this.items.forEach(f=>{let h=i.getMirror(--a);if(h==null)return;o=Math.min(o,h);let p=i.maps[h];if(f.step){let m=e.steps[h].invert(e.docs[h]),C=f.selection&&f.selection.map(i.slice(a+1,h));C&&l++,r.push(new yt(p,m,C))}else r.push(new yt(p))},s);let c=[];for(let f=t;f<o;f++)c.push(new yt(i.maps[f]));let u=this.items.slice(0,s).append(c).append(r),d=new pt(u,l);return d.emptyItemCount()>Iy&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((o,l)=>{if(l>=e)s.push(o),o.selection&&i++;else if(o.step){let a=o.step.map(t.slice(r)),c=a&&a.getMap();if(r--,c&&t.appendMap(c,r),a){let u=o.selection&&o.selection.map(t.slice(r));u&&i++;let d=new yt(c.invert(),a,u),f,h=s.length-1;(f=s.length&&s[h].merge(d))?s[h]=f:s.push(d)}}else o.map&&r--},this.items.length,0),new pt(Ee.from(s.reverse()),i)}}pt.empty=new pt(Ee.empty,0);function Dy(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class yt{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new yt(t.getMap().invert(),t,this.selection)}}}class Vt{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const Ly=20;function Py(n,e,t,r){let s=t.getMeta(vn),i;if(s)return s.historyState;t.getMeta(Hy)&&(n=new Vt(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(vn))return o.getMeta(vn).redo?new Vt(n.done.addTransform(t,void 0,r,as(e)),n.undone,Oc(t.mapping.maps),n.prevTime,n.prevComposition):new Vt(n.done,n.undone.addTransform(t,void 0,r,as(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=t.getMeta("composition"),a=n.prevTime==0||!o&&n.prevComposition!=l&&(n.prevTime<(t.time||0)-r.newGroupDelay||!jy(t,n.prevRanges)),c=o?Qi(n.prevRanges,t.mapping):Oc(t.mapping.maps);return new Vt(n.done.addTransform(t,a?e.selection.getBookmark():void 0,r,as(e)),pt.empty,c,t.time,l??n.prevComposition)}else return(i=t.getMeta("rebased"))?new Vt(n.done.rebased(t,i),n.undone.rebased(t,i),Qi(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Vt(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Qi(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function jy(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function Oc(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,i,o)=>e.push(i,o));return e}function Qi(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function By(n,e,t){let r=as(e),s=vn.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),l=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),a=new Vt(t?l:i.remaining,t?i.remaining:l,null,0,-1);return i.transform.setSelection(o).setMeta(vn,{redo:t,historyState:a})}let Yi=!1,Ic=null;function as(n){let e=n.plugins;if(Ic!=e){Yi=!1,Ic=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Yi=!0;break}}return Yi}const vn=new Ze("history"),Hy=new Ze("closeHistory");function Fy(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new ke({key:vn,state:{init(){return new Vt(pt.empty,pt.empty,null,0,-1)},apply(e,t,r){return Py(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?uf:r=="historyRedo"?df:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function cf(n,e){return(t,r)=>{let s=vn.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=By(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const uf=cf(!1,!0),df=cf(!0,!0),Vy=we.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>uf(n,e),redo:()=>({state:n,dispatch:e})=>df(n,e)}},addProseMirrorPlugins(){return[Fy(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),zy=Ge.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",ae(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{selection:t}=e,{$from:r,$to:s}=t,i=n();return r.parentOffset===0?i.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):gt(t)?i.insertContentAt(s.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:l})=>{var a;if(l){const{$to:c}=o.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection($.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection(B.create(o.doc,c.pos)):o.setSelection($.create(o.doc,c.pos));else{const d=(a=c.parent.type.contentMatch.defaultType)===null||a===void 0?void 0:a.create();d&&(o.insert(u,d),o.setSelection($.create(o.doc,u+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[tf({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),$y=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Ky=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Wy=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Uy=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,_y=it.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[En({find:$y,type:this.type}),En({find:Wy,type:this.type})]},addPasteRules(){return[tn({find:Ky,type:this.type}),tn({find:Uy,type:this.type})]}}),qy=Ge.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ae(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Jy="listItem",Dc="textStyle",Lc=/^(\d+)\.\s$/,Zy=Ge.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",ae(this.options.HTMLAttributes,t),0]:["ol",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Jy,this.editor.getAttributes(Dc)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=_n({find:Lc,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=_n({find:Lc,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Dc)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),Gy=Ge.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Qy=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Yy=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Xy=it.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[En({find:Qy,type:this.type})]},addPasteRules(){return[tn({find:Yy,type:this.type})]}}),e7=Ge.create({name:"text",group:"inline"}),t7=we.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(ay.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(ry.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(uy.configure(this.options.bulletList)),this.options.code!==!1&&n.push(hy.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(gy.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(yy.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(xy.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(Ay.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(Ry.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(Ny.configure(this.options.heading)),this.options.history!==!1&&n.push(Vy.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(zy.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(_y.configure(this.options.italic)),this.options.listItem!==!1&&n.push(qy.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(Zy.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(Gy.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(Xy.configure(this.options.strike)),this.options.text!==!1&&n.push(e7.configure(this.options.text)),n}}),n7=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,r7=Ge.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:n}){return["img",ae(this.options.HTMLAttributes,n)]},addCommands(){return{setImage:n=>({commands:e})=>e.insertContent({type:this.name,attrs:n})}},addInputRules(){return[tf({find:n7,type:this.type,getAttributes:n=>{const[,,e,t,r]=n;return{src:t,alt:e,title:r}}})]}}),s7=/^\s*(\[([( |x])?\])\s$/,i7=Ge.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const e=n.getAttribute("data-checked");return e===""||e==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:e}){return["li",ae(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:e,getPos:t,editor:r})=>{const s=document.createElement("li"),i=document.createElement("label"),o=document.createElement("span"),l=document.createElement("input"),a=document.createElement("div");return i.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",c=>c.preventDefault()),l.addEventListener("change",c=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:u}=c.target;r.isEditable&&typeof t=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const f=t();if(typeof f!="number")return!1;const h=d.doc.nodeAt(f);return d.setNodeMarkup(f,void 0,{...h?.attrs,checked:u}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,u)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,u])=>{s.setAttribute(c,u)}),s.dataset.checked=n.attrs.checked,l.checked=n.attrs.checked,i.append(l,o),s.append(i,a),Object.entries(e).forEach(([c,u])=>{s.setAttribute(c,u)}),{dom:s,contentDOM:a,update:c=>c.type!==this.type?!1:(s.dataset.checked=c.attrs.checked,l.checked=c.attrs.checked,!0)}}},addInputRules(){return[_n({find:s7,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),o7=Ge.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",ae(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),l7=we.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>{const e=n.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:n=>n.textAlign?{style:`text-align: ${n.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:n=>({commands:e})=>this.options.alignments.includes(n)?this.options.types.map(t=>e.updateAttributes(t,{textAlign:n})).every(t=>t):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.map(e=>n.resetAttributes(e,"textAlign")).every(e=>e),toggleTextAlign:n=>({editor:e,commands:t})=>this.options.alignments.includes(n)?e.isActive({textAlign:n})?t.unsetTextAlign():t.setTextAlign(n):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),a7=n=>me({find:/--$/,replace:n??"—"}),c7=n=>me({find:/\.\.\.$/,replace:n??"…"}),u7=n=>me({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:n??"“"}),d7=n=>me({find:/"$/,replace:n??"”"}),f7=n=>me({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:n??"‘"}),h7=n=>me({find:/'$/,replace:n??"’"}),p7=n=>me({find:/<-$/,replace:n??"←"}),m7=n=>me({find:/->$/,replace:n??"→"}),g7=n=>me({find:/\(c\)$/,replace:n??"©"}),y7=n=>me({find:/\(tm\)$/,replace:n??"™"}),C7=n=>me({find:/\(sm\)$/,replace:n??"℠"}),b7=n=>me({find:/\(r\)$/,replace:n??"®"}),x7=n=>me({find:/(?:^|\s)(1\/2)\s$/,replace:n??"½"}),v7=n=>me({find:/\+\/-$/,replace:n??"±"}),k7=n=>me({find:/!=$/,replace:n??"≠"}),w7=n=>me({find:/<<$/,replace:n??"«"}),S7=n=>me({find:/>>$/,replace:n??"»"}),M7=n=>me({find:/\d+\s?([*x])\s?\d+$/,replace:n??"×"}),E7=n=>me({find:/\^2$/,replace:n??"²"}),T7=n=>me({find:/\^3$/,replace:n??"³"}),A7=n=>me({find:/(?:^|\s)(1\/4)\s$/,replace:n??"¼"}),R7=n=>me({find:/(?:^|\s)(3\/4)\s$/,replace:n??"¾"}),N7=we.create({name:"typography",addOptions(){return{closeDoubleQuote:"”",closeSingleQuote:"’",copyright:"©",ellipsis:"…",emDash:"—",laquo:"«",leftArrow:"←",multiplication:"×",notEqual:"≠",oneHalf:"½",oneQuarter:"¼",openDoubleQuote:"“",openSingleQuote:"‘",plusMinus:"±",raquo:"»",registeredTrademark:"®",rightArrow:"→",servicemark:"℠",superscriptThree:"³",superscriptTwo:"²",threeQuarters:"¾",trademark:"™"}},addInputRules(){const n=[];return this.options.emDash!==!1&&n.push(a7(this.options.emDash)),this.options.ellipsis!==!1&&n.push(c7(this.options.ellipsis)),this.options.openDoubleQuote!==!1&&n.push(u7(this.options.openDoubleQuote)),this.options.closeDoubleQuote!==!1&&n.push(d7(this.options.closeDoubleQuote)),this.options.openSingleQuote!==!1&&n.push(f7(this.options.openSingleQuote)),this.options.closeSingleQuote!==!1&&n.push(h7(this.options.closeSingleQuote)),this.options.leftArrow!==!1&&n.push(p7(this.options.leftArrow)),this.options.rightArrow!==!1&&n.push(m7(this.options.rightArrow)),this.options.copyright!==!1&&n.push(g7(this.options.copyright)),this.options.trademark!==!1&&n.push(y7(this.options.trademark)),this.options.servicemark!==!1&&n.push(C7(this.options.servicemark)),this.options.registeredTrademark!==!1&&n.push(b7(this.options.registeredTrademark)),this.options.oneHalf!==!1&&n.push(x7(this.options.oneHalf)),this.options.plusMinus!==!1&&n.push(v7(this.options.plusMinus)),this.options.notEqual!==!1&&n.push(k7(this.options.notEqual)),this.options.laquo!==!1&&n.push(w7(this.options.laquo)),this.options.raquo!==!1&&n.push(S7(this.options.raquo)),this.options.multiplication!==!1&&n.push(M7(this.options.multiplication)),this.options.superscriptTwo!==!1&&n.push(E7(this.options.superscriptTwo)),this.options.superscriptThree!==!1&&n.push(T7(this.options.superscriptThree)),this.options.oneQuarter!==!1&&n.push(A7(this.options.oneQuarter)),this.options.threeQuarters!==!1&&n.push(R7(this.options.threeQuarters)),n}}),O7=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,I7=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,D7=it.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[En({find:O7,type:this.type})]},addPasteRules(){return[tn({find:I7,type:this.type})]}}),L7=it.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(n){return n!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sub",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setSubscript:()=>({commands:n})=>n.setMark(this.name),toggleSubscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSubscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),P7=it.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(n){return n!=="super"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sup",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setSuperscript:()=>({commands:n})=>n.setMark(this.name),toggleSuperscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSuperscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),j7=it.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",ae(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),B7="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",H7="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",qn=(n,e)=>{for(const t in e)n[t]=e[t];return n},Fo="numeric",Vo="ascii",zo="alpha",ur="asciinumeric",ir="alphanumeric",$o="domain",ff="emoji",F7="scheme",V7="slashscheme",Xi="whitespace";function z7(n,e){return n in e||(e[n]=[]),e[n]}function gn(n,e,t){e[Fo]&&(e[ur]=!0,e[ir]=!0),e[Vo]&&(e[ur]=!0,e[zo]=!0),e[ur]&&(e[ir]=!0),e[zo]&&(e[ir]=!0),e[ir]&&(e[$o]=!0),e[ff]&&(e[$o]=!0);for(const r in e){const s=z7(r,t);s.indexOf(n)<0&&s.push(n)}}function $7(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function Qe(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}Qe.groups={};Qe.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(n))return i}return e.jd},has(n,e=!1){return e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let s=0;s<n.length;s++)this.tt(n[s],e,t,r)},tr(n,e,t,r){r=r||Qe.groups;let s;return e&&e.j?s=e:(s=new Qe(e),t&&r&&gn(e,t,r)),this.jr.push([n,s]),s},ts(n,e,t,r){let s=this;const i=n.length;if(!i)return s;for(let o=0;o<i-1;o++)s=s.tt(n[o]);return s.tt(n[i-1],e,t,r)},tt(n,e,t,r){r=r||Qe.groups;const s=this;if(e&&e.j)return s.j[n]=e,e;const i=e;let o,l=s.go(n);if(l?(o=new Qe,qn(o.j,l.j),o.jr.push.apply(o.jr,l.jr),o.jd=l.jd,o.t=l.t):o=new Qe,i){if(r)if(o.t&&typeof o.t=="string"){const a=qn($7(o.t,r),t);gn(i,a,r)}else t&&gn(i,t,r);o.t=i}return s.j[n]=o,o}};const U=(n,e,t,r,s)=>n.ta(e,t,r,s),he=(n,e,t,r,s)=>n.tr(e,t,r,s),Pc=(n,e,t,r,s)=>n.ts(e,t,r,s),E=(n,e,t,r,s)=>n.tt(e,t,r,s),Rt="WORD",Ko="UWORD",hf="ASCIINUMERICAL",pf="ALPHANUMERICAL",Tr="LOCALHOST",Wo="TLD",Uo="UTLD",cs="SCHEME",Pn="SLASH_SCHEME",Ll="NUM",_o="WS",Pl="NL",dr="OPENBRACE",fr="CLOSEBRACE",Es="OPENBRACKET",Ts="CLOSEBRACKET",As="OPENPAREN",Rs="CLOSEPAREN",Ns="OPENANGLEBRACKET",Os="CLOSEANGLEBRACKET",Is="FULLWIDTHLEFTPAREN",Ds="FULLWIDTHRIGHTPAREN",Ls="LEFTCORNERBRACKET",Ps="RIGHTCORNERBRACKET",js="LEFTWHITECORNERBRACKET",Bs="RIGHTWHITECORNERBRACKET",Hs="FULLWIDTHLESSTHAN",Fs="FULLWIDTHGREATERTHAN",Vs="AMPERSAND",zs="APOSTROPHE",$s="ASTERISK",zt="AT",Ks="BACKSLASH",Ws="BACKTICK",Us="CARET",Ut="COLON",jl="COMMA",_s="DOLLAR",Ct="DOT",qs="EQUALS",Bl="EXCLAMATION",at="HYPHEN",hr="PERCENT",Js="PIPE",Zs="PLUS",Gs="POUND",pr="QUERY",Hl="QUOTE",mf="FULLWIDTHMIDDLEDOT",Fl="SEMI",bt="SLASH",mr="TILDE",Qs="UNDERSCORE",gf="EMOJI",Ys="SYM";var yf=Object.freeze({__proto__:null,ALPHANUMERICAL:pf,AMPERSAND:Vs,APOSTROPHE:zs,ASCIINUMERICAL:hf,ASTERISK:$s,AT:zt,BACKSLASH:Ks,BACKTICK:Ws,CARET:Us,CLOSEANGLEBRACKET:Os,CLOSEBRACE:fr,CLOSEBRACKET:Ts,CLOSEPAREN:Rs,COLON:Ut,COMMA:jl,DOLLAR:_s,DOT:Ct,EMOJI:gf,EQUALS:qs,EXCLAMATION:Bl,FULLWIDTHGREATERTHAN:Fs,FULLWIDTHLEFTPAREN:Is,FULLWIDTHLESSTHAN:Hs,FULLWIDTHMIDDLEDOT:mf,FULLWIDTHRIGHTPAREN:Ds,HYPHEN:at,LEFTCORNERBRACKET:Ls,LEFTWHITECORNERBRACKET:js,LOCALHOST:Tr,NL:Pl,NUM:Ll,OPENANGLEBRACKET:Ns,OPENBRACE:dr,OPENBRACKET:Es,OPENPAREN:As,PERCENT:hr,PIPE:Js,PLUS:Zs,POUND:Gs,QUERY:pr,QUOTE:Hl,RIGHTCORNERBRACKET:Ps,RIGHTWHITECORNERBRACKET:Bs,SCHEME:cs,SEMI:Fl,SLASH:bt,SLASH_SCHEME:Pn,SYM:Ys,TILDE:mr,TLD:Wo,UNDERSCORE:Qs,UTLD:Uo,UWORD:Ko,WORD:Rt,WS:_o});const Tt=/[a-z]/,tr=/\p{L}/u,eo=/\p{Emoji}/u,At=/\d/,to=/\s/,jc="\r",no=`
`,K7="️",W7="‍",ro="￼";let Gr=null,Qr=null;function U7(n=[]){const e={};Qe.groups=e;const t=new Qe;Gr==null&&(Gr=Bc(B7)),Qr==null&&(Qr=Bc(H7)),E(t,"'",zs),E(t,"{",dr),E(t,"}",fr),E(t,"[",Es),E(t,"]",Ts),E(t,"(",As),E(t,")",Rs),E(t,"<",Ns),E(t,">",Os),E(t,"（",Is),E(t,"）",Ds),E(t,"「",Ls),E(t,"」",Ps),E(t,"『",js),E(t,"』",Bs),E(t,"＜",Hs),E(t,"＞",Fs),E(t,"&",Vs),E(t,"*",$s),E(t,"@",zt),E(t,"`",Ws),E(t,"^",Us),E(t,":",Ut),E(t,",",jl),E(t,"$",_s),E(t,".",Ct),E(t,"=",qs),E(t,"!",Bl),E(t,"-",at),E(t,"%",hr),E(t,"|",Js),E(t,"+",Zs),E(t,"#",Gs),E(t,"?",pr),E(t,'"',Hl),E(t,"/",bt),E(t,";",Fl),E(t,"~",mr),E(t,"_",Qs),E(t,"\\",Ks),E(t,"・",mf);const r=he(t,At,Ll,{[Fo]:!0});he(r,At,r);const s=he(r,Tt,hf,{[ur]:!0}),i=he(r,tr,pf,{[ir]:!0}),o=he(t,Tt,Rt,{[Vo]:!0});he(o,At,s),he(o,Tt,o),he(s,At,s),he(s,Tt,s);const l=he(t,tr,Ko,{[zo]:!0});he(l,Tt),he(l,At,i),he(l,tr,l),he(i,At,i),he(i,Tt),he(i,tr,i);const a=E(t,no,Pl,{[Xi]:!0}),c=E(t,jc,_o,{[Xi]:!0}),u=he(t,to,_o,{[Xi]:!0});E(t,ro,u),E(c,no,a),E(c,ro,u),he(c,to,u),E(u,jc),E(u,no),he(u,to,u),E(u,ro,u);const d=he(t,eo,gf,{[ff]:!0});E(d,"#"),he(d,eo,d),E(d,K7,d);const f=E(d,W7);E(f,"#"),he(f,eo,d);const h=[[Tt,o],[At,s]],p=[[Tt,null],[tr,l],[At,i]];for(let m=0;m<Gr.length;m++)jt(t,Gr[m],Wo,Rt,h);for(let m=0;m<Qr.length;m++)jt(t,Qr[m],Uo,Ko,p);gn(Wo,{tld:!0,ascii:!0},e),gn(Uo,{utld:!0,alpha:!0},e),jt(t,"file",cs,Rt,h),jt(t,"mailto",cs,Rt,h),jt(t,"http",Pn,Rt,h),jt(t,"https",Pn,Rt,h),jt(t,"ftp",Pn,Rt,h),jt(t,"ftps",Pn,Rt,h),gn(cs,{scheme:!0,ascii:!0},e),gn(Pn,{slashscheme:!0,ascii:!0},e),n=n.sort((m,C)=>m[0]>C[0]?1:-1);for(let m=0;m<n.length;m++){const C=n[m][0],v=n[m][1]?{[F7]:!0}:{[V7]:!0};C.indexOf("-")>=0?v[$o]=!0:Tt.test(C)?At.test(C)?v[ur]=!0:v[Vo]=!0:v[Fo]=!0,Pc(t,C,C,v)}return Pc(t,"localhost",Tr,{ascii:!0}),t.jd=new Qe(Ys),{start:t,tokens:qn({groups:e},yf)}}function Cf(n,e){const t=_7(e.replace(/[A-Z]/g,l=>l.toLowerCase())),r=t.length,s=[];let i=0,o=0;for(;o<r;){let l=n,a=null,c=0,u=null,d=-1,f=-1;for(;o<r&&(a=l.go(t[o]));)l=a,l.accepts()?(d=0,f=0,u=l):d>=0&&(d+=t[o].length,f++),c+=t[o].length,i+=t[o].length,o++;i-=d,o-=f,c-=d,s.push({t:u.t,v:e.slice(i-c,i),s:i-c,e:i})}return s}function _7(n){const e=[],t=n.length;let r=0;for(;r<t;){let s=n.charCodeAt(r),i,o=s<55296||s>56319||r+1===t||(i=n.charCodeAt(r+1))<56320||i>57343?n[r]:n.slice(r,r+2);e.push(o),r+=o.length}return e}function jt(n,e,t,r,s){let i;const o=e.length;for(let l=0;l<o-1;l++){const a=e[l];n.j[a]?i=n.j[a]:(i=new Qe(r),i.jr=s.slice(),n.j[a]=i),n=i}return i=new Qe(t),i.jr=s.slice(),n.j[e[o-1]]=i,i}function Bc(n){const e=[],t=[];let r=0,s="0123456789";for(;r<n.length;){let i=0;for(;s.indexOf(n[r+i])>=0;)i++;if(i>0){e.push(t.join(""));for(let o=parseInt(n.substring(r,r+i),10);o>0;o--)t.pop();r+=i}else t.push(n[r]),r++}return e}const Ar={defaultProtocol:"http",events:null,format:Hc,formatHref:Hc,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Vl(n,e=null){let t=qn({},Ar);n&&(t=qn(t,n instanceof Vl?n.o:n));const r=t.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=s}Vl.prototype={o:Ar,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let s=this.o[n];return s&&(typeof s=="object"?(s=t.t in s?s[t.t]:Ar[n],typeof s=="function"&&r&&(s=s(e,t))):typeof s=="function"&&r&&(s=s(e,t.t,t)),s)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function Hc(n){return n}function bf(n,e){this.t="token",this.v=n,this.tk=e}bf.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"…":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=Ar.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),s=n.get("tagName",t,e),i=this.toFormattedString(n),o={},l=n.get("className",t,e),a=n.get("target",t,e),c=n.get("rel",t,e),u=n.getObj("attributes",t,e),d=n.getObj("events",t,e);return o.href=r,l&&(o.class=l),a&&(o.target=a),c&&(o.rel=c),u&&qn(o,u),{tagName:s,attributes:o,content:i,eventListeners:d}}};function Ci(n,e){class t extends bf{constructor(s,i){super(s,i),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const Fc=Ci("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Vc=Ci("text"),q7=Ci("nl"),Yr=Ci("url",{isLink:!0,toHref(n=Ar.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Tr&&n[1].t===Ut}}),lt=n=>new Qe(n);function J7({groups:n}){const e=n.domain.concat([Vs,$s,zt,Ks,Ws,Us,_s,qs,at,Ll,hr,Js,Zs,Gs,bt,Ys,mr,Qs]),t=[zs,Ut,jl,Ct,Bl,hr,pr,Hl,Fl,Ns,Os,dr,fr,Ts,Es,As,Rs,Is,Ds,Ls,Ps,js,Bs,Hs,Fs],r=[Vs,zs,$s,Ks,Ws,Us,_s,qs,at,dr,fr,hr,Js,Zs,Gs,pr,bt,Ys,mr,Qs],s=lt(),i=E(s,mr);U(i,r,i),U(i,n.domain,i);const o=lt(),l=lt(),a=lt();U(s,n.domain,o),U(s,n.scheme,l),U(s,n.slashscheme,a),U(o,r,i),U(o,n.domain,o);const c=E(o,zt);E(i,zt,c),E(l,zt,c),E(a,zt,c);const u=E(i,Ct);U(u,r,i),U(u,n.domain,i);const d=lt();U(c,n.domain,d),U(d,n.domain,d);const f=E(d,Ct);U(f,n.domain,d);const h=lt(Fc);U(f,n.tld,h),U(f,n.utld,h),E(c,Tr,h);const p=E(d,at);E(p,at,p),U(p,n.domain,d),U(h,n.domain,d),E(h,Ct,f),E(h,at,p);const m=E(h,Ut);U(m,n.numeric,Fc);const C=E(o,at),b=E(o,Ct);E(C,at,C),U(C,n.domain,o),U(b,r,i),U(b,n.domain,o);const v=lt(Yr);U(b,n.tld,v),U(b,n.utld,v),U(v,n.domain,o),U(v,r,i),E(v,Ct,b),E(v,at,C),E(v,zt,c);const x=E(v,Ut),w=lt(Yr);U(x,n.numeric,w);const M=lt(Yr),T=lt();U(M,e,M),U(M,t,T),U(T,e,M),U(T,t,T),E(v,bt,M),E(w,bt,M);const P=E(l,Ut),R=E(a,Ut),z=E(R,bt),j=E(z,bt);U(l,n.domain,o),E(l,Ct,b),E(l,at,C),U(a,n.domain,o),E(a,Ct,b),E(a,at,C),U(P,n.domain,M),E(P,bt,M),E(P,pr,M),U(j,n.domain,M),U(j,e,M),E(j,bt,M);const Y=[[dr,fr],[Es,Ts],[As,Rs],[Ns,Os],[Is,Ds],[Ls,Ps],[js,Bs],[Hs,Fs]];for(let ee=0;ee<Y.length;ee++){const[se,H]=Y[ee],S=E(M,se);E(T,se,S),E(S,H,M);const G=lt(Yr);U(S,e,G);const D=lt();U(S,t),U(G,e,G),U(G,t,D),U(D,e,G),U(D,t,D),E(G,H,M),E(D,H,M)}return E(s,Tr,v),E(s,Pl,q7),{start:s,tokens:yf}}function Z7(n,e,t){let r=t.length,s=0,i=[],o=[];for(;s<r;){let l=n,a=null,c=null,u=0,d=null,f=-1;for(;s<r&&!(a=l.go(t[s].t));)o.push(t[s++]);for(;s<r&&(c=a||l.go(t[s].t));)a=null,l=c,l.accepts()?(f=0,d=l):f>=0&&f++,s++,u++;if(f<0)s-=u,s<r&&(o.push(t[s]),s++);else{o.length>0&&(i.push(so(Vc,e,o)),o=[]),s-=f,u-=f;const h=d.t,p=t.slice(s-u,s);i.push(so(h,e,p))}}return o.length>0&&i.push(so(Vc,e,o)),i}function so(n,e,t){const r=t[0].s,s=t[t.length-1].e,i=e.slice(r,s);return new n(i,t)}const G7=typeof console<"u"&&console&&console.warn||(()=>{}),Q7="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",le={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Y7(){return Qe.groups={},le.scanner=null,le.parser=null,le.tokenQueue=[],le.pluginQueue=[],le.customSchemes=[],le.initialized=!1,le}function zc(n,e=!1){if(le.initialized&&G7(`linkifyjs: already initialized - will not register custom scheme "${n}" ${Q7}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);le.customSchemes.push([n,e])}function X7(){le.scanner=U7(le.customSchemes);for(let n=0;n<le.tokenQueue.length;n++)le.tokenQueue[n][1]({scanner:le.scanner});le.parser=J7(le.scanner.tokens);for(let n=0;n<le.pluginQueue.length;n++)le.pluginQueue[n][1]({scanner:le.scanner,parser:le.parser});return le.initialized=!0,le}function zl(n){return le.initialized||X7(),Z7(le.parser.start,n,Cf(le.scanner.start,n))}zl.scan=Cf;function xf(n,e=null,t=null){if(e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new Vl(t),s=zl(n),i=[];for(let o=0;o<s.length;o++){const l=s[o];l.isLink&&(!e||l.t===e)&&r.check(l)&&i.push(l.toFormattedObject(r))}return i}function eC(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function tC(n){return new ke({key:new Ze("autolink"),appendTransaction:(e,t,r)=>{const s=e.some(c=>c.docChanged)&&!t.doc.eq(r.doc),i=e.some(c=>c.getMeta("preventAutolink"));if(!s||i)return;const{tr:o}=r,l=m0(t.doc,[...e]);if(w0(l).forEach(({newRange:c})=>{const u=y0(r.doc,c,h=>h.isTextblock);let d,f;if(u.length>1?(d=u[0],f=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&r.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=u[0],f=r.doc.textBetween(d.pos,c.to,void 0," ")),d&&f){const h=f.split(" ").filter(b=>b!=="");if(h.length<=0)return!1;const p=h[h.length-1],m=d.pos+f.lastIndexOf(p);if(!p)return!1;const C=zl(p).map(b=>b.toObject(n.defaultProtocol));if(!eC(C))return!1;C.filter(b=>b.isLink).map(b=>({...b,from:m+b.start+1,to:m+b.end+1})).filter(b=>r.schema.marks.code?!r.doc.rangeHasMark(b.from,b.to,r.schema.marks.code):!0).filter(b=>n.validate(b.value)).filter(b=>n.shouldAutoLink(b.value)).forEach(b=>{Al(b.from,b.to,r.doc).some(v=>v.mark.type===n.type)||o.addMark(b.from,b.to,n.type.create({href:b.href}))})}}),!!o.steps.length)return o}})}function nC(n){return new ke({key:new Ze("handleClickLink"),props:{handleClick:(e,t,r)=>{var s,i;if(r.button!==0||!e.editable)return!1;let o=r.target;const l=[];for(;o.nodeName!=="DIV";)l.push(o),o=o.parentNode;if(!l.find(f=>f.nodeName==="A"))return!1;const a=ef(e.state,n.type.name),c=r.target,u=(s=c?.href)!==null&&s!==void 0?s:a.href,d=(i=c?.target)!==null&&i!==void 0?i:a.target;return c&&u?(window.open(u,d),!0):!1}}})}function rC(n){return new ke({key:new Ze("handlePasteLink"),props:{handlePaste:(e,t,r)=>{const{state:s}=e,{selection:i}=s,{empty:o}=i;if(o)return!1;let l="";r.content.forEach(c=>{l+=c.textContent});const a=xf(l,{defaultProtocol:n.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!a?!1:n.editor.commands.setMark(n.type,{href:a.href})}}})}const sC=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function an(n,e){const t=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&t.push(s)}),!n||n.replace(sC,"").match(new RegExp(`^(?:(?:${t.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const iC=it.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){zc(n);return}zc(n.scheme,n.optionalSlashes)})},onDestroy(){Y7()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,e)=>!!an(n,e.protocols),validate:n=>!!n,shouldAutoLink:n=>!!n}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const e=n.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!an(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:e=>!!an(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",ae(this.options.HTMLAttributes,n),0]:["a",ae(this.options.HTMLAttributes,{...n,href:""}),0]},addCommands(){return{setLink:n=>({chain:e})=>{const{href:t}=n;return this.options.isAllowedUri(t,{defaultValidate:r=>!!an(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:e})=>{const{href:t}=n;return this.options.isAllowedUri(t,{defaultValidate:r=>!!an(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[tn({find:n=>{const e=[];if(n){const{protocols:t,defaultProtocol:r}=this.options,s=xf(n).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:o=>!!an(o,t),protocols:t,defaultProtocol:r}));s.length&&s.forEach(i=>e.push({text:i.value,data:{href:i.href},index:i.start}))}return e},type:this.type,getAttributes:n=>{var e;return{href:(e=n.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:e,defaultProtocol:t}=this.options;return this.options.autolink&&n.push(tC({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!an(s,e),protocols:e,defaultProtocol:t}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&n.push(nC({type:this.type})),this.options.linkOnPaste&&n.push(rC({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),n}}),oC=iC.extend({inclusive:!1,parseHTML(){return[{tag:'a[href]:not([data-type="button"]):not([href *= "javascript:" i])'}]},addProseMirrorPlugins(){const{editor:n}=this;return[...this.parent?.()||[],new ke({props:{handleKeyDown:(e,t)=>{const{selection:r}=n.state;return t.key==="Escape"&&r.empty!==!0&&n.commands.focus(r.to,{scrollIntoView:!1}),!1},handleClick(e,t){const{schema:r,doc:s,tr:i}=e.state;let o;if(r.marks.link&&(o=mi(s.resolve(t),r.marks.link)),!o)return;const{from:l,to:a}=o,c=Math.min(l,a),u=Math.max(l,a);if(t<c||t>u)return;const d=s.resolve(c),f=s.resolve(u),h=i.setSelection(new $(d,f));e.dispatch(h)}}})]}}),lC=we.create({name:"selection",addProseMirrorPlugins(){const{editor:n}=this;return[new ke({key:new Ze("selection"),props:{decorations(e){return e.selection.empty||n.isFocused===!0||!n.isEditable||gt(e.selection)?null:xe.create(e.doc,[rt.inline(e.selection.from,e.selection.to,{class:"selection"})])}}})]}});function $c({types:n,node:e}){return e?Array.isArray(n)?n.includes(e.type):e.type===n:!1}const aC=we.create({name:"trailingNode",addOptions(){return{node:"paragraph",notAfter:["paragraph"]}},addProseMirrorPlugins(){const n=new Ze(this.name),e=Object.entries(this.editor.schema.nodes).map(([,t])=>t).filter(t=>this.options.notAfter.includes(t.name));return[new ke({key:n,appendTransaction:(t,r,s)=>{const{doc:i,tr:o,schema:l}=s,a=n.getState(s),c=i.content.size,u=l.nodes[this.options.node];return a&&u?o.insert(c,u.create()):null},state:{init:(t,r)=>{const s=r.tr.doc.lastChild;return!$c({node:s,types:e})},apply:(t,r)=>{if(!t.docChanged)return r;const s=t.doc.lastChild;return!$c({node:s,types:e})}}})]}});/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var cC=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],Xs=cC.join(","),vf=typeof Element>"u",Jn=vf?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,ei=!vf&&Element.prototype.getRootNode?function(n){var e;return n==null||(e=n.getRootNode)===null||e===void 0?void 0:e.call(n)}:function(n){return n?.ownerDocument},ti=function n(e,t){var r;t===void 0&&(t=!0);var s=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"inert"),i=s===""||s==="true",o=i||t&&e&&n(e.parentNode);return o},uC=function(e){var t,r=e==null||(t=e.getAttribute)===null||t===void 0?void 0:t.call(e,"contenteditable");return r===""||r==="true"},kf=function(e,t,r){if(ti(e))return[];var s=Array.prototype.slice.apply(e.querySelectorAll(Xs));return t&&Jn.call(e,Xs)&&s.unshift(e),s=s.filter(r),s},wf=function n(e,t,r){for(var s=[],i=Array.from(e);i.length;){var o=i.shift();if(!ti(o,!1))if(o.tagName==="SLOT"){var l=o.assignedElements(),a=l.length?l:o.children,c=n(a,!0,r);r.flatten?s.push.apply(s,c):s.push({scopeParent:o,candidates:c})}else{var u=Jn.call(o,Xs);u&&r.filter(o)&&(t||!e.includes(o))&&s.push(o);var d=o.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(o),f=!ti(d,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(o));if(d&&f){var h=n(d===!0?o.children:d.children,!0,r);r.flatten?s.push.apply(s,h):s.push({scopeParent:o,candidates:h})}else i.unshift.apply(i,o.children)}}return s},Sf=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},Mf=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||uC(e))&&!Sf(e)?0:e.tabIndex},dC=function(e,t){var r=Mf(e);return r<0&&t&&!Sf(e)?0:r},fC=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},Ef=function(e){return e.tagName==="INPUT"},hC=function(e){return Ef(e)&&e.type==="hidden"},pC=function(e){var t=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(r){return r.tagName==="SUMMARY"});return t},mC=function(e,t){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===t)return e[r]},gC=function(e){if(!e.name)return!0;var t=e.form||ei(e),r=function(l){return t.querySelectorAll('input[type="radio"][name="'+l+'"]')},s;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")s=r(window.CSS.escape(e.name));else try{s=r(e.name)}catch(o){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",o.message),!1}var i=mC(s,e.form);return!i||i===e},yC=function(e){return Ef(e)&&e.type==="radio"},CC=function(e){return yC(e)&&!gC(e)},bC=function(e){var t,r=e&&ei(e),s=(t=r)===null||t===void 0?void 0:t.host,i=!1;if(r&&r!==e){var o,l,a;for(i=!!((o=s)!==null&&o!==void 0&&(l=o.ownerDocument)!==null&&l!==void 0&&l.contains(s)||e!=null&&(a=e.ownerDocument)!==null&&a!==void 0&&a.contains(e));!i&&s;){var c,u,d;r=ei(s),s=(c=r)===null||c===void 0?void 0:c.host,i=!!((u=s)!==null&&u!==void 0&&(d=u.ownerDocument)!==null&&d!==void 0&&d.contains(s))}}return i},Kc=function(e){var t=e.getBoundingClientRect(),r=t.width,s=t.height;return r===0&&s===0},xC=function(e,t){var r=t.displayCheck,s=t.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var i=Jn.call(e,"details>summary:first-of-type"),o=i?e.parentElement:e;if(Jn.call(o,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="legacy-full"){if(typeof s=="function"){for(var l=e;e;){var a=e.parentElement,c=ei(e);if(a&&!a.shadowRoot&&s(a)===!0)return Kc(e);e.assignedSlot?e=e.assignedSlot:!a&&c!==e.ownerDocument?e=c.host:e=a}e=l}if(bC(e))return!e.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return Kc(e);return!1},vC=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if(t.tagName==="FIELDSET"&&t.disabled){for(var r=0;r<t.children.length;r++){var s=t.children.item(r);if(s.tagName==="LEGEND")return Jn.call(t,"fieldset[disabled] *")?!0:!s.contains(e)}return!0}t=t.parentElement}return!1},qo=function(e,t){return!(t.disabled||ti(t)||hC(t)||xC(t,e)||pC(t)||vC(t))},Jo=function(e,t){return!(CC(t)||Mf(t)<0||!qo(e,t))},kC=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},wC=function n(e){var t=[],r=[];return e.forEach(function(s,i){var o=!!s.scopeParent,l=o?s.scopeParent:s,a=dC(l,o),c=o?n(s.candidates):l;a===0?o?t.push.apply(t,c):t.push(l):r.push({documentOrder:i,tabIndex:a,item:s,isScope:o,content:c})}),r.sort(fC).reduce(function(s,i){return i.isScope?s.push.apply(s,i.content):s.push(i.content),s},[]).concat(t)},bi=function(e,t){t=t||{};var r;return t.getShadowRoot?r=wf([e],t.includeContainer,{filter:Jo.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:kC}):r=kf(e,t.includeContainer,Jo.bind(null,t)),wC(r)},SC=function(e,t){t=t||{};var r;return t.getShadowRoot?r=wf([e],t.includeContainer,{filter:qo.bind(null,t),flatten:!0,getShadowRoot:t.getShadowRoot}):r=kf(e,t.includeContainer,qo.bind(null,t)),r},Tf=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Jn.call(e,Xs)===!1?!1:Jo(t,e)};function Af(){const n=navigator.userAgentData;return n!=null&&n.platform?n.platform:navigator.platform}function Rf(){const n=navigator.userAgentData;return n&&Array.isArray(n.brands)?n.brands.map(e=>{let{brand:t,version:r}=e;return t+"/"+r}).join(" "):navigator.userAgent}function Nf(){return/apple/i.test(navigator.vendor)}function Zo(){const n=/android/i;return n.test(Af())||n.test(Rf())}function MC(){return Af().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints}function Of(){return Rf().includes("jsdom/")}const Wc="data-floating-ui-focusable",EC="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])",io="ArrowLeft",oo="ArrowRight",TC="ArrowUp",AC="ArrowDown";function xt(n){let e=n.activeElement;for(;((t=e)==null||(t=t.shadowRoot)==null?void 0:t.activeElement)!=null;){var t;e=e.shadowRoot.activeElement}return e}function Oe(n,e){if(!n||!e)return!1;const t=e.getRootNode==null?void 0:e.getRootNode();if(n.contains(e))return!0;if(t&&Jh(t)){let r=e;for(;r;){if(n===r)return!0;r=r.parentNode||r.host}}return!1}function Ot(n){return"composedPath"in n?n.composedPath()[0]:n.target}function lo(n,e){if(e==null)return!1;if("composedPath"in n)return n.composedPath().includes(e);const t=n;return t.target!=null&&e.contains(t.target)}function RC(n){return n.matches("html,body")}function je(n){return n?.ownerDocument||document}function $l(n){return ht(n)&&n.matches(EC)}function Go(n){return n?n.getAttribute("role")==="combobox"&&$l(n):!1}function NC(n){if(!n||Of())return!0;try{return n.matches(":focus-visible")}catch{return!0}}function ni(n){return n?n.hasAttribute(Wc)?n:n.querySelector("["+Wc+"]")||n:null}function Vn(n,e){let t=n.filter(s=>{var i;return s.parentId===e&&((i=s.context)==null?void 0:i.open)}),r=t;for(;r.length;)r=n.filter(s=>{var i;return(i=r)==null?void 0:i.some(o=>{var l;return s.parentId===o.id&&((l=s.context)==null?void 0:l.open)})}),t=t.concat(r);return t}function OC(n,e){let t,r=-1;function s(i,o){o>r&&(t=i,r=o),Vn(n,i).forEach(a=>{s(a.id,o+1)})}return s(e,0),n.find(i=>i.id===t)}function Uc(n,e){var t;let r=[],s=(t=n.find(i=>i.id===e))==null?void 0:t.parentId;for(;s;){const i=n.find(o=>o.id===s);s=i?.parentId,i&&(r=r.concat(i))}return r}function Ie(n){n.preventDefault(),n.stopPropagation()}function IC(n){return"nativeEvent"in n}function If(n){return n.mozInputSource===0&&n.isTrusted?!0:Zo()&&n.pointerType?n.type==="click"&&n.buttons===1:n.detail===0&&!n.pointerType}function Df(n){return Of()?!1:!Zo()&&n.width===0&&n.height===0||Zo()&&n.width===1&&n.height===1&&n.pressure===0&&n.detail===0&&n.pointerType==="mouse"||n.width<1&&n.height<1&&n.pressure===0&&n.detail===0&&n.pointerType==="touch"}function Rr(n,e){const t=["mouse","pen"];return e||t.push("",void 0),t.includes(n)}var DC=typeof document<"u",LC=function(){},oe=DC?y.useLayoutEffect:LC;const PC={...hu};function Ye(n){const e=y.useRef(n);return oe(()=>{e.current=n}),e}const jC=PC.useInsertionEffect,BC=jC||(n=>n());function ye(n){const e=y.useRef(()=>{});return BC(()=>{e.current=n}),y.useCallback(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}function Xr(n,e,t){return Math.floor(n/e)!==t}function gr(n,e){return e<0||e>=n.current.length}function ao(n,e){return He(n,{disabledIndices:e})}function _c(n,e){return He(n,{decrement:!0,startingIndex:n.current.length,disabledIndices:e})}function He(n,e){let{startingIndex:t=-1,decrement:r=!1,disabledIndices:s,amount:i=1}=e===void 0?{}:e,o=t;do o+=r?-i:i;while(o>=0&&o<=n.current.length-1&&us(n,o,s));return o}function HC(n,e){let{event:t,orientation:r,loop:s,rtl:i,cols:o,disabledIndices:l,minIndex:a,maxIndex:c,prevIndex:u,stopEvent:d=!1}=e,f=u;if(t.key===TC){if(d&&Ie(t),u===-1)f=c;else if(f=He(n,{startingIndex:f,amount:o,decrement:!0,disabledIndices:l}),s&&(u-o<a||f<0)){const h=u%o,p=c%o,m=c-(p-h);p===h?f=c:f=p>h?m:m-o}gr(n,f)&&(f=u)}if(t.key===AC&&(d&&Ie(t),u===-1?f=a:(f=He(n,{startingIndex:u,amount:o,disabledIndices:l}),s&&u+o>c&&(f=He(n,{startingIndex:u%o-o,amount:o,disabledIndices:l}))),gr(n,f)&&(f=u)),r==="both"){const h=ma(u/o);t.key===(i?io:oo)&&(d&&Ie(t),u%o!==o-1?(f=He(n,{startingIndex:u,disabledIndices:l}),s&&Xr(f,o,h)&&(f=He(n,{startingIndex:u-u%o-1,disabledIndices:l}))):s&&(f=He(n,{startingIndex:u-u%o-1,disabledIndices:l})),Xr(f,o,h)&&(f=u)),t.key===(i?oo:io)&&(d&&Ie(t),u%o!==0?(f=He(n,{startingIndex:u,decrement:!0,disabledIndices:l}),s&&Xr(f,o,h)&&(f=He(n,{startingIndex:u+(o-u%o),decrement:!0,disabledIndices:l}))):s&&(f=He(n,{startingIndex:u+(o-u%o),decrement:!0,disabledIndices:l})),Xr(f,o,h)&&(f=u));const p=ma(c/o)===h;gr(n,f)&&(s&&p?f=t.key===(i?oo:io)?c:He(n,{startingIndex:u-u%o-1,disabledIndices:l}):f=u)}return f}function FC(n,e,t){const r=[];let s=0;return n.forEach((i,o)=>{let{width:l,height:a}=i,c=!1;for(t&&(s=0);!c;){const u=[];for(let d=0;d<l;d++)for(let f=0;f<a;f++)u.push(s+d+f*e);s%e+l<=e&&u.every(d=>r[d]==null)?(u.forEach(d=>{r[d]=o}),c=!0):s++}}),[...r]}function VC(n,e,t,r,s){if(n===-1)return-1;const i=t.indexOf(n),o=e[n];switch(s){case"tl":return i;case"tr":return o?i+o.width-1:i;case"bl":return o?i+(o.height-1)*r:i;case"br":return t.lastIndexOf(n)}}function zC(n,e){return e.flatMap((t,r)=>n.includes(t)?[r]:[])}function us(n,e,t){if(typeof t=="function")return t(e);if(t)return t.includes(e);const r=n.current[e];return r==null||r.hasAttribute("disabled")||r.getAttribute("aria-disabled")==="true"}const Lr=()=>({getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function Lf(n,e){const t=bi(n,Lr()),r=t.length;if(r===0)return;const s=xt(je(n)),i=t.indexOf(s),o=i===-1?e===1?0:r-1:i+e;return t[o]}function Pf(n){return Lf(je(n).body,1)||n}function jf(n){return Lf(je(n).body,-1)||n}function yr(n,e){const t=e||n.currentTarget,r=n.relatedTarget;return!r||!Oe(t,r)}function $C(n){bi(n,Lr()).forEach(t=>{t.dataset.tabindex=t.getAttribute("tabindex")||"",t.setAttribute("tabindex","-1")})}function qc(n){n.querySelectorAll("[data-tabindex]").forEach(t=>{const r=t.dataset.tabindex;delete t.dataset.tabindex,r?t.setAttribute("tabindex",r):t.removeAttribute("tabindex")})}function Rn(n){const e=y.useRef(void 0),t=y.useCallback(r=>{const s=n.map(i=>{if(i!=null){if(typeof i=="function"){const o=i,l=o(r);return typeof l=="function"?l:()=>{o(null)}}return i.current=r,()=>{i.current=null}}});return()=>{s.forEach(i=>i?.())}},n);return y.useMemo(()=>n.every(r=>r==null)?null:r=>{e.current&&(e.current(),e.current=void 0),r!=null&&(e.current=t(r))},n)}function KC(n,e){const t=n.compareDocumentPosition(e);return t&Node.DOCUMENT_POSITION_FOLLOWING||t&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:t&Node.DOCUMENT_POSITION_PRECEDING||t&Node.DOCUMENT_POSITION_CONTAINS?1:0}const Bf=y.createContext({register:()=>{},unregister:()=>{},map:new Map,elementsRef:{current:[]}});function WC(n){const{children:e,elementsRef:t,labelsRef:r}=n,[s,i]=y.useState(()=>new Set),o=y.useCallback(c=>{i(u=>new Set(u).add(c))},[]),l=y.useCallback(c=>{i(u=>{const d=new Set(u);return d.delete(c),d})},[]),a=y.useMemo(()=>{const c=new Map;return Array.from(s.keys()).sort(KC).forEach((d,f)=>{c.set(d,f)}),c},[s]);return g.jsx(Bf.Provider,{value:y.useMemo(()=>({register:o,unregister:l,map:a,elementsRef:t,labelsRef:r}),[o,l,a,t,r]),children:e})}function UC(n){n===void 0&&(n={});const{label:e}=n,{register:t,unregister:r,map:s,elementsRef:i,labelsRef:o}=y.useContext(Bf),[l,a]=y.useState(null),c=y.useRef(null),u=y.useCallback(d=>{if(c.current=d,l!==null&&(i.current[l]=d,o)){var f;const h=e!==void 0;o.current[l]=h?e:(f=d?.textContent)!=null?f:null}},[l,i,o,e]);return oe(()=>{const d=c.current;if(d)return t(d),()=>{r(d)}},[t,r]),oe(()=>{const d=c.current?s.get(c.current):null;d!=null&&a(d)},[s]),y.useMemo(()=>({ref:u,index:l??-1}),[l,u])}const _C="data-floating-ui-focusable",Jc="active",Zc="selected",Pr="ArrowLeft",jr="ArrowRight",Hf="ArrowUp",xi="ArrowDown",qC={...hu};let Gc=!1,JC=0;const Qc=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+JC++;function ZC(){const[n,e]=y.useState(()=>Gc?Qc():void 0);return oe(()=>{n==null&&e(Qc())},[]),y.useEffect(()=>{Gc=!0},[]),n}const GC=qC.useId,Kl=GC||ZC;function QC(){const n=new Map;return{emit(e,t){var r;(r=n.get(e))==null||r.forEach(s=>s(t))},on(e,t){n.has(e)||n.set(e,new Set),n.get(e).add(t)},off(e,t){var r;(r=n.get(e))==null||r.delete(t)}}}const YC=y.createContext(null),XC=y.createContext(null),vi=()=>{var n;return((n=y.useContext(YC))==null?void 0:n.id)||null},Br=()=>y.useContext(XC);function Tn(n){return"data-floating-ui-"+n}function We(n){n.current!==-1&&(clearTimeout(n.current),n.current=-1)}const Yc=Tn("safe-polygon");function co(n,e,t){if(t&&!Rr(t))return 0;if(typeof n=="number")return n;if(typeof n=="function"){const r=n();return typeof r=="number"?r:r?.[e]}return n?.[e]}function uo(n){return typeof n=="function"?n():n}function e4(n,e){e===void 0&&(e={});const{open:t,onOpenChange:r,dataRef:s,events:i,elements:o}=n,{enabled:l=!0,delay:a=0,handleClose:c=null,mouseOnly:u=!1,restMs:d=0,move:f=!0}=e,h=Br(),p=vi(),m=Ye(c),C=Ye(a),b=Ye(t),v=Ye(d),x=y.useRef(),w=y.useRef(-1),M=y.useRef(),T=y.useRef(-1),P=y.useRef(!0),R=y.useRef(!1),z=y.useRef(()=>{}),j=y.useRef(!1),Y=ye(()=>{var D;const A=(D=s.current.openEvent)==null?void 0:D.type;return A?.includes("mouse")&&A!=="mousedown"});y.useEffect(()=>{if(!l)return;function D(A){let{open:I}=A;I||(We(w),We(T),P.current=!0,j.current=!1)}return i.on("openchange",D),()=>{i.off("openchange",D)}},[l,i]),y.useEffect(()=>{if(!l||!m.current||!t)return;function D(I){Y()&&r(!1,I,"hover")}const A=je(o.floating).documentElement;return A.addEventListener("mouseleave",D),()=>{A.removeEventListener("mouseleave",D)}},[o.floating,t,r,l,m,Y]);const ee=y.useCallback(function(D,A,I){A===void 0&&(A=!0),I===void 0&&(I="hover");const W=co(C.current,"close",x.current);W&&!M.current?(We(w),w.current=window.setTimeout(()=>r(!1,D,I),W)):A&&(We(w),r(!1,D,I))},[C,r]),se=ye(()=>{z.current(),M.current=void 0}),H=ye(()=>{if(R.current){const D=je(o.floating).body;D.style.pointerEvents="",D.removeAttribute(Yc),R.current=!1}}),S=ye(()=>s.current.openEvent?["click","mousedown"].includes(s.current.openEvent.type):!1);y.useEffect(()=>{if(!l)return;function D(N){if(We(w),P.current=!1,u&&!Rr(x.current)||uo(v.current)>0&&!co(C.current,"open"))return;const X=co(C.current,"open",x.current);X?w.current=window.setTimeout(()=>{b.current||r(!0,N,"hover")},X):t||r(!0,N,"hover")}function A(N){if(S()){H();return}z.current();const X=je(o.floating);if(We(T),j.current=!1,m.current&&s.current.floatingContext){t||We(w),M.current=m.current({...s.current.floatingContext,tree:h,x:N.clientX,y:N.clientY,onClose(){H(),se(),S()||ee(N,!0,"safe-polygon")}});const tt=M.current;X.addEventListener("mousemove",tt),z.current=()=>{X.removeEventListener("mousemove",tt)};return}(x.current==="touch"?!Oe(o.floating,N.relatedTarget):!0)&&ee(N)}function I(N){S()||s.current.floatingContext&&(m.current==null||m.current({...s.current.floatingContext,tree:h,x:N.clientX,y:N.clientY,onClose(){H(),se(),S()||ee(N)}})(N))}function W(){We(w)}function ie(N){S()||ee(N,!1)}if(Ue(o.domReference)){const N=o.domReference,X=o.floating;return t&&N.addEventListener("mouseleave",I),f&&N.addEventListener("mousemove",D,{once:!0}),N.addEventListener("mouseenter",D),N.addEventListener("mouseleave",A),X&&(X.addEventListener("mouseleave",I),X.addEventListener("mouseenter",W),X.addEventListener("mouseleave",ie)),()=>{t&&N.removeEventListener("mouseleave",I),f&&N.removeEventListener("mousemove",D),N.removeEventListener("mouseenter",D),N.removeEventListener("mouseleave",A),X&&(X.removeEventListener("mouseleave",I),X.removeEventListener("mouseenter",W),X.removeEventListener("mouseleave",ie))}}},[o,l,n,u,f,ee,se,H,r,t,b,h,C,m,s,S,v]),oe(()=>{var D;if(l&&t&&(D=m.current)!=null&&(D=D.__options)!=null&&D.blockPointerEvents&&Y()){R.current=!0;const I=o.floating;if(Ue(o.domReference)&&I){var A;const W=je(o.floating).body;W.setAttribute(Yc,"");const ie=o.domReference,N=h==null||(A=h.nodesRef.current.find(X=>X.id===p))==null||(A=A.context)==null?void 0:A.elements.floating;return N&&(N.style.pointerEvents=""),W.style.pointerEvents="none",ie.style.pointerEvents="auto",I.style.pointerEvents="auto",()=>{W.style.pointerEvents="",ie.style.pointerEvents="",I.style.pointerEvents=""}}}},[l,t,p,o,h,m,Y]),oe(()=>{t||(x.current=void 0,j.current=!1,se(),H())},[t,se,H]),y.useEffect(()=>()=>{se(),We(w),We(T),H()},[l,o.domReference,se,H]);const G=y.useMemo(()=>{function D(A){x.current=A.pointerType}return{onPointerDown:D,onPointerEnter:D,onMouseMove(A){const{nativeEvent:I}=A;function W(){!P.current&&!b.current&&r(!0,I,"hover")}u&&!Rr(x.current)||t||uo(v.current)===0||j.current&&A.movementX**2+A.movementY**2<2||(We(T),x.current==="touch"?W():(j.current=!0,T.current=window.setTimeout(W,uo(v.current))))}}},[u,r,t,b,v]);return y.useMemo(()=>l?{reference:G}:{},[l,G])}const Xc=()=>{},t4=y.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:Xc,setState:Xc,isInstantPhase:!1});function n4(n){const{children:e,delay:t,timeoutMs:r=0}=n,[s,i]=y.useReducer((a,c)=>({...a,...c}),{delay:t,timeoutMs:r,initialDelay:t,currentId:null,isInstantPhase:!1}),o=y.useRef(null),l=y.useCallback(a=>{i({currentId:a})},[]);return oe(()=>{s.currentId?o.current===null?o.current=s.currentId:s.isInstantPhase||i({isInstantPhase:!0}):(s.isInstantPhase&&i({isInstantPhase:!1}),o.current=null)},[s.currentId,s.isInstantPhase]),g.jsx(t4.Provider,{value:y.useMemo(()=>({...s,setState:i,setCurrentId:l}),[s,l]),children:e})}let eu=0;function cn(n,e){e===void 0&&(e={});const{preventScroll:t=!1,cancelPrevious:r=!0,sync:s=!1}=e;r&&cancelAnimationFrame(eu);const i=()=>n?.focus({preventScroll:t});s?i():eu=requestAnimationFrame(i)}function r4(n){return n?.ownerDocument||document}const zn={inert:new WeakMap,"aria-hidden":new WeakMap,none:new WeakMap};function tu(n){return n==="inert"?zn.inert:n==="aria-hidden"?zn["aria-hidden"]:zn.none}let es=new WeakSet,ts={},fo=0;const s4=()=>typeof HTMLElement<"u"&&"inert"in HTMLElement.prototype,Ff=n=>n&&(n.host||Ff(n.parentNode)),i4=(n,e)=>e.map(t=>{if(n.contains(t))return t;const r=Ff(t);return n.contains(r)?r:null}).filter(t=>t!=null);function o4(n,e,t,r){const s="data-floating-ui-inert",i=r?"inert":t?"aria-hidden":null,o=i4(e,n),l=new Set,a=new Set(o),c=[];ts[s]||(ts[s]=new WeakMap);const u=ts[s];o.forEach(d),f(e),l.clear();function d(h){!h||l.has(h)||(l.add(h),h.parentNode&&d(h.parentNode))}function f(h){!h||a.has(h)||[].forEach.call(h.children,p=>{if(pu(p)!=="script")if(l.has(p))f(p);else{const m=i?p.getAttribute(i):null,C=m!==null&&m!=="false",b=tu(i),v=(b.get(p)||0)+1,x=(u.get(p)||0)+1;b.set(p,v),u.set(p,x),c.push(p),v===1&&C&&es.add(p),x===1&&p.setAttribute(s,""),!C&&i&&p.setAttribute(i,i==="inert"?"":"true")}})}return fo++,()=>{c.forEach(h=>{const p=tu(i),C=(p.get(h)||0)-1,b=(u.get(h)||0)-1;p.set(h,C),u.set(h,b),C||(!es.has(h)&&i&&h.removeAttribute(i),es.delete(h)),b||h.removeAttribute(s)}),fo--,fo||(zn.inert=new WeakMap,zn["aria-hidden"]=new WeakMap,zn.none=new WeakMap,es=new WeakSet,ts={})}}function nu(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);const r=r4(n[0]).body;return o4(n.concat(Array.from(r.querySelectorAll("[aria-live]"))),r,e,t)}const ki={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0},ri=y.forwardRef(function(e,t){const[r,s]=y.useState();oe(()=>{Nf()&&s("button")},[]);const i={ref:t,tabIndex:0,role:r,"aria-hidden":r?void 0:!0,[Tn("focus-guard")]:"",style:ki};return g.jsx("span",{...e,...i})}),Vf=y.createContext(null),ru=Tn("portal");function l4(n){n===void 0&&(n={});const{id:e,root:t}=n,r=Kl(),s=zf(),[i,o]=y.useState(null),l=y.useRef(null);return oe(()=>()=>{i?.remove(),queueMicrotask(()=>{l.current=null})},[i]),oe(()=>{if(!r||l.current)return;const a=e?document.getElementById(e):null;if(!a)return;const c=document.createElement("div");c.id=r,c.setAttribute(ru,""),a.appendChild(c),l.current=c,o(c)},[e,r]),oe(()=>{if(t===null||!r||l.current)return;let a=t||s?.portalNode;a&&!Ue(a)&&(a=a.current),a=a||document.body;let c=null;e&&(c=document.createElement("div"),c.id=e,a.appendChild(c));const u=document.createElement("div");u.id=r,u.setAttribute(ru,""),a=c||a,a.appendChild(u),l.current=u,o(u)},[e,t,r,s]),i}function Wl(n){const{children:e,id:t,root:r,preserveTabOrder:s=!0}=n,i=l4({id:t,root:r}),[o,l]=y.useState(null),a=y.useRef(null),c=y.useRef(null),u=y.useRef(null),d=y.useRef(null),f=o?.modal,h=o?.open,p=!!o&&!o.modal&&o.open&&s&&!!(r||i);return y.useEffect(()=>{if(!i||!s||f)return;function m(C){i&&yr(C)&&(C.type==="focusin"?qc:$C)(i)}return i.addEventListener("focusin",m,!0),i.addEventListener("focusout",m,!0),()=>{i.removeEventListener("focusin",m,!0),i.removeEventListener("focusout",m,!0)}},[i,s,f]),y.useEffect(()=>{i&&(h||qc(i))},[h,i]),g.jsxs(Vf.Provider,{value:y.useMemo(()=>({preserveTabOrder:s,beforeOutsideRef:a,afterOutsideRef:c,beforeInsideRef:u,afterInsideRef:d,portalNode:i,setFocusManagerState:l}),[s,i]),children:[p&&i&&g.jsx(ri,{"data-type":"outside",ref:a,onFocus:m=>{if(yr(m,i)){var C;(C=u.current)==null||C.focus()}else{const b=o?o.domReference:null,v=jf(b);v?.focus()}}}),p&&i&&g.jsx("span",{"aria-owns":i.id,style:ki}),i&&fu.createPortal(e,i),p&&i&&g.jsx(ri,{"data-type":"outside",ref:c,onFocus:m=>{if(yr(m,i)){var C;(C=d.current)==null||C.focus()}else{const b=o?o.domReference:null,v=Pf(b);v?.focus(),o?.closeOnFocusOut&&o?.onOpenChange(!1,m.nativeEvent,"focus-out")}}})]})}const zf=()=>y.useContext(Vf);function su(n){return y.useMemo(()=>e=>{n.forEach(t=>{t&&(t.current=e)})},n)}const a4=20;let un=[];function c4(n){un=un.filter(e=>e.isConnected),n&&pu(n)!=="body"&&(un.push(n),un.length>a4&&(un=un.slice(-20)))}function iu(){return un.slice().reverse().find(n=>n.isConnected)}function u4(n){const e=Lr();return Tf(n,e)?n:bi(n,e)[0]||n}function ou(n,e){var t;if(!e.current.includes("floating")&&!((t=n.getAttribute("role"))!=null&&t.includes("dialog")))return;const r=Lr(),i=SC(n,r).filter(l=>{const a=l.getAttribute("data-tabindex")||"";return Tf(l,r)||l.hasAttribute("data-tabindex")&&!a.startsWith("-")}),o=n.getAttribute("tabindex");e.current.includes("floating")||i.length===0?o!=="0"&&n.setAttribute("tabindex","0"):(o!=="-1"||n.hasAttribute("data-tabindex")&&n.getAttribute("data-tabindex")!=="-1")&&(n.setAttribute("tabindex","-1"),n.setAttribute("data-tabindex","-1"))}const d4=y.forwardRef(function(e,t){return g.jsx("button",{...e,type:"button",ref:t,tabIndex:-1,style:ki})});function $f(n){const{context:e,children:t,disabled:r=!1,order:s=["content"],guards:i=!0,initialFocus:o=0,returnFocus:l=!0,restoreFocus:a=!1,modal:c=!0,visuallyHiddenDismiss:u=!1,closeOnFocusOut:d=!0,outsideElementsInert:f=!1,getInsideElements:h=()=>[]}=n,{open:p,onOpenChange:m,events:C,dataRef:b,elements:{domReference:v,floating:x}}=e,w=ye(()=>{var Z;return(Z=b.current.floatingContext)==null?void 0:Z.nodeId}),M=ye(h),T=typeof o=="number"&&o<0,P=Go(v)&&T,R=s4(),z=R?i:!0,j=!z||R&&f,Y=Ye(s),ee=Ye(o),se=Ye(l),H=Br(),S=zf(),G=y.useRef(null),D=y.useRef(null),A=y.useRef(!1),I=y.useRef(!1),W=y.useRef(-1),ie=S!=null,N=ni(x),X=ye(function(Z){return Z===void 0&&(Z=N),Z?bi(Z,Lr()):[]}),Re=ye(Z=>{const Q=X(Z);return Y.current.map(_=>v&&_==="reference"?v:N&&_==="floating"?N:Q).filter(Boolean).flat()});y.useEffect(()=>{if(r||!c)return;function Z(_){if(_.key==="Tab"){Oe(N,xt(je(N)))&&X().length===0&&!P&&Ie(_);const q=Re(),Ce=Ot(_);Y.current[0]==="reference"&&Ce===v&&(Ie(_),_.shiftKey?cn(q[q.length-1]):cn(q[1])),Y.current[1]==="floating"&&Ce===N&&_.shiftKey&&(Ie(_),cn(q[0]))}}const Q=je(N);return Q.addEventListener("keydown",Z),()=>{Q.removeEventListener("keydown",Z)}},[r,v,N,c,Y,P,X,Re]),y.useEffect(()=>{if(r||!x)return;function Z(Q){const _=Ot(Q),Ce=X().indexOf(_);Ce!==-1&&(W.current=Ce)}return x.addEventListener("focusin",Z),()=>{x.removeEventListener("focusin",Z)}},[r,x,X]),y.useEffect(()=>{if(r||!d)return;function Z(){I.current=!0,setTimeout(()=>{I.current=!1})}function Q(_){const q=_.relatedTarget,Ce=_.currentTarget,ge=Ot(_);queueMicrotask(()=>{const $e=w(),Ke=!(Oe(v,q)||Oe(x,q)||Oe(q,x)||Oe(S?.portalNode,q)||q!=null&&q.hasAttribute(Tn("focus-guard"))||H&&(Vn(H.nodesRef.current,$e).find(ne=>{var ce,ft;return Oe((ce=ne.context)==null?void 0:ce.elements.floating,q)||Oe((ft=ne.context)==null?void 0:ft.elements.domReference,q)})||Uc(H.nodesRef.current,$e).find(ne=>{var ce,ft,F;return[(ce=ne.context)==null?void 0:ce.elements.floating,ni((ft=ne.context)==null?void 0:ft.elements.floating)].includes(q)||((F=ne.context)==null?void 0:F.elements.domReference)===q})));if(Ce===v&&N&&ou(N,Y),a&&Ce!==v&&!(ge!=null&&ge.isConnected)&&xt(je(N))===je(N).body){ht(N)&&N.focus();const ne=W.current,ce=X(),ft=ce[ne]||ce[ce.length-1]||N;ht(ft)&&ft.focus()}if(b.current.insideReactTree){b.current.insideReactTree=!1;return}(P||!c)&&q&&Ke&&!I.current&&q!==iu()&&(A.current=!0,m(!1,_,"focus-out"))})}if(x&&ht(v))return v.addEventListener("focusout",Q),v.addEventListener("pointerdown",Z),x.addEventListener("focusout",Q),()=>{v.removeEventListener("focusout",Q),v.removeEventListener("pointerdown",Z),x.removeEventListener("focusout",Q)}},[r,v,x,N,c,H,S,m,d,a,X,P,w,Y,b]);const tt=y.useRef(null),fe=y.useRef(null),ze=su([tt,S?.beforeInsideRef]),St=su([fe,S?.afterInsideRef]);y.useEffect(()=>{var Z,Q;if(r||!x)return;const _=Array.from((S==null||(Z=S.portalNode)==null?void 0:Z.querySelectorAll("["+Tn("portal")+"]"))||[]),q=H?Uc(H.nodesRef.current,w()):[],Ce=H&&!c?q.map(ne=>{var ce;return(ce=ne.context)==null?void 0:ce.elements.floating}):[],ge=(Q=q.find(ne=>{var ce;return Go(((ce=ne.context)==null?void 0:ce.elements.domReference)||null)}))==null||(Q=Q.context)==null?void 0:Q.elements.domReference,$e=[x,ge,..._,...Ce,...M(),G.current,D.current,tt.current,fe.current,S?.beforeOutsideRef.current,S?.afterOutsideRef.current,Y.current.includes("reference")||P?v:null].filter(ne=>ne!=null),Ke=c||P?nu($e,!j,j):nu($e);return()=>{Ke()}},[r,v,x,c,Y,S,P,z,j,H,w,M]),oe(()=>{if(r||!ht(N))return;const Z=je(N),Q=xt(Z);queueMicrotask(()=>{const _=Re(N),q=ee.current,Ce=(typeof q=="number"?_[q]:q.current)||N,ge=Oe(N,Q);!T&&!ge&&p&&cn(Ce,{preventScroll:Ce===N})})},[r,p,N,T,Re,ee]),oe(()=>{if(r||!N)return;const Z=je(N),Q=xt(Z);c4(Q);function _(ge){let{reason:$e,event:Ke,nested:ne}=ge;if(["hover","safe-polygon"].includes($e)&&Ke.type==="mouseleave"&&(A.current=!0),$e==="outside-press")if(ne)A.current=!1;else if(If(Ke)||Df(Ke))A.current=!1;else{let ce=!1;document.createElement("div").focus({get preventScroll(){return ce=!0,!1}}),ce?A.current=!1:A.current=!0}}C.on("openchange",_);const q=Z.createElement("span");q.setAttribute("tabindex","-1"),q.setAttribute("aria-hidden","true"),Object.assign(q.style,ki),ie&&v&&v.insertAdjacentElement("afterend",q);function Ce(){if(typeof se.current=="boolean"){const ge=v||iu();return ge&&ge.isConnected?ge:q}return se.current.current||q}return()=>{C.off("openchange",_);const ge=xt(Z),$e=Oe(x,ge)||H&&Vn(H.nodesRef.current,w()).some(ne=>{var ce;return Oe((ce=ne.context)==null?void 0:ce.elements.floating,ge)}),Ke=Ce();queueMicrotask(()=>{const ne=u4(Ke);se.current&&!A.current&&ht(ne)&&(!(ne!==ge&&ge!==Z.body)||$e)&&ne.focus({preventScroll:!0}),q.remove()})}},[r,x,N,se,b,C,H,ie,v,w]),y.useEffect(()=>{queueMicrotask(()=>{A.current=!1})},[r]),oe(()=>{if(!r&&S)return S.setFocusManagerState({modal:c,closeOnFocusOut:d,open:p,onOpenChange:m,domReference:v}),()=>{S.setFocusManagerState(null)}},[r,S,c,p,m,d,v]),oe(()=>{r||N&&ou(N,Y)},[r,N,Y]);function on(Z){return r||!u||!c?null:g.jsx(d4,{ref:Z==="start"?G:D,onClick:Q=>m(!1,Q.nativeEvent),children:typeof u=="string"?u:"Dismiss"})}const Mt=!r&&z&&(c?!P:!0)&&(ie||c);return g.jsxs(g.Fragment,{children:[Mt&&g.jsx(ri,{"data-type":"inside",ref:ze,onFocus:Z=>{if(c){const _=Re();cn(s[0]==="reference"?_[0]:_[_.length-1])}else if(S!=null&&S.preserveTabOrder&&S.portalNode)if(A.current=!1,yr(Z,S.portalNode)){const _=Pf(v);_?.focus()}else{var Q;(Q=S.beforeOutsideRef.current)==null||Q.focus()}}}),!P&&on("start"),t,on("end"),Mt&&g.jsx(ri,{"data-type":"inside",ref:St,onFocus:Z=>{if(c)cn(Re()[0]);else if(S!=null&&S.preserveTabOrder&&S.portalNode)if(d&&(A.current=!0),yr(Z,S.portalNode)){const _=jf(v);_?.focus()}else{var Q;(Q=S.afterOutsideRef.current)==null||Q.focus()}}})]})}function lu(n){return ht(n.target)&&n.target.tagName==="BUTTON"}function f4(n){return ht(n.target)&&n.target.tagName==="A"}function au(n){return $l(n)}function Kf(n,e){e===void 0&&(e={});const{open:t,onOpenChange:r,dataRef:s,elements:{domReference:i}}=n,{enabled:o=!0,event:l="click",toggle:a=!0,ignoreMouse:c=!1,keyboardHandlers:u=!0,stickIfOpen:d=!0}=e,f=y.useRef(),h=y.useRef(!1),p=y.useMemo(()=>({onPointerDown(m){f.current=m.pointerType},onMouseDown(m){const C=f.current;m.button===0&&l!=="click"&&(Rr(C,!0)&&c||(t&&a&&(!(s.current.openEvent&&d)||s.current.openEvent.type==="mousedown")?r(!1,m.nativeEvent,"click"):(m.preventDefault(),r(!0,m.nativeEvent,"click"))))},onClick(m){const C=f.current;if(l==="mousedown"&&f.current){f.current=void 0;return}Rr(C,!0)&&c||(t&&a&&(!(s.current.openEvent&&d)||s.current.openEvent.type==="click")?r(!1,m.nativeEvent,"click"):r(!0,m.nativeEvent,"click"))},onKeyDown(m){f.current=void 0,!(m.defaultPrevented||!u||lu(m))&&(m.key===" "&&!au(i)&&(m.preventDefault(),h.current=!0),!f4(m)&&m.key==="Enter"&&r(!(t&&a),m.nativeEvent,"click"))},onKeyUp(m){m.defaultPrevented||!u||lu(m)||au(i)||m.key===" "&&h.current&&(h.current=!1,r(!(t&&a),m.nativeEvent,"click"))}}),[s,i,l,c,u,r,t,d,a]);return y.useMemo(()=>o?{reference:p}:{},[o,p])}const h4={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},p4={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},cu=n=>{var e,t;return{escapeKey:typeof n=="boolean"?n:(e=n?.escapeKey)!=null?e:!1,outsidePress:typeof n=="boolean"?n:(t=n?.outsidePress)!=null?t:!0}};function Ul(n,e){e===void 0&&(e={});const{open:t,onOpenChange:r,elements:s,dataRef:i}=n,{enabled:o=!0,escapeKey:l=!0,outsidePress:a=!0,outsidePressEvent:c="pointerdown",referencePress:u=!1,referencePressEvent:d="pointerdown",ancestorScroll:f=!1,bubbles:h,capture:p}=e,m=Br(),C=ye(typeof a=="function"?a:()=>!1),b=typeof a=="function"?C:a,v=y.useRef(!1),{escapeKey:x,outsidePress:w}=cu(h),{escapeKey:M,outsidePress:T}=cu(p),P=y.useRef(!1),R=y.useRef(-1),z=ye(S=>{var G;if(!t||!o||!l||S.key!=="Escape"||P.current)return;const D=(G=i.current.floatingContext)==null?void 0:G.nodeId,A=m?Vn(m.nodesRef.current,D):[];if(!x&&(S.stopPropagation(),A.length>0)){let I=!0;if(A.forEach(W=>{var ie;if((ie=W.context)!=null&&ie.open&&!W.context.dataRef.current.__escapeKeyBubbles){I=!1;return}}),!I)return}r(!1,IC(S)?S.nativeEvent:S,"escape-key")}),j=ye(S=>{var G;const D=()=>{var A;z(S),(A=Ot(S))==null||A.removeEventListener("keydown",D)};(G=Ot(S))==null||G.addEventListener("keydown",D)}),Y=ye(S=>{var G;const D=i.current.insideReactTree;i.current.insideReactTree=!1;const A=v.current;if(v.current=!1,c==="click"&&A||D||typeof b=="function"&&!b(S))return;const I=Ot(S),W="["+Tn("inert")+"]",ie=je(s.floating).querySelectorAll(W);let N=Ue(I)?I:null;for(;N&&!Ti(N);){const fe=Yh(N);if(Ti(fe)||!Ue(fe))break;N=fe}if(ie.length&&Ue(I)&&!RC(I)&&!Oe(I,s.floating)&&Array.from(ie).every(fe=>!Oe(N,fe)))return;if(ht(I)&&H){const fe=Ti(I),ze=Xh(I),St=/auto|scroll/,on=fe||St.test(ze.overflowX),Mt=fe||St.test(ze.overflowY),Z=on&&I.clientWidth>0&&I.scrollWidth>I.clientWidth,Q=Mt&&I.clientHeight>0&&I.scrollHeight>I.clientHeight,_=ze.direction==="rtl",q=Q&&(_?S.offsetX<=I.offsetWidth-I.clientWidth:S.offsetX>I.clientWidth),Ce=Z&&S.offsetY>I.clientHeight;if(q||Ce)return}const X=(G=i.current.floatingContext)==null?void 0:G.nodeId,Re=m&&Vn(m.nodesRef.current,X).some(fe=>{var ze;return lo(S,(ze=fe.context)==null?void 0:ze.elements.floating)});if(lo(S,s.floating)||lo(S,s.domReference)||Re)return;const tt=m?Vn(m.nodesRef.current,X):[];if(tt.length>0){let fe=!0;if(tt.forEach(ze=>{var St;if((St=ze.context)!=null&&St.open&&!ze.context.dataRef.current.__outsidePressBubbles){fe=!1;return}}),!fe)return}r(!1,S,"outside-press")}),ee=ye(S=>{var G;const D=()=>{var A;Y(S),(A=Ot(S))==null||A.removeEventListener(c,D)};(G=Ot(S))==null||G.addEventListener(c,D)});y.useEffect(()=>{if(!t||!o)return;i.current.__escapeKeyBubbles=x,i.current.__outsidePressBubbles=w;let S=-1;function G(ie){r(!1,ie,"ancestor-scroll")}function D(){window.clearTimeout(S),P.current=!0}function A(){S=window.setTimeout(()=>{P.current=!1},Qh()?5:0)}const I=je(s.floating);l&&(I.addEventListener("keydown",M?j:z,M),I.addEventListener("compositionstart",D),I.addEventListener("compositionend",A)),b&&I.addEventListener(c,T?ee:Y,T);let W=[];return f&&(Ue(s.domReference)&&(W=Ei(s.domReference)),Ue(s.floating)&&(W=W.concat(Ei(s.floating))),!Ue(s.reference)&&s.reference&&s.reference.contextElement&&(W=W.concat(Ei(s.reference.contextElement)))),W=W.filter(ie=>{var N;return ie!==((N=I.defaultView)==null?void 0:N.visualViewport)}),W.forEach(ie=>{ie.addEventListener("scroll",G,{passive:!0})}),()=>{l&&(I.removeEventListener("keydown",M?j:z,M),I.removeEventListener("compositionstart",D),I.removeEventListener("compositionend",A)),b&&I.removeEventListener(c,T?ee:Y,T),W.forEach(ie=>{ie.removeEventListener("scroll",G)}),window.clearTimeout(S)}},[i,s,l,b,c,t,r,f,o,x,w,z,M,j,Y,T,ee]),y.useEffect(()=>{i.current.insideReactTree=!1},[i,b,c]);const se=y.useMemo(()=>({onKeyDown:z,...u&&{[h4[d]]:S=>{r(!1,S.nativeEvent,"reference-press")},...d!=="click"&&{onClick(S){r(!1,S.nativeEvent,"reference-press")}}}}),[z,r,u,d]),H=y.useMemo(()=>({onKeyDown:z,onMouseDown(){v.current=!0},onMouseUp(){v.current=!0},[p4[c]]:()=>{i.current.insideReactTree=!0},onBlurCapture(){m||(We(R),i.current.insideReactTree=!0,R.current=window.setTimeout(()=>{i.current.insideReactTree=!1}))}}),[z,c,i,m]);return y.useMemo(()=>o?{reference:se,floating:H}:{},[o,se,H])}function m4(n){const{open:e=!1,onOpenChange:t,elements:r}=n,s=Kl(),i=y.useRef({}),[o]=y.useState(()=>QC()),l=vi()!=null,[a,c]=y.useState(r.reference),u=ye((h,p,m)=>{i.current.openEvent=h?p:void 0,o.emit("openchange",{open:h,event:p,reason:m,nested:l}),t?.(h,p,m)}),d=y.useMemo(()=>({setPositionReference:c}),[]),f=y.useMemo(()=>({reference:a||r.reference||null,floating:r.floating||null,domReference:r.reference}),[a,r.reference,r.floating]);return y.useMemo(()=>({dataRef:i,open:e,onOpenChange:u,elements:f,events:o,floatingId:s,refs:d}),[e,u,f,o,s,d])}function _l(n){n===void 0&&(n={});const{nodeId:e}=n,t=m4({...n,elements:{reference:null,floating:null,...n.elements}}),r=n.rootContext||t,s=r.elements,[i,o]=y.useState(null),[l,a]=y.useState(null),u=s?.domReference||i,d=y.useRef(null),f=Br();oe(()=>{u&&(d.current=u)},[u]);const h=Zh({...n,elements:{...s,...l&&{reference:l}}}),p=y.useCallback(x=>{const w=Ue(x)?{getBoundingClientRect:()=>x.getBoundingClientRect(),getClientRects:()=>x.getClientRects(),contextElement:x}:x;a(w),h.refs.setReference(w)},[h.refs]),m=y.useCallback(x=>{(Ue(x)||x===null)&&(d.current=x,o(x)),(Ue(h.refs.reference.current)||h.refs.reference.current===null||x!==null&&!Ue(x))&&h.refs.setReference(x)},[h.refs]),C=y.useMemo(()=>({...h.refs,setReference:m,setPositionReference:p,domReference:d}),[h.refs,m,p]),b=y.useMemo(()=>({...h.elements,domReference:u}),[h.elements,u]),v=y.useMemo(()=>({...h,...r,refs:C,elements:b,nodeId:e}),[h,C,b,e,r]);return oe(()=>{r.dataRef.current.floatingContext=v;const x=f?.nodesRef.current.find(w=>w.id===e);x&&(x.context=v)}),y.useMemo(()=>({...h,context:v,refs:C,elements:b}),[h,C,b,v])}function ho(){return MC()&&Nf()}function g4(n,e){e===void 0&&(e={});const{open:t,onOpenChange:r,events:s,dataRef:i,elements:o}=n,{enabled:l=!0,visibleOnly:a=!0}=e,c=y.useRef(!1),u=y.useRef(-1),d=y.useRef(!0);y.useEffect(()=>{if(!l)return;const h=Gh(o.domReference);function p(){!t&&ht(o.domReference)&&o.domReference===xt(je(o.domReference))&&(c.current=!0)}function m(){d.current=!0}function C(){d.current=!1}return h.addEventListener("blur",p),ho()&&(h.addEventListener("keydown",m,!0),h.addEventListener("pointerdown",C,!0)),()=>{h.removeEventListener("blur",p),ho()&&(h.removeEventListener("keydown",m,!0),h.removeEventListener("pointerdown",C,!0))}},[o.domReference,t,l]),y.useEffect(()=>{if(!l)return;function h(p){let{reason:m}=p;(m==="reference-press"||m==="escape-key")&&(c.current=!0)}return s.on("openchange",h),()=>{s.off("openchange",h)}},[s,l]),y.useEffect(()=>()=>{We(u)},[]);const f=y.useMemo(()=>({onMouseLeave(){c.current=!1},onFocus(h){if(c.current)return;const p=Ot(h.nativeEvent);if(a&&Ue(p)){if(ho()&&!h.relatedTarget){if(!d.current&&!$l(p))return}else if(!NC(p))return}r(!0,h.nativeEvent,"focus")},onBlur(h){c.current=!1;const p=h.relatedTarget,m=h.nativeEvent,C=Ue(p)&&p.hasAttribute(Tn("focus-guard"))&&p.getAttribute("data-type")==="outside";u.current=window.setTimeout(()=>{var b;const v=xt(o.domReference?o.domReference.ownerDocument:document);!p&&v===o.domReference||Oe((b=i.current.floatingContext)==null?void 0:b.refs.floating.current,v)||Oe(o.domReference,v)||C||r(!1,m,"focus")})}}),[i,o.domReference,r,a]);return y.useMemo(()=>l?{reference:f}:{},[l,f])}function po(n,e,t){const r=new Map,s=t==="item";let i=n;if(s&&n){const{[Jc]:o,[Zc]:l,...a}=n;i=a}return{...t==="floating"&&{tabIndex:-1,[_C]:""},...i,...e.map(o=>{const l=o?o[t]:null;return typeof l=="function"?n?l(n):null:l}).concat(n).reduce((o,l)=>(l&&Object.entries(l).forEach(a=>{let[c,u]=a;if(!(s&&[Jc,Zc].includes(c)))if(c.indexOf("on")===0){if(r.has(c)||r.set(c,[]),typeof u=="function"){var d;(d=r.get(c))==null||d.push(u),o[c]=function(){for(var f,h=arguments.length,p=new Array(h),m=0;m<h;m++)p[m]=arguments[m];return(f=r.get(c))==null?void 0:f.map(C=>C(...p)).find(C=>C!==void 0)}}}else o[c]=u}),o),{})}}function ql(n){n===void 0&&(n=[]);const e=n.map(l=>l?.reference),t=n.map(l=>l?.floating),r=n.map(l=>l?.item),s=y.useCallback(l=>po(l,n,"reference"),e),i=y.useCallback(l=>po(l,n,"floating"),t),o=y.useCallback(l=>po(l,n,"item"),r);return y.useMemo(()=>({getReferenceProps:s,getFloatingProps:i,getItemProps:o}),[s,i,o])}const y4="Escape";function wi(n,e,t){switch(n){case"vertical":return e;case"horizontal":return t;default:return e||t}}function ns(n,e){return wi(e,n===Hf||n===xi,n===Pr||n===jr)}function mo(n,e,t){return wi(e,n===xi,t?n===Pr:n===jr)||n==="Enter"||n===" "||n===""}function uu(n,e,t){return wi(e,t?n===Pr:n===jr,n===xi)}function du(n,e,t,r){const s=t?n===jr:n===Pr,i=n===Hf;return e==="both"||e==="horizontal"&&r&&r>1?n===y4:wi(e,s,i)}function C4(n,e){const{open:t,onOpenChange:r,elements:s,floatingId:i}=n,{listRef:o,activeIndex:l,onNavigate:a=()=>{},enabled:c=!0,selectedIndex:u=null,allowEscape:d=!1,loop:f=!1,nested:h=!1,rtl:p=!1,virtual:m=!1,focusItemOnOpen:C="auto",focusItemOnHover:b=!0,openOnArrowKeyDown:v=!0,disabledIndices:x=void 0,orientation:w="vertical",parentOrientation:M,cols:T=1,scrollItemIntoView:P=!0,virtualItemRef:R,itemSizes:z,dense:j=!1}=e,Y=ni(s.floating),ee=Ye(Y),se=vi(),H=Br();oe(()=>{n.dataRef.current.orientation=w},[n,w]);const S=ye(()=>{a(A.current===-1?null:A.current)}),G=Go(s.domReference),D=y.useRef(C),A=y.useRef(u??-1),I=y.useRef(null),W=y.useRef(!0),ie=y.useRef(S),N=y.useRef(!!s.floating),X=y.useRef(t),Re=y.useRef(!1),tt=y.useRef(!1),fe=Ye(x),ze=Ye(t),St=Ye(P),on=Ye(u),[Mt,Z]=y.useState(),[Q,_]=y.useState(),q=ye(()=>{function F(de){if(m){var be;(be=de.id)!=null&&be.endsWith("-fui-option")&&(de.id=i+"-"+Math.random().toString(16).slice(2,10)),Z(de.id),H?.events.emit("virtualfocus",de),R&&(R.current=de)}else cn(de,{sync:Re.current,preventScroll:!0})}const te=o.current[A.current],V=tt.current;te&&F(te),(Re.current?de=>de():requestAnimationFrame)(()=>{const de=o.current[A.current]||te;if(!de)return;te||F(de);const be=St.current;be&&ge&&(V||!W.current)&&(de.scrollIntoView==null||de.scrollIntoView(typeof be=="boolean"?{block:"nearest",inline:"nearest"}:be))})});oe(()=>{c&&(t&&s.floating?D.current&&u!=null&&(tt.current=!0,A.current=u,S()):N.current&&(A.current=-1,ie.current()))},[c,t,s.floating,u,S]),oe(()=>{if(c&&t&&s.floating)if(l==null){if(Re.current=!1,on.current!=null)return;if(N.current&&(A.current=-1,q()),(!X.current||!N.current)&&D.current&&(I.current!=null||D.current===!0&&I.current==null)){let F=0;const te=()=>{o.current[0]==null?(F<2&&(F?requestAnimationFrame:queueMicrotask)(te),F++):(A.current=I.current==null||mo(I.current,w,p)||h?ao(o,fe.current):_c(o,fe.current),I.current=null,S())};te()}}else gr(o,l)||(A.current=l,q(),tt.current=!1)},[c,t,s.floating,l,on,h,o,w,p,S,q,fe]),oe(()=>{var F;if(!c||s.floating||!H||m||!N.current)return;const te=H.nodesRef.current,V=(F=te.find(be=>be.id===se))==null||(F=F.context)==null?void 0:F.elements.floating,ue=xt(je(s.floating)),de=te.some(be=>be.context&&Oe(be.context.elements.floating,ue));V&&!de&&W.current&&V.focus({preventScroll:!0})},[c,s.floating,H,se,m]),oe(()=>{if(!c||!H||!m||se)return;function F(te){_(te.id),R&&(R.current=te)}return H.events.on("virtualfocus",F),()=>{H.events.off("virtualfocus",F)}},[c,H,m,se,R]),oe(()=>{ie.current=S,X.current=t,N.current=!!s.floating}),oe(()=>{t||(I.current=null,D.current=C)},[t,C]);const Ce=l!=null,ge=y.useMemo(()=>{function F(V){if(!ze.current)return;const ue=o.current.indexOf(V);ue!==-1&&A.current!==ue&&(A.current=ue,S())}return{onFocus(V){let{currentTarget:ue}=V;Re.current=!0,F(ue)},onClick:V=>{let{currentTarget:ue}=V;return ue.focus({preventScroll:!0})},...b&&{onMouseMove(V){let{currentTarget:ue}=V;Re.current=!0,tt.current=!1,F(ue)},onPointerLeave(V){let{pointerType:ue}=V;if(!(!W.current||ue==="touch")&&(Re.current=!0,A.current=-1,S(),!m)){var de;(de=ee.current)==null||de.focus({preventScroll:!0})}}}}},[ze,ee,b,o,S,m]),$e=y.useCallback(()=>{var F;return M??(H==null||(F=H.nodesRef.current.find(te=>te.id===se))==null||(F=F.context)==null||(F=F.dataRef)==null?void 0:F.current.orientation)},[se,H,M]),Ke=ye(F=>{if(W.current=!1,Re.current=!0,F.which===229||!ze.current&&F.currentTarget===ee.current)return;if(h&&du(F.key,w,p,T)){ns(F.key,$e())||Ie(F),r(!1,F.nativeEvent,"list-navigation"),ht(s.domReference)&&(m?H?.events.emit("virtualfocus",s.domReference):s.domReference.focus());return}const te=A.current,V=ao(o,x),ue=_c(o,x);if(G||(F.key==="Home"&&(Ie(F),A.current=V,S()),F.key==="End"&&(Ie(F),A.current=ue,S())),T>1){const de=z||Array.from({length:o.current.length},()=>({width:1,height:1})),be=FC(de,T,j),Qn=be.findIndex(ot=>ot!=null&&!us(o,ot,x)),Fr=be.reduce((ot,ln,Vr)=>ln!=null&&!us(o,ln,x)?Vr:ot,-1),Yn=be[HC({current:be.map(ot=>ot!=null?o.current[ot]:null)},{event:F,orientation:w,loop:f,rtl:p,cols:T,disabledIndices:zC([...(typeof x!="function"?x:null)||o.current.map((ot,ln)=>us(o,ln,x)?ln:void 0),void 0],be),minIndex:Qn,maxIndex:Fr,prevIndex:VC(A.current>ue?V:A.current,de,be,T,F.key===xi?"bl":F.key===(p?Pr:jr)?"tr":"tl"),stopEvent:!0})];if(Yn!=null&&(A.current=Yn,S()),w==="both")return}if(ns(F.key,w)){if(Ie(F),t&&!m&&xt(F.currentTarget.ownerDocument)===F.currentTarget){A.current=mo(F.key,w,p)?V:ue,S();return}mo(F.key,w,p)?f?A.current=te>=ue?d&&te!==o.current.length?-1:V:He(o,{startingIndex:te,disabledIndices:x}):A.current=Math.min(ue,He(o,{startingIndex:te,disabledIndices:x})):f?A.current=te<=V?d&&te!==-1?o.current.length:ue:He(o,{startingIndex:te,decrement:!0,disabledIndices:x}):A.current=Math.max(V,He(o,{startingIndex:te,decrement:!0,disabledIndices:x})),gr(o,A.current)&&(A.current=-1),S()}}),ne=y.useMemo(()=>m&&t&&Ce&&{"aria-activedescendant":Q||Mt},[m,t,Ce,Q,Mt]),ce=y.useMemo(()=>({"aria-orientation":w==="both"?void 0:w,...G?{}:ne,onKeyDown:Ke,onPointerMove(){W.current=!0}}),[ne,Ke,w,G]),ft=y.useMemo(()=>{function F(V){C==="auto"&&If(V.nativeEvent)&&(D.current=!0)}function te(V){D.current=C,C==="auto"&&Df(V.nativeEvent)&&(D.current=!0)}return{...ne,onKeyDown(V){W.current=!1;const ue=V.key.startsWith("Arrow"),de=["Home","End"].includes(V.key),be=ue||de,Qn=uu(V.key,w,p),Fr=du(V.key,w,p,T),Yn=uu(V.key,$e(),p),ot=ns(V.key,w),ln=(h?Yn:ot)||V.key==="Enter"||V.key.trim()==="";if(m&&t){const zr=H?.nodesRef.current.find($r=>$r.parentId==null),Pt=H&&zr?OC(H.nodesRef.current,zr.id):null;if(be&&Pt&&R){const $r=new KeyboardEvent("keydown",{key:V.key,bubbles:!0});if(Qn||Fr){var Vr,da;const _h=((Vr=Pt.context)==null?void 0:Vr.elements.domReference)===V.currentTarget,ha=Fr&&!_h?(da=Pt.context)==null?void 0:da.elements.domReference:Qn?o.current.find(pa=>pa?.id===Mt):null;ha&&(Ie(V),ha.dispatchEvent($r),_(void 0))}if((ot||de)&&Pt.context&&Pt.context.open&&Pt.parentId&&V.currentTarget!==Pt.context.elements.domReference){var fa;Ie(V),(fa=Pt.context.elements.domReference)==null||fa.dispatchEvent($r);return}}return Ke(V)}if(!(!t&&!v&&ue)){if(ln){const zr=ns(V.key,$e());I.current=h&&zr?null:V.key}if(h){Yn&&(Ie(V),t?(A.current=ao(o,fe.current),S()):r(!0,V.nativeEvent,"list-navigation"));return}ot&&(u!=null&&(A.current=u),Ie(V),!t&&v?r(!0,V.nativeEvent,"list-navigation"):Ke(V),t&&S())}},onFocus(){t&&!m&&(A.current=-1,S())},onPointerDown:te,onPointerEnter:te,onMouseDown:F,onClick:F}},[Mt,ne,T,Ke,fe,C,o,h,S,r,t,v,w,$e,p,u,H,m,R]);return y.useMemo(()=>c?{reference:ft,floating:ce,item:ge}:{},[c,ft,ce,ge])}const b4=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function Jl(n,e){var t,r;e===void 0&&(e={});const{open:s,elements:i,floatingId:o}=n,{enabled:l=!0,role:a="dialog"}=e,c=Kl(),u=((t=i.domReference)==null?void 0:t.id)||c,d=y.useMemo(()=>{var v;return((v=ni(i.floating))==null?void 0:v.id)||o},[i.floating,o]),f=(r=b4.get(a))!=null?r:a,p=vi()!=null,m=y.useMemo(()=>f==="tooltip"||a==="label"?{["aria-"+(a==="label"?"labelledby":"describedby")]:s?d:void 0}:{"aria-expanded":s?"true":"false","aria-haspopup":f==="alertdialog"?"dialog":f,"aria-controls":s?d:void 0,...f==="listbox"&&{role:"combobox"},...f==="menu"&&{id:u},...f==="menu"&&p&&{role:"menuitem"},...a==="select"&&{"aria-autocomplete":"none"},...a==="combobox"&&{"aria-autocomplete":"list"}},[f,d,p,s,u,a]),C=y.useMemo(()=>{const v={id:d,...f&&{role:f}};return f==="tooltip"||a==="label"?v:{...v,...f==="menu"&&{"aria-labelledby":u}}},[f,d,u,a]),b=y.useCallback(v=>{let{active:x,selected:w}=v;const M={role:"option",...x&&{id:d+"-fui-option"}};switch(a){case"select":return{...M,"aria-selected":x&&w};case"combobox":return{...M,"aria-selected":w}}return{}},[d,a]);return y.useMemo(()=>l?{reference:m,floating:C,item:b}:{},[l,m,C,b])}function x4(n,e){var t;const{open:r,dataRef:s}=n,{listRef:i,activeIndex:o,onMatch:l,onTypingChange:a,enabled:c=!0,findMatch:u=null,resetMs:d=750,ignoreKeys:f=[],selectedIndex:h=null}=e,p=y.useRef(-1),m=y.useRef(""),C=y.useRef((t=h??o)!=null?t:-1),b=y.useRef(null),v=ye(l),x=ye(a),w=Ye(u),M=Ye(f);oe(()=>{r&&(We(p),b.current=null,m.current="")},[r]),oe(()=>{if(r&&m.current===""){var j;C.current=(j=h??o)!=null?j:-1}},[r,h,o]);const T=ye(j=>{j?s.current.typing||(s.current.typing=j,x(j)):s.current.typing&&(s.current.typing=j,x(j))}),P=ye(j=>{function Y(G,D,A){const I=w.current?w.current(D,A):D.find(W=>W?.toLocaleLowerCase().indexOf(A.toLocaleLowerCase())===0);return I?G.indexOf(I):-1}const ee=i.current;if(m.current.length>0&&m.current[0]!==" "&&(Y(ee,ee,m.current)===-1?T(!1):j.key===" "&&Ie(j)),ee==null||M.current.includes(j.key)||j.key.length!==1||j.ctrlKey||j.metaKey||j.altKey)return;r&&j.key!==" "&&(Ie(j),T(!0)),ee.every(G=>{var D,A;return G?((D=G[0])==null?void 0:D.toLocaleLowerCase())!==((A=G[1])==null?void 0:A.toLocaleLowerCase()):!0})&&m.current===j.key&&(m.current="",C.current=b.current),m.current+=j.key,We(p),p.current=window.setTimeout(()=>{m.current="",C.current=b.current,T(!1)},d);const H=C.current,S=Y(ee,[...ee.slice((H||0)+1),...ee.slice(0,(H||0)+1)],m.current);S!==-1?(v(S),b.current=S):j.key!==" "&&(m.current="",T(!1))}),R=y.useMemo(()=>({onKeyDown:P}),[P]),z=y.useMemo(()=>({onKeyDown:P,onKeyUp(j){j.key===" "&&T(!1)}}),[P,T]);return y.useMemo(()=>c?{reference:R,floating:z}:{},[c,R,z])}function v4({initialOpen:n=!1,placement:e="top",open:t,onOpenChange:r,delay:s=600,closeDelay:i=0}={}){const[o,l]=y.useState(n),a=t??o,c=r??l,u=_l({placement:e,open:a,onOpenChange:c,whileElementsMounted:ol,middleware:[rl(4),sl({crossAxis:e.includes("-"),fallbackAxisSideDirection:"start",padding:4}),il({padding:4})]}),d=u.context,f=e4(d,{mouseOnly:!0,move:!1,restMs:s,enabled:t==null,delay:{close:i}}),h=g4(d,{enabled:t==null}),p=Ul(d),m=Jl(d,{role:"tooltip"}),C=ql([f,h,p,m]);return y.useMemo(()=>({open:a,setOpen:c,...C,...u}),[a,c,C,u])}const Qo=y.createContext(null);function Wf(){const n=y.useContext(Qo);if(n==null)throw new Error("Tooltip components must be wrapped in <TooltipProvider />");return n}function Uf({children:n,...e}){const t=v4(e);return e.useDelayGroup?g.jsx(n4,{delay:{open:e.delay??0,close:e.closeDelay??0},timeoutMs:e.timeout,children:g.jsx(Qo.Provider,{value:t,children:n})}):g.jsx(Qo.Provider,{value:t,children:n})}const _f=y.forwardRef(function({children:e,asChild:t=!1,...r},s){const i=Wf(),o=y.isValidElement(e)?parseInt(y.version,10)>=19?e.props.ref:e.ref:void 0,l=Rn([i.refs.setReference,s,o]);if(t&&y.isValidElement(e)){const a={"data-tooltip-state":i.open?"open":"closed"};return y.cloneElement(e,i.getReferenceProps({ref:l,...r,...typeof e.props=="object"?e.props:{},...a}))}return g.jsx("button",{ref:l,"data-tooltip-state":i.open?"open":"closed",...i.getReferenceProps(r),children:e})}),qf=y.forwardRef(function({style:e,children:t,portal:r=!0,portalProps:s={},...i},o){const l=Wf(),a=Rn([l.refs.setFloating,o]);if(!l.open)return null;const c=g.jsx("div",{ref:a,style:{...l.floatingStyles,...e},...l.getFloatingProps(i),className:"tiptap-tooltip",children:t});return r?g.jsx(Wl,{...s,children:c}):c});Uf.displayName="Tooltip";_f.displayName="TooltipTrigger";qf.displayName="TooltipContent";const k4={ctrl:"⌘",alt:"⌥",shift:"⇧"},w4=(n,e)=>{if(e){const t=n.toLowerCase();return k4[t]||n.toUpperCase()}return n.charAt(0).toUpperCase()+n.slice(1)},S4=(n,e)=>n?n.split("-").map(t=>t.trim()).map(t=>w4(t,e)):[],M4=({shortcuts:n})=>n.length===0?null:g.jsx("div",{children:n.map((e,t)=>g.jsxs(y.Fragment,{children:[t>0&&g.jsx("kbd",{children:"+"}),g.jsx("kbd",{children:e})]},t))}),Te=y.forwardRef(({className:n="",children:e,tooltip:t,showTooltip:r=!0,shortcutKeys:s,"aria-label":i,...o},l)=>{const a=y.useMemo(()=>typeof navigator<"u"&&navigator.platform.toLowerCase().includes("mac"),[]),c=y.useMemo(()=>S4(s,a),[s,a]);return!t||!r?g.jsx("button",{className:`tiptap-button ${n}`.trim(),ref:l,"aria-label":i,...o,children:e}):g.jsxs(Uf,{delay:200,children:[g.jsx(_f,{className:`tiptap-button ${n}`.trim(),ref:l,"aria-label":i,...o,children:e}),g.jsxs(qf,{children:[t,g.jsx(M4,{shortcuts:c})]})]})});Te.displayName="Button";const Yo=y.forwardRef(({orientation:n="horizontal",size:e,className:t="",style:r={},...s},i)=>{const o={...r,...n==="horizontal"&&!e&&{flex:1},...e&&{width:n==="vertical"?"1px":e,height:n==="horizontal"?"1px":e}};return g.jsx("div",{ref:i,...s,className:t,style:o})});Yo.displayName="Spacer";const Gn=y.forwardRef(({decorative:n,orientation:e="vertical",className:t="",...r},s)=>{const o=n?{role:"none"}:{"aria-orientation":e==="vertical"?e:void 0,role:"separator"};return g.jsx("div",{className:`tiptap-separator ${t}`.trim(),"data-orientation":e,...o,...r,ref:s})});Gn.displayName="Separator";const Zl=n=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})},Gl=(n,e)=>{y.useEffect(()=>{const t=n.current;if(!t)return;let r=!0;r&&requestAnimationFrame(e);const s=new MutationObserver(()=>{r&&requestAnimationFrame(e)});return s.observe(t,{childList:!0,subtree:!0,attributes:!0}),()=>{r=!1,s.disconnect()}},[n,e])},E4=n=>{y.useEffect(()=>{const e=n.current;if(!e)return;const t=()=>Array.from(e.querySelectorAll('button:not([disabled]), [role="button"]:not([disabled]), [tabindex="0"]:not([disabled])')),r=(i,o,l)=>{i.preventDefault();let a=o;a>=l.length?a=0:a<0&&(a=l.length-1),l[a]?.focus()},s=i=>{const o=t();if(!o.length)return;const l=document.activeElement,a=o.indexOf(l);if(!e.contains(l))return;const u={ArrowRight:()=>r(i,a+1,o),ArrowDown:()=>r(i,a+1,o),ArrowLeft:()=>r(i,a-1,o),ArrowUp:()=>r(i,a-1,o),Home:()=>r(i,0,o),End:()=>r(i,o.length-1,o)}[i.key];u&&u()};return e.addEventListener("keydown",s),()=>e.removeEventListener("keydown",s)},[n])},T4=n=>{const[e,t]=y.useState(!0),r=y.useRef(!1);y.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[]);const s=y.useCallback(()=>{if(!r.current)return;const i=n.current;if(!i)return;const o=Array.from(i.children).some(l=>l instanceof HTMLElement&&l.getAttribute("role")==="group"?l.children.length>0:!1);t(o)},[n]);return Gl(n,s),e},A4=n=>{const[e,t]=y.useState(!0),r=y.useRef(!1);y.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[]);const s=y.useCallback(()=>{if(!r.current)return;const i=n.current;if(!i)return;const o=Array.from(i.children).some(l=>l instanceof HTMLElement);t(o)},[n]);return Gl(n,s),e},R4=n=>{const[e,t]=y.useState(!0),r=y.useRef(!1);y.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[]);const s=y.useCallback(()=>{if(!r.current)return;const i=n.current;if(!i)return;const o=i.previousElementSibling,l=i.nextElementSibling;if(!o||!l){t(!1);return}const a=o.getAttribute("role")==="group"&&l.getAttribute("role")==="group",c=o.children.length>0&&l.children.length>0;t(a&&c)},[n]);return Gl(n,s),e},Jf=y.forwardRef(({children:n,className:e,variant:t="fixed",...r},s)=>{const i=y.useRef(null),o=T4(i);return E4(i),o?g.jsx("div",{ref:Zl([i,s]),role:"toolbar","aria-label":"toolbar","data-variant":t,className:`tiptap-toolbar ${e||""}`,...r,children:n}):null});Jf.displayName="Toolbar";const $t=y.forwardRef(({children:n,className:e,...t},r)=>{const s=y.useRef(null);return A4(s)?g.jsx("div",{ref:Zl([s,r]),role:"group",className:`tiptap-toolbar-group ${e||""}`,...t,children:n}):null});$t.displayName="ToolbarGroup";const Kt=y.forwardRef(({...n},e)=>{const t=y.useRef(null);return R4(t)?g.jsx(Gn,{ref:Zl([t,e]),orientation:"vertical",decorative:!0,...n}):null});Kt.displayName="ToolbarSeparator";const Zf=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{d:"M18.7071 6.70711C19.0976 6.31658 19.0976 5.68342 18.7071 5.29289C18.3166 4.90237 17.6834 4.90237 17.2929 5.29289L12 10.5858L6.70711 5.29289C6.31658 4.90237 5.68342 4.90237 5.29289 5.29289C4.90237 5.68342 4.90237 6.31658 5.29289 6.70711L10.5858 12L5.29289 17.2929C4.90237 17.6834 4.90237 18.3166 5.29289 18.7071C5.68342 19.0976 6.31658 19.0976 6.70711 18.7071L12 13.4142L17.2929 18.7071C17.6834 19.0976 18.3166 19.0976 18.7071 18.7071C19.0976 18.3166 19.0976 17.6834 18.7071 17.2929L13.4142 12L18.7071 6.70711Z",fill:"currentColor"})}));Zf.displayName="CloseIcon";function N4(n){const[e,t]=y.useState(null),r=async o=>{if(o.size>n.maxSize){const c=new Error(`File size exceeds maximum allowed (${n.maxSize/1024/1024}MB)`);return n.onError?.(c),null}const l=new AbortController,a={id:crypto.randomUUID(),file:o,progress:0,status:"uploading",abortController:l};t(a);try{if(!n.upload)throw new Error("Upload function is not defined");const c=await n.upload(o,u=>{t(d=>d?{...d,progress:u.progress}:null)},l.signal);if(!c)throw new Error("Upload failed: No URL returned");return l.signal.aborted?null:(t(u=>u?{...u,status:"success",url:c,progress:100}:null),n.onSuccess?.(c),c)}catch(c){return l.signal.aborted||(t(u=>u?{...u,status:"error",progress:0}:null),n.onError?.(c instanceof Error?c:new Error("Upload failed"))),null}};return{fileItem:e,uploadFiles:async o=>{if(!o||o.length===0)return n.onError?.(new Error("No files to upload")),null;if(n.limit&&o.length>n.limit)return n.onError?.(new Error(`Maximum ${n.limit} file${n.limit===1?"":"s"} allowed`)),null;const l=o[0];return l?r(l):(n.onError?.(new Error("File is undefined")),null)},clearFileItem:()=>{e&&(e.abortController&&e.abortController.abort(),e.url&&URL.revokeObjectURL(e.url),t(null))}}}const Gf=()=>g.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",className:"tiptap-image-upload-icon",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("path",{d:"M11.1953 4.41771C10.3478 4.08499 9.43578 3.94949 8.5282 4.02147C7.62062 4.09345 6.74133 4.37102 5.95691 4.83316C5.1725 5.2953 4.50354 5.92989 4.00071 6.68886C3.49788 7.44783 3.17436 8.31128 3.05465 9.2138C2.93495 10.1163 3.0222 11.0343 3.3098 11.8981C3.5974 12.7619 4.07781 13.5489 4.71463 14.1995C5.10094 14.5942 5.09414 15.2274 4.69945 15.6137C4.30476 16 3.67163 15.9932 3.28532 15.5985C2.43622 14.731 1.79568 13.6816 1.41221 12.5299C1.02875 11.3781 0.91241 10.1542 1.07201 8.95084C1.23162 7.74748 1.66298 6.59621 2.33343 5.58425C3.00387 4.57229 3.89581 3.72617 4.9417 3.10998C5.98758 2.4938 7.15998 2.1237 8.37008 2.02773C9.58018 1.93176 10.7963 2.11243 11.9262 2.55605C13.0561 2.99968 14.0703 3.69462 14.8919 4.58825C15.5423 5.29573 16.0585 6.11304 16.4177 7.00002H17.4999C18.6799 6.99991 19.8288 7.37933 20.7766 8.08222C21.7245 8.78515 22.4212 9.7743 22.7637 10.9036C23.1062 12.0328 23.0765 13.2423 22.6788 14.3534C22.2812 15.4644 21.5367 16.4181 20.5554 17.0736C20.0962 17.3803 19.4752 17.2567 19.1684 16.7975C18.8617 16.3382 18.9853 15.7172 19.4445 15.4105C20.069 14.9934 20.5427 14.3865 20.7958 13.6794C21.0488 12.9724 21.0678 12.2027 20.8498 11.4841C20.6318 10.7655 20.1885 10.136 19.5853 9.6887C18.9821 9.24138 18.251 8.99993 17.5001 9.00002H15.71C15.2679 9.00002 14.8783 8.70973 14.7518 8.28611C14.4913 7.41374 14.0357 6.61208 13.4195 5.94186C12.8034 5.27164 12.0427 4.75043 11.1953 4.41771Z",fill:"currentColor"}),g.jsx("path",{d:"M11 14.4142V21C11 21.5523 11.4477 22 12 22C12.5523 22 13 21.5523 13 21V14.4142L15.2929 16.7071C15.6834 17.0976 16.3166 17.0976 16.7071 16.7071C17.0976 16.3166 17.0976 15.6834 16.7071 15.2929L12.7078 11.2936C12.7054 11.2912 12.703 11.2888 12.7005 11.2864C12.5208 11.1099 12.2746 11.0008 12.003 11L12 11L11.997 11C11.8625 11.0004 11.7343 11.0273 11.6172 11.0759C11.502 11.1236 11.3938 11.1937 11.2995 11.2864C11.297 11.2888 11.2946 11.2912 11.2922 11.2936L7.29289 15.2929C6.90237 15.6834 6.90237 16.3166 7.29289 16.7071C7.68342 17.0976 8.31658 17.0976 8.70711 16.7071L11 14.4142Z",fill:"currentColor"})]}),O4=()=>g.jsx("svg",{width:"43",height:"57",viewBox:"0 0 43 57",fill:"currentColor",className:"tiptap-image-upload-dropzone-rect-primary",xmlns:"http://www.w3.org/2000/svg",children:g.jsx("path",{d:"M0.75 10.75C0.75 5.64137 4.89137 1.5 10 1.5H32.3431C33.2051 1.5 34.0317 1.84241 34.6412 2.4519L40.2981 8.10876C40.9076 8.71825 41.25 9.5449 41.25 10.4069V46.75C41.25 51.8586 37.1086 56 32 56H10C4.89137 56 0.75 51.8586 0.75 46.75V10.75Z",fill:"currentColor",fillOpacity:"0.11",stroke:"currentColor",strokeWidth:"1.5"})}),I4=()=>g.jsx("svg",{width:"10",height:"10",className:"tiptap-image-upload-dropzone-rect-secondary",viewBox:"0 0 10 10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:g.jsx("path",{d:"M0 0.75H0.343146C1.40401 0.75 2.42143 1.17143 3.17157 1.92157L8.82843 7.57843C9.57857 8.32857 10 9.34599 10 10.4069V10.75H4C1.79086 10.75 0 8.95914 0 6.75V0.75Z",fill:"currentColor"})}),D4=({onFile:n,children:e})=>{const[t,r]=y.useState(!1),s=l=>{r(!1),l.preventDefault(),l.stopPropagation();const a=Array.from(l.dataTransfer.files);n(a)},i=l=>{l.preventDefault(),r(!0)},o=l=>{l.preventDefault(),r(!1)};return g.jsx("div",{className:`tiptap-image-upload-dragger ${t?"tiptap-image-upload-dragger-active":""}`,onDrop:s,onDragOver:i,onDragLeave:o,children:e})},L4=({file:n,progress:e,status:t,onRemove:r})=>{const s=i=>{if(i===0)return"0 Bytes";const o=1024,l=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(i)/Math.log(o));return`${parseFloat((i/Math.pow(o,a)).toFixed(2))} ${l[a]}`};return g.jsxs("div",{className:"tiptap-image-upload-preview",children:[t==="uploading"&&g.jsx("div",{className:"tiptap-image-upload-progress",style:{width:`${e}%`}}),g.jsxs("div",{className:"tiptap-image-upload-preview-content",children:[g.jsxs("div",{className:"tiptap-image-upload-file-info",children:[g.jsx("div",{className:"tiptap-image-upload-file-icon",children:g.jsx(Gf,{})}),g.jsxs("div",{className:"tiptap-image-upload-details",children:[g.jsx("span",{className:"tiptap-image-upload-text",children:n.name}),g.jsx("span",{className:"tiptap-image-upload-subtext",children:s(n.size)})]})]}),g.jsxs("div",{className:"tiptap-image-upload-actions",children:[t==="uploading"&&g.jsxs("span",{className:"tiptap-image-upload-progress-text",children:[e,"%"]}),g.jsx("button",{className:"tiptap-image-upload-close-btn",onClick:i=>{i.stopPropagation(),r()},children:g.jsx(Zf,{})})]})]})]})},P4=({maxSize:n})=>g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"tiptap-image-upload-dropzone",children:[g.jsx(O4,{}),g.jsx(I4,{}),g.jsx("div",{className:"tiptap-image-upload-icon-container",children:g.jsx(Gf,{})})]}),g.jsxs("div",{className:"tiptap-image-upload-content",children:[g.jsxs("span",{className:"tiptap-image-upload-text",children:[g.jsx("em",{children:"Click to upload"})," or drag and drop"]}),g.jsxs("span",{className:"tiptap-image-upload-subtext",children:["Maximum file size ",n/1024/1024,"MB."]})]})]}),j4=n=>{const{accept:e,limit:t,maxSize:r}=n.node.attrs,s=y.useRef(null),i=n.extension,o={maxSize:r,limit:t,accept:e,upload:i.options.upload,onSuccess:i.options.onSuccess,onError:i.options.onError},{fileItem:l,uploadFiles:a,clearFileItem:c}=N4(o),u=h=>{const p=h.target.files;if(!p||p.length===0){i.options.onError?.(new Error("No file selected"));return}d(Array.from(p))},d=async h=>{const p=await a(h);if(p){const m=n.getPos(),C=h[0]?.name.replace(/\.[^/.]+$/,"")||"unknown";n.editor.chain().focus().deleteRange({from:m,to:m+1}).insertContentAt(m,[{type:"image",attrs:{src:p,alt:C,title:C}}]).run()}},f=()=>{s.current&&!l&&(s.current.value="",s.current.click())};return g.jsxs(w2,{className:"tiptap-image-upload",tabIndex:0,onClick:f,children:[!l&&g.jsx(D4,{onFile:d,children:g.jsx(P4,{maxSize:r})}),l&&g.jsx(L4,{file:l.file,progress:l.progress,status:l.status,onRemove:c}),g.jsx("input",{ref:s,name:"file",accept:e,type:"file",onChange:u,onClick:h=>h.stopPropagation()})]})},B4=Ge.create({name:"imageUpload",group:"block",draggable:!0,selectable:!0,atom:!0,addOptions(){return{accept:"image/*",limit:1,maxSize:0,upload:void 0,onError:void 0,onSuccess:void 0}},addAttributes(){return{accept:{default:this.options.accept},limit:{default:this.options.limit},maxSize:{default:this.options.maxSize}}},parseHTML(){return[{tag:'div[data-type="image-upload"]'}]},renderHTML({HTMLAttributes:n}){return["div",ae({"data-type":"image-upload"},n)]},addNodeView(){return R2(j4)},addCommands(){return{setImageUploadNode:(n={})=>({commands:e})=>e.insertContent({type:this.name,attrs:n})}},addKeyboardShortcuts(){return{Enter:({editor:n})=>{const{selection:e}=n.state,{nodeAfter:t}=e.$from;if(t&&t.type.name==="imageUpload"&&n.isActive("imageUpload")){const r=n.view.nodeDOM(e.$from.pos);if(r&&r instanceof HTMLElement){const s=r.firstChild;if(s&&s instanceof HTMLElement)return s.click(),!0}}return!1}}}});function et(n){const{editor:e}=v2();return y.useMemo(()=>n||e,[n,e])}const Ql=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.29289 8.29289C5.68342 7.90237 6.31658 7.90237 6.70711 8.29289L12 13.5858L17.2929 8.29289C17.6834 7.90237 18.3166 7.90237 18.7071 8.29289C19.0976 8.68342 19.0976 9.31658 18.7071 9.70711L12.7071 15.7071C12.3166 16.0976 11.6834 16.0976 11.2929 15.7071L5.29289 9.70711C4.90237 9.31658 4.90237 8.68342 5.29289 8.29289Z",fill:"currentColor"})}));Ql.displayName="ChevronDownIcon";const Xo=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{d:"M6 3C6.55228 3 7 3.44772 7 4V11H17V4C17 3.44772 17.4477 3 18 3C18.5523 3 19 3.44772 19 4V20C19 20.5523 18.5523 21 18 21C17.4477 21 17 20.5523 17 20V13H7V20C7 20.5523 6.55228 21 6 21C5.44772 21 5 20.5523 5 20V4C5 3.44772 5.44772 3 6 3Z",fill:"currentColor"})}));Xo.displayName="HeadingIcon";const el=5*1024*1024,Si=(n,e)=>e?.schema?e.schema.spec.marks.get(n)!==void 0:!1,Hr=(n,e)=>e?.schema?e.schema.spec.nodes.get(n)!==void 0:!1;function H4(n){return!!n&&n.content.size===0}function F4(n){const{editor:e,node:t,nodePos:r}=n;if(!e||!e.state?.doc)return null;const s=t!=null,i=r!=null;if(!s&&!i)return null;if(i)try{const a=e.state.doc.nodeAt(r);if(a)return{pos:r,node:a}}catch(a){return console.error("Error checking node at position:",a),null}let o=-1,l=null;return e.state.doc.descendants((a,c)=>a===t?(o=c,l=a,!1):!0),o!==-1&&l!==null?{pos:o,node:l}:null}const V4=async(n,e,t)=>{if(!n)throw new Error("No file provided");if(n.size>el)throw new Error(`File size exceeds maximum allowed (${el/(1024*1024)}MB)`);for(let r=0;r<=100;r+=10){if(t?.aborted)throw new Error("Upload cancelled");await new Promise(s=>setTimeout(s,500)),e?.({progress:r})}return"/images/placeholder-image.png"},Qf=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M5 6C5 5.44772 4.55228 5 4 5C3.44772 5 3 5.44772 3 6V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V13H11V18C11 18.5523 11.4477 19 12 19C12.5523 19 13 18.5523 13 18V6C13 5.44772 12.5523 5 12 5C11.4477 5 11 5.44772 11 6V11H5V6Z",fill:"currentColor"}),g.jsx("path",{d:"M21.0001 10C21.0001 9.63121 20.7971 9.29235 20.472 9.11833C20.1468 8.94431 19.7523 8.96338 19.4454 9.16795L16.4454 11.168C15.9859 11.4743 15.8617 12.0952 16.1681 12.5547C16.4744 13.0142 17.0953 13.1384 17.5548 12.8321L19.0001 11.8685V18C19.0001 18.5523 19.4478 19 20.0001 19C20.5524 19 21.0001 18.5523 21.0001 18V10Z",fill:"currentColor"})]}));Qf.displayName="HeadingOneIcon";const Yf=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M5 6C5 5.44772 4.55228 5 4 5C3.44772 5 3 5.44772 3 6V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V13H11V18C11 18.5523 11.4477 19 12 19C12.5523 19 13 18.5523 13 18V6C13 5.44772 12.5523 5 12 5C11.4477 5 11 5.44772 11 6V11H5V6Z",fill:"currentColor"}),g.jsx("path",{d:"M22.0001 12C22.0001 10.7611 21.1663 9.79297 20.0663 9.42632C18.9547 9.05578 17.6171 9.28724 16.4001 10.2C15.9582 10.5314 15.8687 11.1582 16.2001 11.6C16.5314 12.0418 17.1582 12.1314 17.6001 11.8C18.383 11.2128 19.0455 11.1942 19.4338 11.3237C19.8339 11.457 20.0001 11.7389 20.0001 12C20.0001 12.4839 19.8554 12.7379 19.6537 12.9481C19.4275 13.1837 19.1378 13.363 18.7055 13.6307C18.6313 13.6767 18.553 13.7252 18.4701 13.777C17.9572 14.0975 17.3128 14.5261 16.8163 15.2087C16.3007 15.9177 16.0001 16.8183 16.0001 18C16.0001 18.5523 16.4478 19 17.0001 19H21.0001C21.5523 19 22.0001 18.5523 22.0001 18C22.0001 17.4477 21.5523 17 21.0001 17H18.131C18.21 16.742 18.3176 16.5448 18.4338 16.385C18.6873 16.0364 19.0429 15.7775 19.5301 15.473C19.5898 15.4357 19.6536 15.3966 19.7205 15.3556C20.139 15.0992 20.6783 14.7687 21.0964 14.3332C21.6447 13.7621 22.0001 13.0161 22.0001 12Z",fill:"currentColor"})]}));Yf.displayName="HeadingTwoIcon";const Xf=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M4 5C4.55228 5 5 5.44772 5 6V11H11V6C11 5.44772 11.4477 5 12 5C12.5523 5 13 5.44772 13 6V18C13 18.5523 12.5523 19 12 19C11.4477 19 11 18.5523 11 18V13H5V18C5 18.5523 4.55228 19 4 19C3.44772 19 3 18.5523 3 18V6C3 5.44772 3.44772 5 4 5Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.4608 11.2169C19.1135 11.0531 18.5876 11.0204 18.0069 11.3619C17.5309 11.642 16.918 11.4831 16.638 11.007C16.358 10.531 16.5169 9.91809 16.9929 9.63807C18.1123 8.97962 19.3364 8.94691 20.314 9.40808C21.2839 9.86558 21.9999 10.818 21.9999 12C21.9999 12.7957 21.6838 13.5587 21.1212 14.1213C20.5586 14.6839 19.7956 15 18.9999 15C18.4476 15 17.9999 14.5523 17.9999 14C17.9999 13.4477 18.4476 13 18.9999 13C19.2651 13 19.5195 12.8947 19.707 12.7071C19.8946 12.5196 19.9999 12.2652 19.9999 12C19.9999 11.6821 19.8159 11.3844 19.4608 11.2169Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.0001 14C18.0001 13.4477 18.4478 13 19.0001 13C19.7957 13 20.5588 13.3161 21.1214 13.8787C21.684 14.4413 22.0001 15.2043 22.0001 16C22.0001 17.2853 21.2767 18.3971 20.1604 18.8994C19.0257 19.41 17.642 19.2315 16.4001 18.3C15.9582 17.9686 15.8687 17.3418 16.2001 16.9C16.5314 16.4582 17.1582 16.3686 17.6001 16.7C18.3581 17.2685 18.9744 17.24 19.3397 17.0756C19.7234 16.9029 20.0001 16.5147 20.0001 16C20.0001 15.7348 19.8947 15.4804 19.7072 15.2929C19.5196 15.1054 19.2653 15 19.0001 15C18.4478 15 18.0001 14.5523 18.0001 14Z",fill:"currentColor"})]}));Xf.displayName="HeadingThreeIcon";const eh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M4 5C4.55228 5 5 5.44772 5 6V11H11V6C11 5.44772 11.4477 5 12 5C12.5523 5 13 5.44772 13 6V18C13 18.5523 12.5523 19 12 19C11.4477 19 11 18.5523 11 18V13H5V18C5 18.5523 4.55228 19 4 19C3.44772 19 3 18.5523 3 18V6C3 5.44772 3.44772 5 4 5Z",fill:"currentColor"}),g.jsx("path",{d:"M17 9C17.5523 9 18 9.44772 18 10V13H20V10C20 9.44772 20.4477 9 21 9C21.5523 9 22 9.44772 22 10V18C22 18.5523 21.5523 19 21 19C20.4477 19 20 18.5523 20 18V15H17C16.4477 15 16 14.5523 16 14V10C16 9.44772 16.4477 9 17 9Z",fill:"currentColor"})]}));eh.displayName="HeadingFourIcon";const th=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M5 6C5 5.44772 4.55228 5 4 5C3.44772 5 3 5.44772 3 6V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V13H11V18C11 18.5523 11.4477 19 12 19C12.5523 19 13 18.5523 13 18V6C13 5.44772 12.5523 5 12 5C11.4477 5 11 5.44772 11 6V11H5V6Z",fill:"currentColor"}),g.jsx("path",{d:"M16 10C16 9.44772 16.4477 9 17 9H21C21.5523 9 22 9.44772 22 10C22 10.5523 21.5523 11 21 11H18V12H18.3C20.2754 12 22 13.4739 22 15.5C22 17.5261 20.2754 19 18.3 19C17.6457 19 17.0925 18.8643 16.5528 18.5944C16.0588 18.3474 15.8586 17.7468 16.1055 17.2528C16.3525 16.7588 16.9532 16.5586 17.4472 16.8056C17.7074 16.9357 17.9542 17 18.3 17C19.3246 17 20 16.2739 20 15.5C20 14.7261 19.3246 14 18.3 14H17C16.4477 14 16 13.5523 16 13L16 12.9928V10Z",fill:"currentColor"})]}));th.displayName="HeadingFiveIcon";const nh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M5 6C5 5.44772 4.55228 5 4 5C3.44772 5 3 5.44772 3 6V18C3 18.5523 3.44772 19 4 19C4.55228 19 5 18.5523 5 18V13H11V18C11 18.5523 11.4477 19 12 19C12.5523 19 13 18.5523 13 18V6C13 5.44772 12.5523 5 12 5C11.4477 5 11 5.44772 11 6V11H5V6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.7071 9.29289C21.0976 9.68342 21.0976 10.3166 20.7071 10.7071C19.8392 11.575 19.2179 12.2949 18.7889 13.0073C18.8587 13.0025 18.929 13 19 13C20.6569 13 22 14.3431 22 16C22 17.6569 20.6569 19 19 19C17.3431 19 16 17.6569 16 16C16 14.6007 16.2837 13.4368 16.8676 12.3419C17.4384 11.2717 18.2728 10.3129 19.2929 9.29289C19.6834 8.90237 20.3166 8.90237 20.7071 9.29289ZM19 17C18.4477 17 18 16.5523 18 16C18 15.4477 18.4477 15 19 15C19.5523 15 20 15.4477 20 16C20 16.5523 19.5523 17 19 17Z",fill:"currentColor"})]}));nh.displayName="HeadingSixIcon";const rh={1:Qf,2:Yf,3:Xf,4:eh,5:th,6:nh},z4={1:"Ctrl-Alt-1",2:"Ctrl-Alt-2",3:"Ctrl-Alt-3",4:"Ctrl-Alt-4",5:"Ctrl-Alt-5",6:"Ctrl-Alt-6"};function $4(n,e){if(!n)return!1;try{return n.can().toggleNode("heading","paragraph",{level:e})}catch{return!1}}function K4(n,e){return n?n.isActive("heading",{level:e}):!1}function W4(n,e){n&&(n.isActive("heading",{level:e})?n.chain().focus().setNode("paragraph").run():n.chain().focus().toggleNode("heading","paragraph",{level:e}).run())}function U4(n,e,t=!1){return!!(!n||t||!$4(n,e))}function _4(n){const{editor:e,hideWhenUnavailable:t,headingInSchema:r}=n;return!(!r||!e||t&&gt(e.state.selection))}function sh(n){return`Heading ${n}`}function q4(n,e,t=!1){const r=Hr("heading",n),s=U4(n,e,t),i=K4(n,e),o=rh[e],l=z4[e],a=sh(e);return{headingInSchema:r,isDisabled:s,isActive:i,Icon:o,shortcutKey:l,formattedName:a}}const ih=y.forwardRef(({editor:n,level:e,text:t,hideWhenUnavailable:r=!1,className:s="",disabled:i,onClick:o,children:l,...a},c)=>{const u=et(n),{headingInSchema:d,isDisabled:f,isActive:h,Icon:p,shortcutKey:m,formattedName:C}=q4(u,e,i),b=y.useCallback(x=>{o?.(x),!x.defaultPrevented&&!f&&u&&W4(u,e)},[o,f,u,e]);return!y.useMemo(()=>_4({editor:u,hideWhenUnavailable:r,headingInSchema:d}),[u,e,r,d])||!u||!u.isEditable?null:g.jsx(Te,{type:"button",className:s.trim(),disabled:f,"data-style":"ghost","data-active-state":h?"on":"off","data-disabled":f,role:"button",tabIndex:-1,"aria-label":C,"aria-pressed":h,tooltip:C,shortcutKeys:m,onClick:b,...a,ref:c,children:l||g.jsxs(g.Fragment,{children:[g.jsx(p,{className:"tiptap-button-icon"}),t&&g.jsx("span",{className:"tiptap-button-text",children:t})]})})});ih.displayName="HeadingButton";const oh=y.createContext(null);function Yl(){const n=y.useContext(oh);if(!n)throw new Error("DropdownMenu components must be wrapped in <DropdownMenu />");return n}function J4({initialOpen:n=!1,open:e,onOpenChange:t,side:r="bottom",align:s="start"}){const[i,o]=y.useState(n),[l,a]=y.useState(`${r}-${s}`),[c,u]=y.useState(null),d=e??i,f=t??o,h=y.useRef([]),p=y.useRef([]),m=_l({open:d,onOpenChange:f,placement:l,middleware:[rl({mainAxis:4}),sl(),il({padding:4})],whileElementsMounted:ol}),{context:C}=m,b=ql([Kf(C,{event:"mousedown",toggle:!0,ignoreMouse:!1}),Jl(C,{role:"menu"}),Ul(C,{outsidePress:!0,outsidePressEvent:"mousedown"}),C4(C,{listRef:h,activeIndex:c,onNavigate:u,loop:!0}),x4(C,{listRef:p,onMatch:d?u:void 0,activeIndex:c})]),v=y.useCallback((x,w)=>{a(`${x}-${w}`)},[]);return y.useMemo(()=>({open:d,setOpen:f,activeIndex:c,setActiveIndex:u,elementsRef:h,labelsRef:p,updatePosition:v,...b,...m}),[d,f,c,b,m,v])}function lh({children:n,...e}){const t=J4(e);return g.jsx(oh.Provider,{value:t,children:g.jsx(WC,{elementsRef:t.elementsRef,labelsRef:t.labelsRef,children:n})})}const Xl=y.forwardRef(({children:n,asChild:e=!1,...t},r)=>{const s=Yl(),i=y.isValidElement(n)?parseInt(y.version,10)>=19?n.props.ref:n.ref:void 0,o=Rn([s.refs.setReference,r,i]);if(e&&y.isValidElement(n)){const l={"data-state":s.open?"open":"closed"};return y.cloneElement(n,s.getReferenceProps({ref:o,...t,...typeof n.props=="object"?n.props:{},"aria-expanded":s.open,"aria-haspopup":"menu",...l}))}return g.jsx("button",{ref:o,"aria-expanded":s.open,"aria-haspopup":"menu","data-state":s.open?"open":"closed",...s.getReferenceProps(t),children:n})});Xl.displayName="DropdownMenuTrigger";const ea=y.forwardRef(({style:n,className:e,orientation:t="vertical",side:r="bottom",align:s="start",portal:i=!0,portalProps:o={},...l},a)=>{const c=Yl(),u=Rn([c.refs.setFloating,a]);if(y.useEffect(()=>{c.updatePosition(r,s)},[c,r,s]),!c.open)return null;const d=g.jsx($f,{context:c.context,modal:!1,initialFocus:0,returnFocus:!0,children:g.jsx("div",{ref:u,className:`tiptap-dropdown-menu ${e||""}`,style:{position:c.strategy,top:c.y??0,left:c.x??0,outline:"none",...n},"aria-orientation":t,"data-orientation":t,"data-state":c.open?"open":"closed","data-side":r,"data-align":s,...c.getFloatingProps(l),children:l.children})});return i?g.jsx(Wl,{...o,children:d}):d});ea.displayName="DropdownMenuContent";const ta=y.forwardRef(({children:n,disabled:e,asChild:t=!1,onSelect:r,className:s,...i},o)=>{const l=Yl(),a=UC({label:e?null:n?.toString()}),c=l.activeIndex===a.index,u=y.useCallback(f=>{e||(r?.(),i.onClick?.(f),l.setOpen(!1))},[l,e,r,i]),d={ref:Rn([a.ref,o]),role:"menuitem",className:s,tabIndex:c?0:-1,"data-highlighted":c,"aria-disabled":e,...l.getItemProps({...i,onClick:u})};if(t&&y.isValidElement(n)){const f=n.props,h={...d,...typeof n.props=="object"?n.props:{}},p={onClick:m=>{u(m),f.onClick?.(m)}};return y.cloneElement(n,{...h,...p})}return g.jsx("div",{...d,children:n})});ta.displayName="DropdownMenuItem";const na=y.forwardRef(({children:n,label:e,className:t,...r},s)=>g.jsx("div",{...r,ref:s,role:"group","aria-label":e,className:`tiptap-button-group ${t||""}`,children:n}));na.displayName="DropdownMenuGroup";const Z4=y.forwardRef(({className:n,...e},t)=>g.jsx(Gn,{ref:t,className:`tiptap-dropdown-menu-separator ${n||""}`,...e}));Z4.displayName=Gn.displayName;function G4({editor:n,levels:e=[1,2,3,4,5,6],hideWhenUnavailable:t=!1,onOpenChange:r,...s}){const[i,o]=y.useState(!1),l=et(n),a=Hr("heading",l),c=y.useCallback(m=>{o(m),r?.(m)},[r]),u=y.useCallback(()=>{if(!l)return g.jsx(Xo,{className:"tiptap-button-icon"});const m=e.find(b=>l.isActive("heading",{level:b}));if(!m)return g.jsx(Xo,{className:"tiptap-button-icon"});const C=rh[m];return g.jsx(C,{className:"tiptap-button-icon"})},[l,e]),d=y.useCallback(()=>l?e.some(m=>l.can().toggleNode("heading","paragraph",{level:m})):!1,[l,e]),f=!d(),h=l?.isActive("heading")??!1;return!y.useMemo(()=>!(!a||!l||t&&(gt(l.state.selection)||!d())),[a,l,t,d])||!l||!l.isEditable?null:g.jsxs(lh,{open:i,onOpenChange:c,children:[g.jsx(Xl,{asChild:!0,children:g.jsxs(Te,{type:"button",disabled:f,"data-style":"ghost","data-active-state":h?"on":"off","data-disabled":f,role:"button",tabIndex:-1,"aria-label":"Format text as heading","aria-pressed":h,tooltip:"Heading",...s,children:[u(),g.jsx(Ql,{className:"tiptap-button-dropdown-small"})]})}),g.jsx(ea,{children:g.jsx(na,{children:e.map(m=>g.jsx(ta,{asChild:!0,children:g.jsx(ih,{editor:l,level:m,text:sh(m),tooltip:""})},`heading-${m}`))})})]})}const ah=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20 2C20 1.44772 19.5523 1 19 1C18.4477 1 18 1.44772 18 2V4H16C15.4477 4 15 4.44772 15 5C15 5.55228 15.4477 6 16 6H18V8C18 8.55228 18.4477 9 19 9C19.5523 9 20 8.55228 20 8V6H22C22.5523 6 23 5.55228 23 5C23 4.44772 22.5523 4 22 4H20V2ZM5 4C4.73478 4 4.48043 4.10536 4.29289 4.29289C4.10536 4.48043 4 4.73478 4 5V19C4 19.2652 4.10536 19.5196 4.29289 19.7071C4.48043 19.8946 4.73478 20 5 20H5.58579L14.379 11.2068C14.9416 10.6444 15.7045 10.3284 16.5 10.3284C17.2955 10.3284 18.0584 10.6444 18.621 11.2068L20 12.5858V12C20 11.4477 20.4477 11 21 11C21.5523 11 22 11.4477 22 12V14.998C22 14.9994 22 15.0007 22 15.002V19C22 19.7957 21.6839 20.5587 21.1213 21.1213C20.5587 21.6839 19.7957 22 19 22H6.00219C6.00073 22 5.99927 22 5.99781 22H5C4.20435 22 3.44129 21.6839 2.87868 21.1213C2.31607 20.5587 2 19.7957 2 19V5C2 4.20435 2.31607 3.44129 2.87868 2.87868C3.44129 2.31607 4.20435 2 5 2H12C12.5523 2 13 2.44772 13 3C13 3.55228 12.5523 4 12 4H5ZM8.41422 20H19C19.2652 20 19.5196 19.8946 19.7071 19.7071C19.8946 19.5196 20 19.2652 20 19V15.4142L17.207 12.6212C17.0195 12.4338 16.7651 12.3284 16.5 12.3284C16.2349 12.3284 15.9806 12.4337 15.7931 12.6211L8.41422 20ZM6.87868 6.87868C7.44129 6.31607 8.20435 6 9 6C9.79565 6 10.5587 6.31607 11.1213 6.87868C11.6839 7.44129 12 8.20435 12 9C12 9.79565 11.6839 10.5587 11.1213 11.1213C10.5587 11.6839 9.79565 12 9 12C8.20435 12 7.44129 11.6839 6.87868 11.1213C6.31607 10.5587 6 9.79565 6 9C6 8.20435 6.31607 7.44129 6.87868 6.87868ZM9 8C8.73478 8 8.48043 8.10536 8.29289 8.29289C8.10536 8.48043 8 8.73478 8 9C8 9.26522 8.10536 9.51957 8.29289 9.70711C8.48043 9.89464 8.73478 10 9 10C9.26522 10 9.51957 9.89464 9.70711 9.70711C9.89464 9.51957 10 9.26522 10 9C10 8.73478 9.89464 8.48043 9.70711 8.29289C9.51957 8.10536 9.26522 8 9 8Z",fill:"currentColor"})}));ah.displayName="ImagePlusIcon";function Q4(n,e){return n?n.isActive(e):!1}function Y4(n,e){return n?n.chain().focus().insertContent({type:e}).run():!1}function X4(n,e="imageUpload",t=!1){const r=Q4(n,e),s=y.useCallback(()=>t?!1:Y4(n,e),[n,e,t]);return{isActive:r,handleInsertImage:s}}const ch=y.forwardRef(({editor:n,extensionName:e="imageUpload",text:t,className:r="",disabled:s,onClick:i,children:o,...l},a)=>{const c=et(n),{isActive:u,handleInsertImage:d}=X4(c,e,s),f=y.useCallback(h=>{i?.(h),!h.defaultPrevented&&!s&&d()},[i,s,d]);return!c||!c.isEditable?null:g.jsx(Te,{ref:a,type:"button",className:r.trim(),"data-style":"ghost","data-active-state":u?"on":"off",role:"button",tabIndex:-1,"aria-label":"Add image","aria-pressed":u,tooltip:"Add image",onClick:f,...l,children:o||g.jsxs(g.Fragment,{children:[g.jsx(ah,{className:"tiptap-button-icon"}),t&&g.jsx("span",{className:"tiptap-button-text",children:t})]})})});ch.displayName="ImageUploadButton";const Mi=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 6C7 5.44772 7.44772 5 8 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H8C7.44772 7 7 6.55228 7 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 12C7 11.4477 7.44772 11 8 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H8C7.44772 13 7 12.5523 7 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 18C7 17.4477 7.44772 17 8 17H21C21.5523 17 22 17.4477 22 18C22 18.5523 21.5523 19 21 19H8C7.44772 19 7 18.5523 7 18Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 6C2 5.44772 2.44772 5 3 5H3.01C3.56228 5 4.01 5.44772 4.01 6C4.01 6.55228 3.56228 7 3.01 7H3C2.44772 7 2 6.55228 2 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 11.4477 2.44772 11 3 11H3.01C3.56228 11 4.01 11.4477 4.01 12C4.01 12.5523 3.56228 13 3.01 13H3C2.44772 13 2 12.5523 2 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 18C2 17.4477 2.44772 17 3 17H3.01C3.56228 17 4.01 17.4477 4.01 18C4.01 18.5523 3.56228 19 3.01 19H3C2.44772 19 2 18.5523 2 18Z",fill:"currentColor"})]}));Mi.displayName="ListIcon";const uh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 6C9 5.44772 9.44772 5 10 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H10C9.44772 7 9 6.55228 9 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 12C9 11.4477 9.44772 11 10 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H10C9.44772 13 9 12.5523 9 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 18C9 17.4477 9.44772 17 10 17H21C21.5523 17 22 17.4477 22 18C22 18.5523 21.5523 19 21 19H10C9.44772 19 9 18.5523 9 18Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 6C3 5.44772 3.44772 5 4 5H5C5.55228 5 6 5.44772 6 6V10C6 10.5523 5.55228 11 5 11C4.44772 11 4 10.5523 4 10V7C3.44772 7 3 6.55228 3 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 10C3 9.44772 3.44772 9 4 9H6C6.55228 9 7 9.44772 7 10C7 10.5523 6.55228 11 6 11H4C3.44772 11 3 10.5523 3 10Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.82219 13.0431C6.54543 13.4047 6.99997 14.1319 6.99997 15C6.99997 15.5763 6.71806 16.0426 6.48747 16.35C6.31395 16.5814 6.1052 16.8044 5.91309 17H5.99997C6.55226 17 6.99997 17.4477 6.99997 18C6.99997 18.5523 6.55226 19 5.99997 19H3.99997C3.44769 19 2.99997 18.5523 2.99997 18C2.99997 17.4237 3.28189 16.9575 3.51247 16.65C3.74323 16.3424 4.03626 16.0494 4.26965 15.8161C4.27745 15.8083 4.2852 15.8006 4.29287 15.7929C4.55594 15.5298 4.75095 15.3321 4.88748 15.15C4.96287 15.0495 4.99021 14.9922 4.99911 14.9714C4.99535 14.9112 4.9803 14.882 4.9739 14.8715C4.96613 14.8588 4.95382 14.845 4.92776 14.8319C4.87723 14.8067 4.71156 14.7623 4.44719 14.8944C3.95321 15.1414 3.35254 14.9412 3.10555 14.4472C2.85856 13.9533 3.05878 13.3526 3.55276 13.1056C4.28839 12.7378 5.12272 12.6934 5.82219 13.0431Z",fill:"currentColor"})]}));uh.displayName="ListOrderedIcon";const dh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 6C2 4.89543 2.89543 4 4 4H8C9.10457 4 10 4.89543 10 6V10C10 11.1046 9.10457 12 8 12H4C2.89543 12 2 11.1046 2 10V6ZM8 6H4V10H8V6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.70711 14.2929C10.0976 14.6834 10.0976 15.3166 9.70711 15.7071L5.70711 19.7071C5.31658 20.0976 4.68342 20.0976 4.29289 19.7071L2.29289 17.7071C1.90237 17.3166 1.90237 16.6834 2.29289 16.2929C2.68342 15.9024 3.31658 15.9024 3.70711 16.2929L5 17.5858L8.29289 14.2929C8.68342 13.9024 9.31658 13.9024 9.70711 14.2929Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 6C12 5.44772 12.4477 5 13 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H13C12.4477 7 12 6.55228 12 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 12C12 11.4477 12.4477 11 13 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H13C12.4477 13 12 12.5523 12 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 18C12 17.4477 12.4477 17 13 17H21C21.5523 17 22 17.4477 22 18C22 18.5523 21.5523 19 21 19H13C12.4477 19 12 18.5523 12 18Z",fill:"currentColor"})]}));dh.displayName="ListTodoIcon";const fh=[{label:"Bullet List",type:"bulletList",icon:Mi},{label:"Ordered List",type:"orderedList",icon:uh},{label:"Task List",type:"taskList",icon:dh}],eb={bulletList:"Ctrl-Shift-8",orderedList:"Ctrl-Shift-7",taskList:"Ctrl-Shift-9"};function hh(n,e){if(!n)return!1;switch(e){case"bulletList":return n.can().toggleBulletList();case"orderedList":return n.can().toggleOrderedList();case"taskList":return n.can().toggleList("taskList","taskItem");default:return!1}}function ra(n,e){if(!n)return!1;switch(e){case"bulletList":return n.isActive("bulletList");case"orderedList":return n.isActive("orderedList");case"taskList":return n.isActive("taskList");default:return!1}}function tb(n,e){if(n)switch(e){case"bulletList":n.chain().focus().toggleBulletList().run();break;case"orderedList":n.chain().focus().toggleOrderedList().run();break;case"taskList":n.chain().focus().toggleList("taskList","taskItem").run();break}}function nb(n){return fh.find(e=>e.type===n)}function rb(n){const{editor:e,type:t,hideWhenUnavailable:r,listInSchema:s}=n;return!(!s||!e||r&&(gt(e.state.selection)||!hh(e,t)))}function sb(n,e){const t=Hr(e,n),r=nb(e),s=ra(n,e),i=eb[e];return{listInSchema:t,listOption:r,isActive:s,shortcutKey:i}}const ph=y.forwardRef(({editor:n,type:e,hideWhenUnavailable:t=!1,className:r="",onClick:s,text:i,children:o,...l},a)=>{const c=et(n),{listInSchema:u,listOption:d,isActive:f,shortcutKey:h}=sb(c,e),p=d?.icon||Mi,m=y.useCallback(b=>{s?.(b),!b.defaultPrevented&&c&&tb(c,e)},[s,c,e]);return!y.useMemo(()=>rb({editor:c,type:e,hideWhenUnavailable:t,listInSchema:u}),[c,e,t,u])||!c||!c.isEditable?null:g.jsx(Te,{type:"button",className:r.trim(),"data-style":"ghost","data-active-state":f?"on":"off",role:"button",tabIndex:-1,"aria-label":d?.label||e,"aria-pressed":f,tooltip:d?.label||e,shortcutKeys:h,onClick:m,...l,ref:a,children:o||g.jsxs(g.Fragment,{children:[g.jsx(p,{className:"tiptap-button-icon"}),i&&g.jsx("span",{className:"tiptap-button-text",children:i})]})})});ph.displayName="ListButton";function ib(n,e){return n?e.some(t=>hh(n,t)):!1}function ob(n,e){return n?e.some(t=>ra(n,t)):!1}function lb(n){return fh.filter(e=>!e.type||n.includes(e.type))}function ab(n){const{editor:e,hideWhenUnavailable:t,listInSchema:r,canToggleAny:s}=n;return!(!r||!e||t&&(gt(e.state.selection)||!s))}function cb(n,e){const[t,r]=y.useState(!1),s=e.some(c=>Hr(c,n)),i=y.useMemo(()=>lb(e),[e]),o=ib(n,e),l=ob(n,e),a=y.useCallback((c,u)=>{r(c),u?.(c)},[]);return{isOpen:t,setIsOpen:r,listInSchema:s,filteredLists:i,canToggleAny:o,isAnyActive:l,handleOpenChange:a}}function ub(n,e){return y.useCallback(()=>{const t=e.find(r=>ra(n,r.type));return t?g.jsx(t.icon,{className:"tiptap-button-icon"}):g.jsx(Mi,{className:"tiptap-button-icon"})},[n,e])}function db({editor:n,types:e=["bulletList","orderedList","taskList"],hideWhenUnavailable:t=!1,onOpenChange:r,...s}){const i=et(n),{isOpen:o,listInSchema:l,filteredLists:a,canToggleAny:c,isAnyActive:u,handleOpenChange:d}=cb(i,e),f=ub(i,a),h=y.useMemo(()=>ab({editor:i,hideWhenUnavailable:t,listInSchema:l,canToggleAny:c}),[i,e,t,l,c]),p=y.useCallback(m=>d(m,r),[d,r]);return!h||!i||!i.isEditable?null:g.jsxs(lh,{open:o,onOpenChange:p,children:[g.jsx(Xl,{asChild:!0,children:g.jsxs(Te,{type:"button","data-style":"ghost","data-active-state":u?"on":"off",role:"button",tabIndex:-1,"aria-label":"List options",tooltip:"List",...s,children:[f(),g.jsx(Ql,{className:"tiptap-button-dropdown-small"})]})}),g.jsx(ea,{children:g.jsx(na,{children:a.map(m=>g.jsx(ta,{asChild:!0,children:g.jsx(ph,{editor:i,type:m.type,text:m.label,hideWhenUnavailable:t,tooltip:""})},m.type))})})]})}const mh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 6C8 5.44772 8.44772 5 9 5H16C16.5523 5 17 5.44772 17 6C17 6.55228 16.5523 7 16 7H9C8.44772 7 8 6.55228 8 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 3C4.55228 3 5 3.44772 5 4L5 20C5 20.5523 4.55229 21 4 21C3.44772 21 3 20.5523 3 20L3 4C3 3.44772 3.44772 3 4 3Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 12C8 11.4477 8.44772 11 9 11H20C20.5523 11 21 11.4477 21 12C21 12.5523 20.5523 13 20 13H9C8.44772 13 8 12.5523 8 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 18C8 17.4477 8.44772 17 9 17H16C16.5523 17 17 17.4477 17 18C17 18.5523 16.5523 19 16 19H9C8.44772 19 8 18.5523 8 18Z",fill:"currentColor"})]}));mh.displayName="BlockQuoteIcon";const gh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.70711 2.29289C7.09763 2.68342 7.09763 3.31658 6.70711 3.70711L4.41421 6L6.70711 8.29289C7.09763 8.68342 7.09763 9.31658 6.70711 9.70711C6.31658 10.0976 5.68342 10.0976 5.29289 9.70711L2.29289 6.70711C1.90237 6.31658 1.90237 5.68342 2.29289 5.29289L5.29289 2.29289C5.68342 1.90237 6.31658 1.90237 6.70711 2.29289Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.2929 2.29289C10.6834 1.90237 11.3166 1.90237 11.7071 2.29289L14.7071 5.29289C15.0976 5.68342 15.0976 6.31658 14.7071 6.70711L11.7071 9.70711C11.3166 10.0976 10.6834 10.0976 10.2929 9.70711C9.90237 9.31658 9.90237 8.68342 10.2929 8.29289L12.5858 6L10.2929 3.70711C9.90237 3.31658 9.90237 2.68342 10.2929 2.29289Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 4C17 3.44772 17.4477 3 18 3H19C20.6569 3 22 4.34315 22 6V18C22 19.6569 20.6569 21 19 21H5C3.34315 21 2 19.6569 2 18V12C2 11.4477 2.44772 11 3 11C3.55228 11 4 11.4477 4 12V18C4 18.5523 4.44772 19 5 19H19C19.5523 19 20 18.5523 20 18V6C20 5.44772 19.5523 5 19 5H18C17.4477 5 17 4.55228 17 4Z",fill:"currentColor"})]}));gh.displayName="CodeBlockIcon";const fb={codeBlock:gh,blockquote:mh},hb={codeBlock:"Ctrl-Alt-c",blockquote:"Ctrl-Shift-b"},pb={codeBlock:"Code Block",blockquote:"Blockquote"};function mb(n,e){if(!n)return!1;try{return e==="codeBlock"?n.can().toggleNode("codeBlock","paragraph"):n.can().toggleWrap("blockquote")}catch{return!1}}function gb(n,e){return n?n.isActive(e):!1}function yb(n,e){return n?e==="codeBlock"?n.chain().focus().toggleNode("codeBlock","paragraph").run():n.chain().focus().toggleWrap("blockquote").run():!1}function Cb(n,e,t=!1){return!!(!n||t||!e)}function bb(n){const{editor:e,hideWhenUnavailable:t,nodeInSchema:r,canToggle:s}=n;return!r||!e||t&&(gt(e.state.selection)||!s)?!1:!!e?.isEditable}function xb(n,e,t=!1,r=!1){const s=Hr(e,n),i=mb(n,e),o=Cb(n,i,t),l=gb(n,e),a=y.useMemo(()=>bb({editor:n,hideWhenUnavailable:r,nodeInSchema:s,canToggle:i}),[n,e,r,s,i]),c=y.useCallback(()=>!o&&n?yb(n,e):!1,[n,e,o]),u=fb[e],d=hb[e],f=pb[e];return{nodeInSchema:s,canToggle:i,isDisabled:o,isActive:l,shouldShow:a,handleToggle:c,Icon:u,shortcutKey:d,label:f}}const tl=y.forwardRef(({editor:n,type:e,text:t,hideWhenUnavailable:r=!1,className:s="",disabled:i,onClick:o,children:l,...a},c)=>{const u=et(n),{isDisabled:d,isActive:f,shouldShow:h,handleToggle:p,Icon:m,shortcutKey:C,label:b}=xb(u,e,i,r),v=y.useCallback(x=>{o?.(x),!x.defaultPrevented&&!d&&p()},[o,d,p]);return!h||!u||!u.isEditable?null:g.jsx(Te,{type:"button",className:s.trim(),disabled:d,"data-style":"ghost","data-active-state":f?"on":"off","data-disabled":d,role:"button",tabIndex:-1,"aria-label":e,"aria-pressed":f,tooltip:b,shortcutKeys:C,onClick:v,...a,ref:c,children:l||g.jsxs(g.Fragment,{children:[g.jsx(m,{className:"tiptap-button-icon"}),t&&g.jsx("span",{className:"tiptap-button-text",children:t})]})})});tl.displayName="NodeButton";function vb({editor:n,containerRef:e,query:t,items:r,onSelect:s,onClose:i,orientation:o="vertical",autoSelectFirstItem:l=!0}){const[a,c]=y.useState(l?0:-1);return y.useEffect(()=>{const u=f=>{if(!r.length)return!1;const h=()=>c(m=>m===-1?0:(m+1)%r.length),p=()=>c(m=>m===-1?r.length-1:(m-1+r.length)%r.length);switch(f.key){case"ArrowUp":return o==="horizontal"?!1:(f.preventDefault(),p(),!0);case"ArrowDown":return o==="horizontal"?!1:(f.preventDefault(),h(),!0);case"ArrowLeft":return o==="vertical"?!1:(f.preventDefault(),p(),!0);case"ArrowRight":return o==="vertical"?!1:(f.preventDefault(),h(),!0);case"Tab":return f.preventDefault(),f.shiftKey?p():h(),!0;case"Home":return f.preventDefault(),c(0),!0;case"End":return f.preventDefault(),c(r.length-1),!0;case"Enter":return f.isComposing?!1:(f.preventDefault(),a!==-1&&r[a]&&s?.(r[a]),!0);case"Escape":return f.preventDefault(),i?.(),!0;default:return!1}};let d=null;if(n?d=n.view.dom:e?.current&&(d=e.current),d)return d.addEventListener("keydown",u,!0),()=>{d?.removeEventListener("keydown",u,!0)}},[n,e,r,a,s,i,o]),y.useEffect(()=>{t&&c(l?0:-1)},[t,l]),{selectedIndex:r.length?a:void 0,setSelectedIndex:c}}const yh=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.43471 4.01458C4.34773 4.06032 4.26607 4.11977 4.19292 4.19292C4.11977 4.26607 4.06032 4.34773 4.01458 4.43471C2.14611 6.40628 1 9.0693 1 12C1 18.0751 5.92487 23 12 23C14.9306 23 17.5936 21.854 19.5651 19.9856C19.6522 19.9398 19.7339 19.8803 19.8071 19.8071C19.8803 19.7339 19.9398 19.6522 19.9856 19.5651C21.854 17.5936 23 14.9306 23 12C23 5.92487 18.0751 1 12 1C9.0693 1 6.40628 2.14611 4.43471 4.01458ZM6.38231 4.9681C7.92199 3.73647 9.87499 3 12 3C16.9706 3 21 7.02944 21 12C21 14.125 20.2635 16.078 19.0319 17.6177L6.38231 4.9681ZM17.6177 19.0319C16.078 20.2635 14.125 21 12 21C7.02944 21 3 16.9706 3 12C3 9.87499 3.73647 7.92199 4.9681 6.38231L17.6177 19.0319Z",fill:"currentColor"})}));yh.displayName="BanIcon";const sa=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.7072 4.70711C15.0977 4.31658 15.0977 3.68342 14.7072 3.29289C14.3167 2.90237 13.6835 2.90237 13.293 3.29289L8.69294 7.89286L8.68594 7.9C8.13626 8.46079 7.82837 9.21474 7.82837 10C7.82837 10.2306 7.85491 10.4584 7.90631 10.6795L2.29289 16.2929C2.10536 16.4804 2 16.7348 2 17V20C2 20.5523 2.44772 21 3 21H12C12.2652 21 12.5196 20.8946 12.7071 20.7071L15.3205 18.0937C15.5416 18.1452 15.7695 18.1717 16.0001 18.1717C16.7853 18.1717 17.5393 17.8639 18.1001 17.3142L22.7072 12.7071C23.0977 12.3166 23.0977 11.6834 22.7072 11.2929C22.3167 10.9024 21.6835 10.9024 21.293 11.2929L16.6971 15.8887C16.5105 16.0702 16.2605 16.1717 16.0001 16.1717C15.7397 16.1717 15.4897 16.0702 15.303 15.8887L10.1113 10.697C9.92992 10.5104 9.82837 10.2604 9.82837 10C9.82837 9.73963 9.92992 9.48958 10.1113 9.30297L14.7072 4.70711ZM13.5858 17L9.00004 12.4142L4 17.4142V19H11.5858L13.5858 17Z",fill:"currentColor"})}));sa.displayName="HighlighterIcon";const Ch=y.createContext(null);function bh(){const n=y.useContext(Ch);if(!n)throw new Error("Popover components must be wrapped in <Popover />");return n}function kb({initialOpen:n=!1,modal:e,open:t,onOpenChange:r,side:s="bottom",align:i="center"}={}){const[o,l]=y.useState(n),[a,c]=y.useState(),[u,d]=y.useState(),[f,h]=y.useState(`${s}-${i}`),p=t??o,m=r??l,C=y.useMemo(()=>[rl(4),sl({fallbackAxisSideDirection:"end",crossAxis:!1}),il({limiter:ep({offset:4})})],[]),b=_l({placement:f,open:p,onOpenChange:m,whileElementsMounted:ol,middleware:C}),v=ql([Kf(b.context),Ul(b.context),Jl(b.context)]),x=y.useCallback((w,M)=>{h(`${w}-${M}`)},[]);return y.useMemo(()=>({open:p,setOpen:m,...v,...b,modal:e,labelId:a,descriptionId:u,setLabelId:c,setDescriptionId:d,updatePosition:x}),[p,m,v,b,e,a,u,x])}function xh({children:n,modal:e=!1,...t}){const r=kb({modal:e,...t});return g.jsx(Ch.Provider,{value:r,children:n})}const ia=y.forwardRef(function({children:e,asChild:t=!1,...r},s){const i=bh(),o=y.isValidElement(e)?parseInt(y.version,10)>=19?e.props.ref:e.ref:void 0,l=Rn([i.refs.setReference,s,o]);return t&&y.isValidElement(e)?y.cloneElement(e,i.getReferenceProps({ref:l,...r,...e.props,"data-state":i.open?"open":"closed"})):g.jsx("button",{ref:l,"data-state":i.open?"open":"closed",...i.getReferenceProps(r),children:e})}),oa=y.forwardRef(function({className:e,side:t="bottom",align:r="center",style:s,portal:i=!0,portalProps:o={},...l},a){const c=bh(),u=Rn([c.refs.setFloating,a]);if(y.useEffect(()=>{c.updatePosition(t,r)},[c,t,r]),!c.context.open)return null;const d=g.jsx($f,{context:c.context,modal:c.modal,children:g.jsx("div",{ref:u,style:{position:c.strategy,top:c.y??0,left:c.x??0,...s},"aria-labelledby":c.labelId,"aria-describedby":c.descriptionId,className:`tiptap-popover ${e||""}`,"data-side":t,"data-align":r,"data-state":c.context.open?"open":"closed",...c.getFloatingProps(l),children:l.children})});return i?g.jsx(Wl,{...o,children:d}):d});ia.displayName="PopoverTrigger";oa.displayName="PopoverContent";function la(n){if(!n)return!1;try{return n.can().setMark("highlight")}catch{return!1}}function wb(n,e){return n?n.isActive("highlight",{color:e}):!1}function Sb(n,e,t,r){if(n)try{const s=n.chain().focus();if(H4(t))s.toggleMark("highlight",{color:e}).run();else if(r!=null&&r!==-1)s.setNodeSelection(r).toggleMark("highlight",{color:e}).run();else if(t){const i=F4({editor:n,node:t});i?s.setNodeSelection(i.pos).toggleMark("highlight",{color:e}).run():s.toggleMark("highlight",{color:e}).run()}else s.toggleMark("highlight",{color:e}).run();n.chain().setMeta("hideDragHandle",!0).run()}catch(s){console.error("Failed to apply highlight:",s)}}function Mb(n,e=!1){return!n||e?!0:n.isActive("code")||n.isActive("codeBlock")||n.isActive("imageUpload")||!la(n)}function Eb(n,e,t){return!(!t||!n||e&&(gt(n.state.selection)||!la(n)))}function Tb(n,e,t=!1,r=!1){const s=Si("highlight",n),i=Mb(n,t),o=wb(n,e),l=y.useMemo(()=>Eb(n,r,s),[n,r,s]);return{highlightInSchema:s,isDisabled:i,isActive:o,shouldShow:l}}const vh=y.forwardRef(({editor:n,node:e,nodePos:t,color:r,text:s,hideWhenUnavailable:i=!1,className:o="",disabled:l,onClick:a,onApplied:c,children:u,style:d,...f},h)=>{const p=et(n),{isDisabled:m,isActive:C,shouldShow:b}=Tb(p,r,l,i),v=y.useCallback(w=>{a?.(w),!w.defaultPrevented&&!m&&p&&(Sb(p,r,e,t),c?.(r))},[r,p,m,e,t,a,c]),x=y.useMemo(()=>({...d,"--highlight-color":r}),[r,d]);return!b||!p||!p.isEditable?null:g.jsx(Te,{type:"button",className:o.trim(),disabled:m,"data-style":"ghost","data-active-state":C?"on":"off","data-disabled":m,role:"button",tabIndex:-1,"aria-label":`${r} highlight color`,"aria-pressed":C,onClick:v,style:x,...f,ref:h,children:u||g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"tiptap-button-highlight",style:{"--highlight-color":r}}),s&&g.jsx("span",{className:"tiptap-button-text",children:s})]})})});vh.displayName="HighlightButton";const kh=[{label:"Green",value:"var(--tt-highlight-green)",border:"var(--tt-highlight-green-contrast)"},{label:"Blue",value:"var(--tt-highlight-blue)",border:"var(--tt-highlight-blue-contrast)"},{label:"Red",value:"var(--tt-highlight-red)",border:"var(--tt-highlight-red-contrast)"},{label:"Purple",value:"var(--tt-highlight-purple)",border:"var(--tt-highlight-purple-contrast)"},{label:"Yellow",value:"var(--tt-highlight-yellow)",border:"var(--tt-highlight-yellow-contrast)"}],aa=y.forwardRef(({className:n,children:e,...t},r)=>g.jsx(Te,{type:"button",className:n,"data-style":"ghost","data-appearance":"default",role:"button",tabIndex:-1,"aria-label":"Highlight text",tooltip:"Highlight",ref:r,...t,children:e||g.jsx(sa,{className:"tiptap-button-icon"})}));aa.displayName="HighlighterButton";function wh({editor:n,colors:e=kh,onClose:t}){const r=et(n),s=y.useRef(null),i=y.useCallback(()=>{r&&(r.chain().focus().unsetMark("highlight").run(),t?.())},[r,t]),o=y.useMemo(()=>[...e,{label:"Remove highlight",value:"none"}],[e]),{selectedIndex:l}=vb({containerRef:s,items:o,orientation:"both",onSelect:a=>{a.value==="none"&&i(),t?.()},onClose:t,autoSelectFirstItem:!1});return g.jsxs("div",{ref:s,className:"tiptap-highlight-content",tabIndex:0,children:[g.jsx("div",{className:"tiptap-button-group","data-orientation":"horizontal",children:e.map((a,c)=>g.jsx(vh,{editor:r,color:a.value,"aria-label":`${a.label} highlight color`,tabIndex:c===l?0:-1,"data-highlighted":l===c,onClick:t},a.value))}),g.jsx(Gn,{}),g.jsx("div",{className:"tiptap-button-group",children:g.jsx(Te,{onClick:i,"aria-label":"Remove highlight",tabIndex:l===e.length?0:-1,type:"button",role:"menuitem","data-style":"ghost","data-highlighted":l===e.length,children:g.jsx(yh,{className:"tiptap-button-icon"})})})]})}function Ab({editor:n,colors:e=kh,hideWhenUnavailable:t=!1,...r}){const s=et(n),[i,o]=y.useState(!1),[l,a]=y.useState(!1),c=Si("highlight",s);y.useEffect(()=>{if(!s)return;const f=()=>{let h=!1;(!c||!s)&&(h=!0),(s.isActive("code")||s.isActive("codeBlock")||s.isActive("imageUpload"))&&(h=!0),a(h)};return s.on("selectionUpdate",f),s.on("update",f),()=>{s.off("selectionUpdate",f),s.off("update",f)}},[s,c]);const u=s?.isActive("highlight")??!1;return!y.useMemo(()=>!t||!s?!0:!(gt(s.state.selection)||!la(s)),[t,s])||!s||!s.isEditable?null:g.jsxs(xh,{open:i,onOpenChange:o,children:[g.jsx(ia,{asChild:!0,children:g.jsx(aa,{disabled:l,"data-active-state":u?"on":"off","data-disabled":l,"aria-pressed":u,...r})}),g.jsx(oa,{"aria-label":"Highlight colors",children:g.jsx(wh,{editor:s,colors:e,onClose:()=>o(!1)})})]})}const Sh=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 4C21 3.44772 20.5523 3 20 3C19.4477 3 19 3.44772 19 4V11C19 11.7956 18.6839 12.5587 18.1213 13.1213C17.5587 13.6839 16.7956 14 16 14H6.41421L9.70711 10.7071C10.0976 10.3166 10.0976 9.68342 9.70711 9.29289C9.31658 8.90237 8.68342 8.90237 8.29289 9.29289L3.29289 14.2929C2.90237 14.6834 2.90237 15.3166 3.29289 15.7071L8.29289 20.7071C8.68342 21.0976 9.31658 21.0976 9.70711 20.7071C10.0976 20.3166 10.0976 19.6834 9.70711 19.2929L6.41421 16H16C17.3261 16 18.5979 15.4732 19.5355 14.5355C20.4732 13.5979 21 12.3261 21 11V4Z",fill:"currentColor"})}));Sh.displayName="CornerDownLeftIcon";const Mh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M14 3C14 2.44772 14.4477 2 15 2H21C21.5523 2 22 2.44772 22 3V9C22 9.55228 21.5523 10 21 10C20.4477 10 20 9.55228 20 9V5.41421L10.7071 14.7071C10.3166 15.0976 9.68342 15.0976 9.29289 14.7071C8.90237 14.3166 8.90237 13.6834 9.29289 13.2929L18.5858 4H15C14.4477 4 14 3.55228 14 3Z",fill:"currentColor"}),g.jsx("path",{d:"M4.29289 7.29289C4.48043 7.10536 4.73478 7 5 7H11C11.5523 7 12 6.55228 12 6C12 5.44772 11.5523 5 11 5H5C4.20435 5 3.44129 5.31607 2.87868 5.87868C2.31607 6.44129 2 7.20435 2 8V19C2 19.7957 2.31607 20.5587 2.87868 21.1213C3.44129 21.6839 4.20435 22 5 22H16C16.7957 22 17.5587 21.6839 18.1213 21.1213C18.6839 20.5587 19 19.7957 19 19V13C19 12.4477 18.5523 12 18 12C17.4477 12 17 12.4477 17 13V19C17 19.2652 16.8946 19.5196 16.7071 19.7071C16.5196 19.8946 16.2652 20 16 20H5C4.73478 20 4.48043 19.8946 4.29289 19.7071C4.10536 19.5196 4 19.2652 4 19V8C4 7.73478 4.10536 7.48043 4.29289 7.29289Z",fill:"currentColor"})]}));Mh.displayName="ExternalLinkIcon";const ca=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M16.9958 1.06669C15.4226 1.05302 13.907 1.65779 12.7753 2.75074L12.765 2.76086L11.045 4.47086C10.6534 4.86024 10.6515 5.49341 11.0409 5.88507C11.4303 6.27673 12.0634 6.27858 12.4551 5.88919L14.1697 4.18456C14.9236 3.45893 15.9319 3.05752 16.9784 3.06662C18.0272 3.07573 19.0304 3.49641 19.772 4.23804C20.5137 4.97967 20.9344 5.98292 20.9435 7.03171C20.9526 8.07776 20.5515 9.08563 19.8265 9.83941L16.833 12.8329C16.4274 13.2386 15.9393 13.5524 15.4019 13.7529C14.8645 13.9533 14.2903 14.0359 13.7181 13.9949C13.146 13.9539 12.5894 13.7904 12.0861 13.5154C11.5827 13.2404 11.1444 12.8604 10.8008 12.401C10.47 11.9588 9.84333 11.8685 9.40108 12.1993C8.95883 12.5301 8.86849 13.1568 9.1993 13.599C9.71464 14.288 10.3721 14.858 11.1272 15.2705C11.8822 15.683 12.7171 15.9283 13.5753 15.9898C14.4334 16.0513 15.2948 15.9274 16.1009 15.6267C16.907 15.326 17.639 14.8555 18.2473 14.247L21.2472 11.2471L21.2593 11.2347C22.3523 10.1031 22.9571 8.58751 22.9434 7.01433C22.9297 5.44115 22.2987 3.93628 21.1863 2.82383C20.0738 1.71138 18.5689 1.08036 16.9958 1.06669Z",fill:"currentColor"}),g.jsx("path",{d:"M10.4247 8.0102C9.56657 7.94874 8.70522 8.07256 7.89911 8.37326C7.09305 8.67395 6.36096 9.14458 5.75272 9.753L2.75285 12.7529L2.74067 12.7653C1.64772 13.8969 1.04295 15.4125 1.05662 16.9857C1.07029 18.5589 1.70131 20.0637 2.81376 21.1762C3.9262 22.2886 5.43108 22.9196 7.00426 22.9333C8.57744 22.947 10.0931 22.3422 11.2247 21.2493L11.2371 21.2371L12.9471 19.5271C13.3376 19.1366 13.3376 18.5034 12.9471 18.1129C12.5565 17.7223 11.9234 17.7223 11.5328 18.1129L9.82932 19.8164C9.07555 20.5414 8.06768 20.9425 7.02164 20.9334C5.97285 20.9243 4.9696 20.5036 4.22797 19.762C3.48634 19.0203 3.06566 18.0171 3.05655 16.9683C3.04746 15.9222 3.44851 14.9144 4.17355 14.1606L7.16719 11.167C7.5727 10.7613 8.06071 10.4476 8.59811 10.2471C9.13552 10.0467 9.70976 9.96412 10.2819 10.0051C10.854 10.0461 11.4106 10.2096 11.9139 10.4846C12.4173 10.7596 12.8556 11.1397 13.1992 11.599C13.53 12.0412 14.1567 12.1316 14.5989 11.8007C15.0412 11.4699 15.1315 10.8433 14.8007 10.401C14.2854 9.71205 13.6279 9.14198 12.8729 8.72948C12.1178 8.31697 11.2829 8.07166 10.4247 8.0102Z",fill:"currentColor"})]}));ca.displayName="LinkIcon";const Eh=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 5V4C7 3.17477 7.40255 2.43324 7.91789 1.91789C8.43324 1.40255 9.17477 1 10 1H14C14.8252 1 15.5668 1.40255 16.0821 1.91789C16.5975 2.43324 17 3.17477 17 4V5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H20V20C20 20.8252 19.5975 21.5668 19.0821 22.0821C18.5668 22.5975 17.8252 23 17 23H7C6.17477 23 5.43324 22.5975 4.91789 22.0821C4.40255 21.5668 4 20.8252 4 20V7H3C2.44772 7 2 6.55228 2 6C2 5.44772 2.44772 5 3 5H7ZM9 4C9 3.82523 9.09745 3.56676 9.33211 3.33211C9.56676 3.09745 9.82523 3 10 3H14C14.1748 3 14.4332 3.09745 14.6679 3.33211C14.9025 3.56676 15 3.82523 15 4V5H9V4ZM6 7V20C6 20.1748 6.09745 20.4332 6.33211 20.6679C6.56676 20.9025 6.82523 21 7 21H17C17.1748 21 17.4332 20.9025 17.6679 20.6679C17.9025 20.4332 18 20.1748 18 20V7H6Z",fill:"currentColor"})}));Eh.displayName="TrashIcon";const Th=n=>{const{editor:e,onSetLink:t,onLinkActive:r}=n,[s,i]=y.useState("");y.useEffect(()=>{if(!e)return;const{href:a}=e.getAttributes("link");e.isActive("link")&&!s&&(i(a||""),r?.())},[e,r,s]),y.useEffect(()=>{if(!e)return;const a=()=>{const{href:c}=e.getAttributes("link");i(c||""),e.isActive("link")&&!s&&r?.()};return e.on("selectionUpdate",a),()=>{e.off("selectionUpdate",a)}},[e,r,s]);const o=y.useCallback(()=>{if(!s||!e)return;const{from:a,to:c}=e.state.selection,u=e.state.doc.textBetween(a,c);e.chain().focus().extendMarkRange("link").insertContent({type:"text",text:u||s,marks:[{type:"link",attrs:{href:s}}]}).run(),t?.()},[e,t,s]),l=y.useCallback(()=>{e&&(e.chain().focus().unsetMark("link",{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),i(""))},[e]);return{url:s,setUrl:i,setLink:o,removeLink:l,isActive:e?.isActive("link")||!1}},ua=y.forwardRef(({className:n,children:e,...t},r)=>g.jsx(Te,{type:"button",className:n,"data-style":"ghost",role:"button",tabIndex:-1,"aria-label":"Link",tooltip:"Link",ref:r,...t,children:e||g.jsx(ca,{className:"tiptap-button-icon"})})),Rb=({editor:n})=>{const e=et(n),t=Th({editor:e});return g.jsx(Ah,{...t})},Ah=({url:n,setUrl:e,setLink:t,removeLink:r,isActive:s})=>{const i=o=>{o.key==="Enter"&&(o.preventDefault(),t())};return g.jsxs(g.Fragment,{children:[g.jsx("input",{type:"url",placeholder:"Paste a link...",value:n,onChange:o=>e(o.target.value),onKeyDown:i,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",className:"tiptap-input tiptap-input-clamp"}),g.jsx("div",{className:"tiptap-button-group","data-orientation":"horizontal",children:g.jsx(Te,{type:"button",onClick:t,title:"Apply link",disabled:!n&&!s,"data-style":"ghost",children:g.jsx(Sh,{className:"tiptap-button-icon"})})}),g.jsx(Gn,{}),g.jsxs("div",{className:"tiptap-button-group","data-orientation":"horizontal",children:[g.jsx(Te,{type:"button",onClick:()=>window.open(n,"_blank"),title:"Open in new window",disabled:!n&&!s,"data-style":"ghost",children:g.jsx(Mh,{className:"tiptap-button-icon"})}),g.jsx(Te,{type:"button",onClick:r,title:"Remove link",disabled:!n&&!s,"data-style":"ghost",children:g.jsx(Eh,{className:"tiptap-button-icon"})})]})]})};function Nb({editor:n,hideWhenUnavailable:e=!1,onOpenChange:t,autoOpenOnLinkActive:r=!0,...s}){const i=et(n),o=Si("link",i),[l,a]=y.useState(!1),d=Th({editor:i,onSetLink:()=>{a(!1)},onLinkActive:()=>a(r)}),f=y.useMemo(()=>!i||i.isActive("codeBlock")?!0:!i.can().setLink?.({href:""}),[i]),h=y.useMemo(()=>{if(!i)return!1;try{return i.can().setMark("link")}catch{return!1}},[i]),p=i?.isActive("link")??!1,m=y.useCallback(b=>{a(b),t?.(b)},[t]);return!y.useMemo(()=>!(!o||!i||e&&(gt(i.state.selection)||!h)),[o,e,i,h])||!i||!i.isEditable?null:g.jsxs(xh,{open:l,onOpenChange:m,children:[g.jsx(ia,{asChild:!0,children:g.jsx(ua,{disabled:f,"data-active-state":p?"on":"off","data-disabled":f,...s})}),g.jsx(oa,{children:g.jsx(Ah,{...d})})]})}ua.displayName="LinkButton";const Rh=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 2.5C5.17157 2.5 4.5 3.17157 4.5 4V20C4.5 20.8284 5.17157 21.5 6 21.5H15C16.4587 21.5 17.8576 20.9205 18.8891 19.8891C19.9205 18.8576 20.5 17.4587 20.5 16C20.5 14.5413 19.9205 13.1424 18.8891 12.1109C18.6781 11.9 18.4518 11.7079 18.2128 11.5359C19.041 10.5492 19.5 9.29829 19.5 8C19.5 6.54131 18.9205 5.14236 17.8891 4.11091C16.8576 3.07946 15.4587 2.5 14 2.5H6ZM14 10.5C14.663 10.5 15.2989 10.2366 15.7678 9.76777C16.2366 9.29893 16.5 8.66304 16.5 8C16.5 7.33696 16.2366 6.70107 15.7678 6.23223C15.2989 5.76339 14.663 5.5 14 5.5H7.5V10.5H14ZM7.5 18.5V13.5H15C15.663 13.5 16.2989 13.7634 16.7678 14.2322C17.2366 14.7011 17.5 15.337 17.5 16C17.5 16.663 17.2366 17.2989 16.7678 17.7678C16.2989 18.2366 15.663 18.5 15 18.5H7.5Z",fill:"currentColor"})}));Rh.displayName="BoldIcon";const Nh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M15.4545 4.2983C15.6192 3.77115 15.3254 3.21028 14.7983 3.04554C14.2712 2.88081 13.7103 3.1746 13.5455 3.70175L8.54554 19.7017C8.38081 20.2289 8.6746 20.7898 9.20175 20.9545C9.72889 21.1192 10.2898 20.8254 10.4545 20.2983L15.4545 4.2983Z",fill:"currentColor"}),g.jsx("path",{d:"M6.70711 7.29289C7.09763 7.68342 7.09763 8.31658 6.70711 8.70711L3.41421 12L6.70711 15.2929C7.09763 15.6834 7.09763 16.3166 6.70711 16.7071C6.31658 17.0976 5.68342 17.0976 5.29289 16.7071L1.29289 12.7071C0.902369 12.3166 0.902369 11.6834 1.29289 11.2929L5.29289 7.29289C5.68342 6.90237 6.31658 6.90237 6.70711 7.29289Z",fill:"currentColor"}),g.jsx("path",{d:"M17.2929 7.29289C17.6834 6.90237 18.3166 6.90237 18.7071 7.29289L22.7071 11.2929C23.0976 11.6834 23.0976 12.3166 22.7071 12.7071L18.7071 16.7071C18.3166 17.0976 17.6834 17.0976 17.2929 16.7071C16.9024 16.3166 16.9024 15.6834 17.2929 15.2929L20.5858 12L17.2929 8.70711C16.9024 8.31658 16.9024 7.68342 17.2929 7.29289Z",fill:"currentColor"})]}));Nh.displayName="Code2Icon";const Oh=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{d:"M15.0222 3H19C19.5523 3 20 3.44772 20 4C20 4.55228 19.5523 5 19 5H15.693L10.443 19H14C14.5523 19 15 19.4477 15 20C15 20.5523 14.5523 21 14 21H9.02418C9.00802 21.0004 8.99181 21.0004 8.97557 21H5C4.44772 21 4 20.5523 4 20C4 19.4477 4.44772 19 5 19H8.30704L13.557 5H10C9.44772 5 9 4.55228 9 4C9 3.44772 9.44772 3 10 3H14.9782C14.9928 2.99968 15.0075 2.99967 15.0222 3Z",fill:"currentColor"})}));Oh.displayName="ItalicIcon";const Ih=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{d:"M9.00039 3H16.0001C16.5524 3 17.0001 3.44772 17.0001 4C17.0001 4.55229 16.5524 5 16.0001 5H9.00011C8.68006 4.99983 8.36412 5.07648 8.07983 5.22349C7.79555 5.37051 7.55069 5.5836 7.36585 5.84487C7.181 6.10614 7.06155 6.40796 7.01754 6.72497C6.97352 7.04198 7.00623 7.36492 7.11292 7.66667C7.29701 8.18737 7.02414 8.75872 6.50344 8.94281C5.98274 9.1269 5.4114 8.85403 5.2273 8.33333C5.01393 7.72984 4.94851 7.08396 5.03654 6.44994C5.12456 5.81592 5.36346 5.21229 5.73316 4.68974C6.10285 4.1672 6.59256 3.74101 7.16113 3.44698C7.72955 3.15303 8.36047 2.99975 9.00039 3Z",fill:"currentColor"}),g.jsx("path",{d:"M18 13H20C20.5523 13 21 12.5523 21 12C21 11.4477 20.5523 11 20 11H4C3.44772 11 3 11.4477 3 12C3 12.5523 3.44772 13 4 13H14C14.7956 13 15.5587 13.3161 16.1213 13.8787C16.6839 14.4413 17 15.2044 17 16C17 16.7956 16.6839 17.5587 16.1213 18.1213C15.5587 18.6839 14.7956 19 14 19H6C5.44772 19 5 19.4477 5 20C5 20.5523 5.44772 21 6 21H14C15.3261 21 16.5979 20.4732 17.5355 19.5355C18.4732 18.5979 19 17.3261 19 16C19 14.9119 18.6453 13.8604 18 13Z",fill:"currentColor"})]}));Ih.displayName="StrikeIcon";const Dh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.29289 7.29289C3.68342 6.90237 4.31658 6.90237 4.70711 7.29289L12.7071 15.2929C13.0976 15.6834 13.0976 16.3166 12.7071 16.7071C12.3166 17.0976 11.6834 17.0976 11.2929 16.7071L3.29289 8.70711C2.90237 8.31658 2.90237 7.68342 3.29289 7.29289Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.7071 7.29289C13.0976 7.68342 13.0976 8.31658 12.7071 8.70711L4.70711 16.7071C4.31658 17.0976 3.68342 17.0976 3.29289 16.7071C2.90237 16.3166 2.90237 15.6834 3.29289 15.2929L11.2929 7.29289C11.6834 6.90237 12.3166 6.90237 12.7071 7.29289Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.4079 14.3995C18.0284 14.0487 18.7506 13.9217 19.4536 14.0397C20.1566 14.1578 20.7977 14.5138 21.2696 15.0481L21.2779 15.0574L21.2778 15.0575C21.7439 15.5988 22 16.2903 22 17C22 18.0823 21.3962 18.8401 20.7744 19.3404C20.194 19.8073 19.4858 20.141 18.9828 20.378C18.9638 20.387 18.9451 20.3958 18.9266 20.4045C18.4473 20.6306 18.2804 20.7817 18.1922 20.918C18.1773 20.9412 18.1619 20.9681 18.1467 21H21C21.5523 21 22 21.4477 22 22C22 22.5523 21.5523 23 21 23H17C16.4477 23 16 22.5523 16 22C16 21.1708 16.1176 20.4431 16.5128 19.832C16.9096 19.2184 17.4928 18.8695 18.0734 18.5956C18.6279 18.334 19.138 18.0901 19.5207 17.7821C19.8838 17.49 20 17.2477 20 17C20 16.7718 19.9176 16.5452 19.7663 16.3672C19.5983 16.1792 19.3712 16.0539 19.1224 16.0121C18.8722 15.9701 18.6152 16.015 18.3942 16.1394C18.1794 16.2628 18.0205 16.4549 17.9422 16.675C17.7572 17.1954 17.1854 17.4673 16.665 17.2822C16.1446 17.0972 15.8728 16.5254 16.0578 16.005C16.2993 15.3259 16.7797 14.7584 17.4039 14.4018L17.4079 14.3995L17.4079 14.3995Z",fill:"currentColor"})]}));Dh.displayName="SubscriptIcon";const Lh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.7071 7.29289C13.0976 7.68342 13.0976 8.31658 12.7071 8.70711L4.70711 16.7071C4.31658 17.0976 3.68342 17.0976 3.29289 16.7071C2.90237 16.3166 2.90237 15.6834 3.29289 15.2929L11.2929 7.29289C11.6834 6.90237 12.3166 6.90237 12.7071 7.29289Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.29289 7.29289C3.68342 6.90237 4.31658 6.90237 4.70711 7.29289L12.7071 15.2929C13.0976 15.6834 13.0976 16.3166 12.7071 16.7071C12.3166 17.0976 11.6834 17.0976 11.2929 16.7071L3.29289 8.70711C2.90237 8.31658 2.90237 7.68342 3.29289 7.29289Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.405 1.40657C18.0246 1.05456 18.7463 0.92634 19.4492 1.04344C20.1521 1.16054 20.7933 1.51583 21.2652 2.0497L21.2697 2.05469L21.2696 2.05471C21.7431 2.5975 22 3.28922 22 4.00203C22 5.08579 21.3952 5.84326 20.7727 6.34289C20.1966 6.80531 19.4941 7.13675 18.9941 7.37261C18.9714 7.38332 18.9491 7.39383 18.9273 7.40415C18.4487 7.63034 18.2814 7.78152 18.1927 7.91844C18.1778 7.94155 18.1625 7.96834 18.1473 8.00003H21C21.5523 8.00003 22 8.44774 22 9.00003C22 9.55231 21.5523 10 21 10H17C16.4477 10 16 9.55231 16 9.00003C16 8.17007 16.1183 7.44255 16.5138 6.83161C16.9107 6.21854 17.4934 5.86971 18.0728 5.59591C18.6281 5.33347 19.1376 5.09075 19.5208 4.78316C19.8838 4.49179 20 4.25026 20 4.00203C20 3.77192 19.9178 3.54865 19.7646 3.37182C19.5968 3.18324 19.3696 3.05774 19.1205 3.01625C18.8705 2.97459 18.6137 3.02017 18.3933 3.14533C18.1762 3.26898 18.0191 3.45826 17.9406 3.67557C17.7531 4.19504 17.18 4.46414 16.6605 4.27662C16.141 4.0891 15.8719 3.51596 16.0594 2.99649C16.303 2.3219 16.7817 1.76125 17.4045 1.40689L17.405 1.40657Z",fill:"currentColor"})]}));Lh.displayName="SuperscriptIcon";const Ph=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 4C7 3.44772 6.55228 3 6 3C5.44772 3 5 3.44772 5 4V10C5 11.8565 5.7375 13.637 7.05025 14.9497C8.36301 16.2625 10.1435 17 12 17C13.8565 17 15.637 16.2625 16.9497 14.9497C18.2625 13.637 19 11.8565 19 10V4C19 3.44772 18.5523 3 18 3C17.4477 3 17 3.44772 17 4V10C17 11.3261 16.4732 12.5979 15.5355 13.5355C14.5979 14.4732 13.3261 15 12 15C10.6739 15 9.40215 14.4732 8.46447 13.5355C7.52678 12.5979 7 11.3261 7 10V4ZM4 19C3.44772 19 3 19.4477 3 20C3 20.5523 3.44772 21 4 21H20C20.5523 21 21 20.5523 21 20C21 19.4477 20.5523 19 20 19H4Z",fill:"currentColor"})}));Ph.displayName="UnderlineIcon";const Ob={bold:Rh,italic:Oh,underline:Ph,strike:Ih,code:Nh,superscript:Lh,subscript:Dh},Ib={bold:"Ctrl-b",italic:"Ctrl-i",underline:"Ctrl-u",strike:"Ctrl-Shift-s",code:"Ctrl-e",superscript:"Ctrl-.",subscript:"Ctrl-,"};function jh(n,e){if(!n)return!1;try{return n.can().toggleMark(e)}catch{return!1}}function Db(n,e){return n?n.isActive(e):!1}function Lb(n,e){n&&n.chain().focus().toggleMark(e).run()}function Pb(n,e,t=!1){return!!(!n||t||n.isActive("codeBlock")||!jh(n,e))}function jb(n){const{editor:e,type:t,hideWhenUnavailable:r,markInSchema:s}=n;return!(!s||!e||r&&(gt(e.state.selection)||!jh(e,t)))}function Bb(n){return n.charAt(0).toUpperCase()+n.slice(1)}function Hb(n,e,t=!1){const r=Si(e,n),s=Pb(n,e,t),i=Db(n,e),o=Ob[e],l=Ib[e],a=Bb(e);return{markInSchema:r,isDisabled:s,isActive:i,Icon:o,shortcutKey:l,formattedName:a}}const Ht=y.forwardRef(({editor:n,type:e,text:t,hideWhenUnavailable:r=!1,className:s="",disabled:i,onClick:o,children:l,...a},c)=>{const u=et(n),{markInSchema:d,isDisabled:f,isActive:h,Icon:p,shortcutKey:m,formattedName:C}=Hb(u,e,i),b=y.useCallback(x=>{o?.(x),!x.defaultPrevented&&!f&&u&&Lb(u,e)},[o,f,u,e]);return!y.useMemo(()=>jb({editor:u,type:e,hideWhenUnavailable:r,markInSchema:d}),[u,e,r,d])||!u||!u.isEditable?null:g.jsx(Te,{type:"button",className:s.trim(),disabled:f,"data-style":"ghost","data-active-state":h?"on":"off","data-disabled":f,role:"button",tabIndex:-1,"aria-label":e,"aria-pressed":h,tooltip:C,shortcutKeys:m,onClick:b,...a,ref:c,children:l||g.jsxs(g.Fragment,{children:[g.jsx(p,{className:"tiptap-button-icon"}),t&&g.jsx("span",{className:"tiptap-button-text",children:t})]})})});Ht.displayName="MarkButton";const Bh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 12C6 11.4477 6.44772 11 7 11H17C17.5523 11 18 11.4477 18 12C18 12.5523 17.5523 13 17 13H7C6.44772 13 6 12.5523 6 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 18C4 17.4477 4.44772 17 5 17H19C19.5523 17 20 17.4477 20 18C20 18.5523 19.5523 19 19 19H5C4.44772 19 4 18.5523 4 18Z",fill:"currentColor"})]}));Bh.displayName="AlignCenterIcon";const Hh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 11.4477 2.44772 11 3 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H3C2.44772 13 2 12.5523 2 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 18C2 17.4477 2.44772 17 3 17H21C21.5523 17 22 17.4477 22 18C22 18.5523 21.5523 19 21 19H3C2.44772 19 2 18.5523 2 18Z",fill:"currentColor"})]}));Hh.displayName="AlignJustifyIcon";const Fh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 11.4477 2.44772 11 3 11H15C15.5523 11 16 11.4477 16 12C16 12.5523 15.5523 13 15 13H3C2.44772 13 2 12.5523 2 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 18C2 17.4477 2.44772 17 3 17H17C17.5523 17 18 17.4477 18 18C18 18.5523 17.5523 19 17 19H3C2.44772 19 2 18.5523 2 18Z",fill:"currentColor"})]}));Fh.displayName="AlignLeftIcon";const Vh=y.memo(({className:n,...e})=>g.jsxs("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 12C8 11.4477 8.44772 11 9 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H9C8.44772 13 8 12.5523 8 12Z",fill:"currentColor"}),g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 18C6 17.4477 6.44772 17 7 17H21C21.5523 17 22 17.4477 22 18C22 18.5523 21.5523 19 21 19H7C6.44772 19 6 18.5523 6 18Z",fill:"currentColor"})]}));Vh.displayName="AlignRightIcon";const Fb={left:Fh,center:Bh,right:Vh,justify:Hh},Vb={left:"Ctrl-Shift-l",center:"Ctrl-Shift-e",right:"Ctrl-Shift-r",justify:"Ctrl-Shift-j"},zb={left:"Align left",center:"Align center",right:"Align right",justify:"Align justify"};function $b(n){return"setTextAlign"in n}function Kb(n){if(!n)return!1;const e=n.extensionManager.extensions.some(t=>t.name==="textAlign");return e||console.warn("TextAlign extension is not available. Make sure it is included in your editor configuration."),e}function Wb(n,e,t){if(!n||!t)return!1;try{return n.can().setTextAlign(e)}catch{return!1}}function Ub(n,e){return n?n.isActive({textAlign:e}):!1}function _b(n,e){if(!n)return!1;const t=n.chain().focus();return $b(t)?t.setTextAlign(e).run():!1}function qb(n,e,t,r=!1){return!!(!n||!e||r||!t)}function Jb(n,e,t){return!(!n?.isEditable||t&&!e)}function Zb(n,e,t=!1,r=!1){const s=y.useMemo(()=>Kb(n),[n]),i=y.useMemo(()=>Wb(n,e,s),[n,e,s]),o=qb(n,s,i,t),l=Ub(n,e),a=y.useCallback(()=>!s||!n||o?!1:_b(n,e),[s,n,o,e]),c=y.useMemo(()=>Jb(n,i,r),[n,i,r]),u=Fb[e],d=Vb[e],f=zb[e];return{alignAvailable:s,canAlign:i,isDisabled:o,isActive:l,handleAlignment:a,shouldShow:c,Icon:u,shortcutKey:d,label:f}}const or=y.forwardRef(({editor:n,align:e,text:t,hideWhenUnavailable:r=!1,className:s="",disabled:i,onClick:o,children:l,...a},c)=>{const u=et(n),{isDisabled:d,isActive:f,handleAlignment:h,shouldShow:p,Icon:m,shortcutKey:C,label:b}=Zb(u,e,i,r),v=y.useCallback(x=>{o?.(x),!x.defaultPrevented&&!i&&h()},[o,i,h]);return!p||!u||!u.isEditable?null:g.jsx(Te,{type:"button",className:s.trim(),disabled:d,"data-style":"ghost","data-active-state":f?"on":"off","data-disabled":d,role:"button",tabIndex:-1,"aria-label":b,"aria-pressed":f,tooltip:b,shortcutKeys:C,onClick:v,...a,ref:c,children:l||g.jsxs(g.Fragment,{children:[g.jsx(m,{className:"tiptap-button-icon"}),t&&g.jsx("span",{className:"tiptap-button-text",children:t})]})})});or.displayName="TextAlignButton";const zh=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.7071 2.29289C15.3166 1.90237 14.6834 1.90237 14.2929 2.29289C13.9024 2.68342 13.9024 3.31658 14.2929 3.70711L17.5858 7H9.5C7.77609 7 6.12279 7.68482 4.90381 8.90381C3.68482 10.1228 3 11.7761 3 13.5C3 14.3536 3.16813 15.1988 3.49478 15.9874C3.82144 16.7761 4.30023 17.4926 4.90381 18.0962C6.12279 19.3152 7.77609 20 9.5 20H13C13.5523 20 14 19.5523 14 19C14 18.4477 13.5523 18 13 18H9.5C8.30653 18 7.16193 17.5259 6.31802 16.682C5.90016 16.2641 5.56869 15.768 5.34254 15.2221C5.1164 14.6761 5 14.0909 5 13.5C5 12.3065 5.47411 11.1619 6.31802 10.318C7.16193 9.47411 8.30653 9 9.5 9H17.5858L14.2929 12.2929C13.9024 12.6834 13.9024 13.3166 14.2929 13.7071C14.6834 14.0976 15.3166 14.0976 15.7071 13.7071L20.7071 8.70711C21.0976 8.31658 21.0976 7.68342 20.7071 7.29289L15.7071 2.29289Z",fill:"currentColor"})}));zh.displayName="Redo2Icon";const $h=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.70711 3.70711C10.0976 3.31658 10.0976 2.68342 9.70711 2.29289C9.31658 1.90237 8.68342 1.90237 8.29289 2.29289L3.29289 7.29289C2.90237 7.68342 2.90237 8.31658 3.29289 8.70711L8.29289 13.7071C8.68342 14.0976 9.31658 14.0976 9.70711 13.7071C10.0976 13.3166 10.0976 12.6834 9.70711 12.2929L6.41421 9H14.5C15.0909 9 15.6761 9.1164 16.2221 9.34254C16.768 9.56869 17.2641 9.90016 17.682 10.318C18.0998 10.7359 18.4313 11.232 18.6575 11.7779C18.8836 12.3239 19 12.9091 19 13.5C19 14.0909 18.8836 14.6761 18.6575 15.2221C18.4313 15.768 18.0998 16.2641 17.682 16.682C17.2641 17.0998 16.768 17.4313 16.2221 17.6575C15.6761 17.8836 15.0909 18 14.5 18H11C10.4477 18 10 18.4477 10 19C10 19.5523 10.4477 20 11 20H14.5C15.3536 20 16.1988 19.8319 16.9874 19.5052C17.7761 19.1786 18.4926 18.6998 19.0962 18.0962C19.6998 17.4926 20.1786 16.7761 20.5052 15.9874C20.8319 15.1988 21 14.3536 21 13.5C21 12.6464 20.8319 11.8012 20.5052 11.0126C20.1786 10.2239 19.6998 9.50739 19.0962 8.90381C18.4926 8.30022 17.7761 7.82144 16.9874 7.49478C16.1988 7.16813 15.3536 7 14.5 7H6.41421L9.70711 3.70711Z",fill:"currentColor"})}));$h.displayName="Undo2Icon";const Gb={undo:$h,redo:zh},Qb={undo:"Ctrl-z",redo:"Ctrl-Shift-z"},Yb={undo:"Undo",redo:"Redo"};function Kh(n,e){return n?e==="undo"?n.can().undo():n.can().redo():!1}function Xb(n,e){if(!n)return!1;const t=n.chain().focus();return e==="undo"?t.undo().run():t.redo().run()}function e5(n,e,t=!1){return t?!0:!Kh(n,e)}function t5(n,e,t=!1){const r=y.useMemo(()=>Kh(n,e),[n,e]),s=e5(n,e,t),i=y.useCallback(()=>{!n||s||Xb(n,e)},[n,e,s]),o=Gb[e],l=Yb[e],a=Qb[e];return{canExecute:r,isDisabled:s,handleAction:i,Icon:o,actionLabel:l,shortcutKey:a}}const nl=y.forwardRef(({editor:n,action:e,text:t,className:r="",disabled:s,onClick:i,children:o,...l},a)=>{const c=et(n),{isDisabled:u,handleAction:d,Icon:f,actionLabel:h,shortcutKey:p}=t5(c,e,s),m=y.useCallback(C=>{i?.(C),!C.defaultPrevented&&!s&&d()},[i,s,d]);return!c||!c.isEditable?null:g.jsx(Te,{ref:a,type:"button",className:r.trim(),disabled:u,"data-style":"ghost","data-disabled":u,role:"button",tabIndex:-1,"aria-label":h,tooltip:h,shortcutKeys:p,onClick:m,...l,children:o||g.jsxs(g.Fragment,{children:[g.jsx(f,{className:"tiptap-button-icon"}),t&&g.jsx("span",{className:"tiptap-button-text",children:t})]})})});nl.displayName="UndoRedoButton";const Wh=y.memo(({className:n,...e})=>g.jsx("svg",{width:"24",height:"24",className:n,viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:g.jsx("path",{d:"M12.7071 5.70711C13.0976 5.31658 13.0976 4.68342 12.7071 4.29289C12.3166 3.90237 11.6834 3.90237 11.2929 4.29289L4.29289 11.2929C3.90237 11.6834 3.90237 12.3166 4.29289 12.7071L11.2929 19.7071C11.6834 20.0976 12.3166 20.0976 12.7071 19.7071C13.0976 19.3166 13.0976 18.6834 12.7071 18.2929L7.41421 13L19 13C19.5523 13 20 12.5523 20 12C20 11.4477 19.5523 11 19 11L7.41421 11L12.7071 5.70711Z",fill:"currentColor"})}));Wh.displayName="ArrowLeftIcon";const go=768;function n5(){const[n,e]=y.useState(void 0);return y.useEffect(()=>{const t=window.matchMedia(`(max-width: ${go-1}px)`),r=()=>{e(window.innerWidth<go)};return t.addEventListener("change",r),e(window.innerWidth<go),()=>t.removeEventListener("change",r)},[]),!!n}function Uh(){const[n,e]=y.useState({width:0,height:0,offsetTop:0});return y.useEffect(()=>{t();function t(){if(typeof window>"u")return;const s=window.visualViewport;if(!s)return;const{width:i=0,height:o=0,offsetTop:l=0}=s;e(a=>i===a.width&&o===a.height&&l===a.offsetTop?a:{width:i,height:o,offsetTop:l})}const r=window.visualViewport;return r&&(r.addEventListener("resize",t),r.addEventListener("scroll",t)),()=>{r&&(r.removeEventListener("resize",t),r.removeEventListener("scroll",t))}},[]),n}function r5({editor:n,overlayHeight:e=0,elementRef:t=null}){const{height:r}=Uh(),[s,i]=y.useState({x:0,y:0,width:0,height:0}),o=y.useCallback(()=>{const l=t?.current??document.body,{x:a,y:c,width:u,height:d}=l.getBoundingClientRect();i({x:a,y:c,width:u,height:d})},[t]);return y.useEffect(()=>{const l=t?.current??document.body;o();const a=new ResizeObserver(()=>{window.requestAnimationFrame(o)});return a.observe(l),window.addEventListener("scroll",o,{passive:!0}),()=>{a.disconnect(),window.removeEventListener("scroll",o)}},[t,o]),y.useEffect(()=>{(()=>{if(!n)return;const{state:a,view:c}=n;if(!c.hasFocus())return;const{from:u}=a.selection,d=c.coordsAtPos(u);if(r<s.height&&d&&!(r-d.top-e>0)){const h=d.top-r/2;window.scrollTo({top:h,behavior:"smooth"})}})()},[n,e,r,s.height]),s}const s5=({onHighlighterClick:n,onLinkClick:e,isMobile:t})=>g.jsxs(g.Fragment,{children:[g.jsx(Yo,{}),g.jsxs($t,{children:[g.jsx(nl,{action:"undo"}),g.jsx(nl,{action:"redo"})]}),g.jsx(Kt,{}),g.jsxs($t,{children:[g.jsx(G4,{levels:[1,2,3,4]}),g.jsx(db,{types:["bulletList","orderedList","taskList"]}),g.jsx(tl,{type:"codeBlock"}),g.jsx(tl,{type:"blockquote"})]}),g.jsx(Kt,{}),g.jsxs($t,{children:[g.jsx(Ht,{type:"bold"}),g.jsx(Ht,{type:"italic"}),g.jsx(Ht,{type:"strike"}),g.jsx(Ht,{type:"code"}),g.jsx(Ht,{type:"underline"}),t?g.jsx(aa,{onClick:n}):g.jsx(Ab,{}),t?g.jsx(ua,{onClick:e}):g.jsx(Nb,{})]}),g.jsx(Kt,{}),g.jsxs($t,{children:[g.jsx(Ht,{type:"superscript"}),g.jsx(Ht,{type:"subscript"})]}),g.jsx(Kt,{}),g.jsxs($t,{children:[g.jsx(or,{align:"left"}),g.jsx(or,{align:"center"}),g.jsx(or,{align:"right"}),g.jsx(or,{align:"justify"})]}),g.jsx(Kt,{}),g.jsx($t,{children:g.jsx(ch,{text:"Add"})}),g.jsx(Yo,{}),t&&g.jsx(Kt,{})]}),i5=({type:n,onBack:e})=>g.jsxs(g.Fragment,{children:[g.jsx($t,{children:g.jsxs(Te,{"data-style":"ghost",onClick:e,children:[g.jsx(Wh,{className:"tiptap-button-icon"}),n==="highlighter"?g.jsx(sa,{className:"tiptap-button-icon"}):g.jsx(ca,{className:"tiptap-button-icon"})]})}),g.jsx(Kt,{}),n==="highlighter"?g.jsx(wh,{}):g.jsx(Rb,{})]}),o5=n=>{const e=document.createElement("div");return e.innerHTML=n,e.textContent||e.innerText||""};function l5({note:n,onSave:e,onTitleChange:t,autoSave:r=!0,autoSaveDelay:s=1e3}){const i=n5(),o=Uh(),[l,a]=y.useState("main"),[c,u]=y.useState(n?.title||"Untitled Note"),[d,f]=y.useState(!1),[h,p]=y.useState(null),m=y.useRef(null),C=x2({immediatelyRender:!1,editorProps:{attributes:{autocomplete:"off",autocorrect:"off",autocapitalize:"off","aria-label":"Main content area, start typing to enter text."}},extensions:[t7,l7.configure({types:["heading","paragraph"]}),j7,o7,i7.configure({nested:!0}),D7.configure({multicolor:!0}),r7,N7,P7,L7,lC,B4.configure({accept:"image/*",maxSize:el,limit:3,upload:V4,onError:M=>console.error("Upload failed:",M)}),aC,oC.configure({openOnClick:!1})],content:n?.content||{type:"doc",content:[{type:"paragraph"}]}}),b=r5({editor:C,overlayHeight:m.current?.getBoundingClientRect().height??0}),v=y.useCallback(async()=>{if(!(!C||!e)){f(!0);try{const M=C.getJSON(),T=C.getHTML(),P=o5(T);await e({title:c,content:M,htmlContent:T,plainTextContent:P}),p(new Date)}catch(M){console.error("Failed to save note:",M)}finally{f(!1)}}},[C,e,c]),x=y.useMemo(()=>ty(v,s),[v,s]),w=y.useCallback(M=>{u(M),t?.(M),r&&x()},[t,r,x]);return y.useEffect(()=>{if(!C||!r)return;const M=()=>{x()};return C.on("update",M),()=>{C.off("update",M)}},[C,r,x]),y.useEffect(()=>{!i&&l!=="main"&&a("main")},[i,l]),y.useEffect(()=>()=>{x.cancel()},[x]),g.jsxs("div",{className:"notes-editor",children:[g.jsxs("div",{className:"mb-4 px-4 pt-4",children:[g.jsx("input",{type:"text",value:c,onChange:M=>w(M.target.value),className:"w-full text-2xl font-bold bg-transparent border-none outline-none resize-none",placeholder:"Untitled Note"}),g.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-500",children:[d&&g.jsx("span",{children:"Saving..."}),h&&!d&&g.jsxs("span",{children:["Saved ",h.toLocaleTimeString()]})]})]}),g.jsxs(Il.Provider,{value:{editor:C},children:[g.jsx(Jf,{ref:m,style:i?{bottom:`calc(100% - ${o.height-b.y}px)`}:{},children:l==="main"?g.jsx(s5,{onHighlighterClick:()=>a("highlighter"),onLinkClick:()=>a("link"),isMobile:i}):g.jsx(i5,{type:l==="highlighter"?"highlighter":"link",onBack:()=>a("main")})}),g.jsx("div",{className:"content-wrapper",children:g.jsx(u2,{editor:C,role:"presentation",className:"simple-editor-content"})})]})]})}const f5=function(){const e=tp(),t=np({from:"/project-manager/notes"}),[r,s]=y.useState(null),[i,o]=y.useState(""),a=!!rp()?.id,{data:c,refetch:u}=Nn.notes.list.useQuery({folderId:t.folderId,search:i||void 0},{enabled:a}),{data:d}=Nn.notes.folders.list.useQuery(void 0,{enabled:a}),{data:f}=Nn.notes.getById.useQuery({id:t.noteId},{enabled:!!t.noteId&&a}),h=Nn.notes.create.useMutation({onSuccess:x=>{x&&e({to:"/project-manager/notes",search:{noteId:x.id}}),u()}}),p=Nn.notes.update.useMutation({onSuccess:()=>{u()}}),m=Nn.notes.folders.create.useMutation({onSuccess:()=>{}});y.useEffect(()=>{f&&s(f)},[f]);const C=async()=>{a&&await h.mutateAsync({title:"Untitled Note",folderId:t.folderId})},b=async x=>{if(a)if(r)await p.mutateAsync({id:r.id,...x});else{const w=await h.mutateAsync({...x,folderId:t.folderId});s(w)}},v=x=>{e({to:"/project-manager/notes",search:{noteId:x,folderId:t.folderId}})};return a?g.jsxs("div",{className:"flex h-screen",children:[g.jsxs("div",{className:"w-2/12 border-r border-stone-300 p-4",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h3",{className:"font-semibold",children:"Folders"}),g.jsx(Ai,{size:"sm",variant:"ghost",onClick:()=>{const x=prompt("Folder name:");x&&m.mutate({name:x})},children:g.jsx(Ri,{className:"h-4 w-4"})})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("button",{onClick:()=>e({to:"/project-manager/notes",search:{}}),className:`w-full text-left p-2 rounded hover:bg-gray-100 flex items-center gap-2 ${t.folderId?"":"bg-blue-50 text-blue-600"}`,children:[g.jsx(ga,{className:"h-4 w-4"}),"All Notes"]}),d?.map(x=>g.jsxs("button",{onClick:()=>e({to:"/project-manager/notes",search:{folderId:x.id}}),className:`w-full text-left p-2 rounded hover:bg-gray-100 flex items-center gap-2 ${t.folderId===x.id?"bg-blue-50 text-blue-600":""}`,children:[g.jsx(ga,{className:"h-4 w-4",style:{color:x.color||"#6366f1"}}),x.name]},x.id))]})]}),g.jsxs("div",{className:"w-3/12 border-r border-stone-300 p-4",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h3",{className:"font-semibold",children:"Notes"}),g.jsx(Ai,{size:"sm",onClick:C,children:g.jsx(Ri,{className:"h-4 w-4"})})]}),g.jsxs("div",{className:"relative mb-4",children:[g.jsx(sp,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),g.jsx("input",{type:"text",placeholder:"Search notes...",value:i,onChange:x=>o(x.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"})]}),g.jsxs("div",{className:"space-y-2",children:[c?.map(x=>g.jsxs("button",{onClick:()=>v(x.id),className:`w-full text-left p-3 rounded-md border hover:bg-gray-50 ${t.noteId===x.id?"bg-blue-50 border-blue-200":""}`,children:[g.jsx("h4",{className:"font-medium truncate",children:x.title}),g.jsx("p",{className:"text-sm text-gray-500 mt-1",children:new Date(x.updatedAt).toLocaleDateString()}),x.plainTextContent&&g.jsxs("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:[x.plainTextContent.substring(0,100),"..."]})]},x.id)),c?.length===0&&g.jsx("div",{className:"text-center py-8 text-gray-500",children:"No notes found. Create your first note!"})]})]}),g.jsx("div",{className:"w-7/12",children:r||t.noteId?g.jsx("div",{className:"max-w-5xl mx-auto h-full",children:g.jsx(l5,{note:r,onSave:b,autoSave:!0,autoSaveDelay:1e3})}):g.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:g.jsxs("div",{className:"text-center",children:[g.jsx("h3",{className:"text-xl font-medium mb-2",children:"Select a note to edit"}),g.jsx("p",{className:"mb-4",children:"Choose a note from the sidebar or create a new one."}),g.jsxs(Ai,{onClick:C,children:[g.jsx(Ri,{className:"h-4 w-4 mr-2"}),"Create New Note"]})]})})})]}):g.jsx("div",{className:"flex items-center justify-center h-screen",children:g.jsxs("div",{className:"text-center",children:[g.jsx("h3",{className:"text-xl font-medium mb-2",children:"Authentication Required"}),g.jsx("p",{children:"Please log in to access your notes."})]})})};export{f5 as component};
