import{c as y,j as e,B as C,P as U,D as q,a as B,b as V,d as I,R as h,t as g,e as M,f as S,g as A,h as O,T as E}from"./client-CIpQrpJ6.js";import{C as _}from"./calendar-D_D1EZcx.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],J=y("Ellipsis",G);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],W=y("SquarePen",K);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Y=y("Tag",X);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ee=y("Trash2",Z),te={backlog:{label:"Backlog",color:"bg-gray-100 text-gray-700",dot:"bg-gray-500"},todo:{label:"To Do",color:"bg-blue-100 text-blue-700",dot:"bg-blue-500"},in_progress:{label:"In Progress",color:"bg-yellow-100 text-yellow-700",dot:"bg-yellow-500"},done:{label:"Done",color:"bg-green-100 text-green-700",dot:"bg-green-500"},on_hold:{label:"On Hold",color:"bg-red-100 text-red-700",dot:"bg-red-500"}},se={low:{label:"Low",color:"text-green-600",icon:"▼"},medium:{label:"Medium",color:"text-yellow-600",icon:"▶"},high:{label:"High",color:"text-orange-600",icon:"▲"},urgent:{label:"Urgent",color:"text-red-600",icon:"⚠️"}};function N(x){return x?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(x)):""}function ae({tasks:x,projects:j=[],onEdit:c,onDelete:b,onCreateTask:d,isLoading:a}){return a?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,r)=>e.jsxs("div",{className:"border-b rounded-lg p-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},r))}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"No tasks found"}),e.jsx("img",{src:"https://storage.dev-0af.workers.dev/architect.png",alt:"Empty state",className:"w-1/4 mx-auto"}),e.jsx("div",{className:"text-gray-400 text-sm mb-4",children:"Create your first task to get started"}),d&&e.jsxs(C,{onClick:d,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:[e.jsx(U,{className:"h-4 w-4"}),"Create Task"]})]}):e.jsx("div",{className:"space-y-3",children:x.map(s=>{const r=te[s.status],p=se[s.priority],m=j.find(i=>i.id===s.projectId);return e.jsxs("div",{className:"border-b rounded-lg p-4 cursor-pointer group",onClick:()=>c(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 line-clamp-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${r.dot}`}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.color}`,children:r.label})]}),e.jsxs("div",{className:`flex items-center gap-1 text-xs ${p.color}`,children:[e.jsx("span",{children:p.icon}),e.jsx("span",{children:p.label})]})]}),s.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-2 line-clamp-1",children:s.description})]}),e.jsxs(q,{children:[e.jsx(B,{asChild:!0,children:e.jsx(C,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 ml-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:i=>i.stopPropagation(),children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsxs(V,{align:"end",children:[e.jsxs(I,{onClick:()=>c(s),children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(I,{onClick:()=>b(s.id),className:"text-red-600",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-gray-500",children:[m&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Project:"}),e.jsx("span",{children:m.name})]}),s.startDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-3 w-3"}),e.jsxs("span",{children:["Start: ",N(s.startDate)]})]}),s.dueDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-3 w-3"}),e.jsxs("span",{children:["Due: ",N(s.dueDate)]})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["Created: ",N(s.createdAt)]})})]}),s.labels.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx(Y,{className:"h-3 w-3 text-gray-400"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.labels.map(i=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-md",children:i},i))})]})]},s.id)})})}const le=function(){const[j,c]=h.useState(!1),[b,d]=h.useState(!1),[a,s]=h.useState(null),[r,p]=h.useState("inbox"),m=g.tasks.list.useQuery(),i=g.projects.list.useQuery(),v=g.tasks.create.useMutation(),k=g.tasks.update.useMutation(),H=g.tasks.delete.useMutation(),f=()=>{m.refetch()},P=async t=>{try{await v.mutateAsync({name:t.name,description:t.description,startDate:t.startDate,dueDate:t.dueDate,status:t.status,priority:t.priority,labels:t.labels,projectId:t.projectId,parentTaskId:t.parentTaskId}),c(!1),f()}catch(u){console.error("Failed to create task:",u)}},$=t=>{s(t),d(!0)},F=async t=>{if(a)try{await k.mutateAsync({id:a.id,name:t.name,description:t.description,startDate:t.startDate,dueDate:t.dueDate,status:t.status,priority:t.priority,labels:t.labels,projectId:t.projectId,parentTaskId:t.parentTaskId}),d(!1),s(null),f()}catch(u){console.error("Failed to update task:",u)}},L=async t=>{if(confirm("Are you sure you want to delete this task?"))try{await H.mutateAsync({id:t}),f()}catch(u){console.error("Failed to delete task:",u)}},l=(m.data||[]).map(t=>({...t,startDate:t.startDate?new Date(t.startDate):null,dueDate:t.dueDate?new Date(t.dueDate):null,labels:t.labels||[],createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)})),z=h.useMemo(()=>{const t=new Date;switch(t.setHours(23,59,59,999),new Date().setHours(0,0,0,0),r){case"inbox":return l.filter(n=>!n.projectId);case"today":return l.filter(n=>n.dueDate?n.dueDate<=t:n.status!=="done");case"upcoming":return l.filter(n=>n.dueDate?n.dueDate>t:!1);default:return l}},[l,r]),D=(i.data||[]).map(t=>({id:t.id,name:t.name})),T=l.map(t=>({id:t.id,name:t.name})),Q=a?{id:a.id,name:a.name,description:a.description||"",startDate:a.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",dueDate:a.dueDate?new Date(a.dueDate).toISOString().split("T")[0]:"",status:a.status,priority:a.priority,labels:a.labels,projectId:a.projectId||void 0,parentTaskId:a.parentTaskId||void 0}:void 0;return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tasks"})})}),e.jsx("div",{className:"mb-6 ",children:e.jsx("div",{className:"flex items-center gap-1 bg-gray-100 p-1 rounded-lg w-fit",children:[{key:"inbox",label:"Inbox"},{key:"today",label:"Today"},{key:"upcoming",label:"Upcoming"}].map(t=>{const n=(R=>{const w=new Date;switch(w.setHours(23,59,59,999),R){case"inbox":return l.filter(o=>!o.projectId).length;case"today":return l.filter(o=>o.dueDate?o.dueDate<=w:o.status!=="done").length;case"upcoming":return l.filter(o=>o.dueDate?o.dueDate>w:!1).length;default:return 0}})(t.key);return e.jsxs("button",{onClick:()=>p(t.key),className:`px-4 py-2 font-medium rounded-md text-xs transition-colors flex items-center gap-2 ${r===t.key?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[t.label,e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${r===t.key?"bg-gray-200 text-gray-700":"bg-gray-300 text-gray-600"}`,children:n})]},t.key)})})}),e.jsx(ae,{tasks:z,projects:D,onEdit:$,onDelete:L,onCreateTask:()=>c(!0),isLoading:m.isLoading}),e.jsx(M,{open:j,onOpenChange:c,children:e.jsxs(S,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(A,{children:e.jsx(O,{children:"Create New Task"})}),e.jsx(E,{mode:"create",onSubmit:P,onCancel:()=>c(!1),projects:D,tasks:T,isLoading:v.isPending})]})}),e.jsx(M,{open:b,onOpenChange:t=>{d(t),t||s(null)},children:e.jsxs(S,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(A,{children:e.jsx(O,{children:"Edit Task"})}),e.jsx(E,{mode:"edit",initialData:Q,onSubmit:F,onCancel:()=>{d(!1),s(null)},projects:D,tasks:T.filter(t=>t.id!==a?.id),isLoading:k.isPending})]})})]})};export{le as component};
