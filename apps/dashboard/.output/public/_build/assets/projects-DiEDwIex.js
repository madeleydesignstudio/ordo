import{R as D,j as e,D as N,a as y,b as w,d as x,U as _,t as f,P as $}from"./client-D9jdpKMx.js";import{B as u}from"./button-CC9DIoTM.js";import{I as b}from"./input-ruLql0VM.js";import{L as c}from"./label-Bcvho0AR.js";import{E as B,S as H,T as q,D as M,a as E,b as O,c as F}from"./dialog-BBxruDSb.js";import{C as A}from"./calendar-DAcRjqEF.js";const T=[{value:"backlog",label:"Backlog",color:"text-gray-600"},{value:"todo",label:"To Do",color:"text-blue-600"},{value:"in_progress",label:"In Progress",color:"text-yellow-600"},{value:"done",label:"Done",color:"text-green-600"},{value:"on_hold",label:"On Hold",color:"text-red-600"}],Q=["ðŸ“","ðŸš€","ðŸ’¼","ðŸŽ¯","âš¡","ðŸ”¥","ðŸ’¡","ðŸŽ¨","ðŸ› ï¸","ðŸ“Š"];function L({initialData:i={},projects:m=[],onSubmit:o,onCancel:h,isLoading:a=!1,mode:r}){const[n,d]=D.useState({name:"",status:"backlog",icon:"ðŸ“",...i}),g=t=>{t.preventDefault(),o(n)},l=(t,P)=>{d(C=>({...C,[t]:P}))},v=T.find(t=>t.value===n.status),j=m.find(t=>t.id===n.parentProjectId);return e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Project Name *"}),e.jsx(b,{id:"name",value:n.name,onChange:t=>l("name",t.target.value),placeholder:"Enter project name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",value:n.description||"",onChange:t=>l("description",t.target.value),placeholder:"Enter project description",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Icon"}),e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:"w-full justify-start",children:[e.jsx("span",{className:"mr-2 text-lg",children:n.icon}),"Choose Icon"]})}),e.jsx(w,{children:Q.map(t=>e.jsxs(x,{onClick:()=>l("icon",t),children:[e.jsx("span",{className:"mr-2 text-lg",children:t}),t]},t))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"cover",children:"Cover Image URL"}),e.jsx(b,{id:"cover",value:n.cover||"",onChange:t=>l("cover",t.target.value),placeholder:"https://example.com/image.jpg"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"startDate",children:"Start Date"}),e.jsx(b,{id:"startDate",type:"date",value:n.startDate||"",onChange:t=>l("startDate",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"dueDate",children:"Due Date"}),e.jsx(b,{id:"dueDate",type:"date",value:n.dueDate||"",onChange:t=>l("dueDate",t.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Status"}),e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:"w-full justify-start",children:[e.jsx("span",{className:`mr-2 ${v?.color}`,children:"â—"}),v?.label]})}),e.jsx(w,{children:T.map(t=>e.jsxs(x,{onClick:()=>l("status",t.value),children:[e.jsx("span",{className:`mr-2 ${t.color}`,children:"â—"}),t.label]},t.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Parent Project"}),e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsx(u,{variant:"outline",className:"w-full justify-start",children:j?.name||"No parent project"})}),e.jsxs(w,{children:[e.jsx(x,{onClick:()=>l("parentProjectId",void 0),children:"No parent project"}),m.filter(t=>t.id!==n.id).map(t=>e.jsx(x,{onClick:()=>l("parentProjectId",t.id),children:t.name},t.id))]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(u,{type:"submit",disabled:a||!n.name.trim(),children:a?"Saving...":r==="create"?"Create Project":"Update Project"}),e.jsx(u,{type:"button",variant:"outline",onClick:h,children:"Cancel"})]})]})}const z={backlog:{label:"Backlog",color:"bg-gray-100 text-gray-700",dot:"bg-gray-500"},todo:{label:"To Do",color:"bg-blue-100 text-blue-700",dot:"bg-blue-500"},in_progress:{label:"In Progress",color:"bg-yellow-100 text-yellow-700",dot:"bg-yellow-500"},done:{label:"Done",color:"bg-green-100 text-green-700",dot:"bg-green-500"},on_hold:{label:"On Hold",color:"bg-red-100 text-red-700",dot:"bg-red-500"}};function I(i){return i?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(i)):""}function G({projects:i,onEdit:m,onDelete:o,isLoading:h}){return h?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((a,r)=>e.jsxs("div",{className:"border rounded-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]},r))}):i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"No projects found"}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Create your first project to get started"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(a=>{const r=z[a.status];return e.jsxs("div",{className:"border rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:a.icon||"ðŸ“"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900 line-clamp-1",children:a.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${r.dot}`}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.color}`,children:r.label})]})]})]}),e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(B,{className:"h-4 w-4"})})}),e.jsxs(w,{align:"end",children:[e.jsxs(x,{onClick:()=>m(a),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(x,{onClick:()=>o(a.id),className:"text-red-600",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]}),a.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:a.description}),a.cover&&e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:a.cover,alt:`${a.name} cover`,className:"w-full h-32 object-cover rounded-md",onError:n=>{const d=n.target;d.style.display="none"}})}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-500",children:[a.startDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-3 w-3"}),e.jsxs("span",{children:["Start: ",I(a.startDate)]})]}),a.dueDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-3 w-3"}),e.jsxs("span",{children:["Due: ",I(a.dueDate)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-3 w-3"}),e.jsxs("span",{children:["Created: ",I(a.createdAt)]})]})]})]},a.id)})})}const Z=function(){const[m,o]=D.useState(!1),[h,a]=D.useState(!1),[r,n]=D.useState(null),d=f.projects.list.useQuery(),g=f.projects.create.useMutation(),l=f.projects.update.useMutation(),v=f.projects.delete.useMutation(),j=()=>{d.refetch()},t=async s=>{try{await g.mutateAsync({name:s.name,description:s.description,icon:s.icon,cover:s.cover,startDate:s.startDate,dueDate:s.dueDate,status:s.status,parentProjectId:s.parentProjectId}),o(!1),j()}catch(p){console.error("Failed to create project:",p)}},P=s=>{n(s),a(!0)},C=async s=>{if(r)try{await l.mutateAsync({id:r.id,name:s.name,description:s.description,icon:s.icon,cover:s.cover,startDate:s.startDate,dueDate:s.dueDate,status:s.status,parentProjectId:s.parentProjectId}),a(!1),n(null),j()}catch(p){console.error("Failed to update project:",p)}},U=async s=>{if(confirm("Are you sure you want to delete this project?"))try{await v.mutateAsync({id:s}),j()}catch(p){console.error("Failed to delete project:",p)}},S=(d.data||[]).map(s=>({...s,startDate:s.startDate?new Date(s.startDate):null,dueDate:s.dueDate?new Date(s.dueDate):null,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)})),k=S.map(s=>({id:s.id,name:s.name})),R=r?{id:r.id,name:r.name,description:r.description||"",icon:r.icon||"ðŸ“",cover:r.cover||"",startDate:r.startDate?new Date(r.startDate).toISOString().split("T")[0]:"",dueDate:r.dueDate?new Date(r.dueDate).toISOString().split("T")[0]:"",status:r.status,parentProjectId:r.parentProjectId||void 0}:void 0;return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Projects"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your projects and track their progress"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:[e.jsx($,{className:"h-4 w-4"}),"Add Project"]})]}),e.jsx(G,{projects:S,onEdit:P,onDelete:U,isLoading:d.isLoading}),e.jsx(M,{open:m,onOpenChange:o,children:e.jsxs(E,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(O,{children:e.jsx(F,{children:"Create New Project"})}),e.jsx(L,{mode:"create",onSubmit:t,onCancel:()=>o(!1),projects:k,isLoading:g.isPending})]})}),e.jsx(M,{open:h,onOpenChange:s=>{a(s),s||n(null)},children:e.jsxs(E,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(O,{children:e.jsx(F,{children:"Edit Project"})}),e.jsx(L,{mode:"edit",initialData:R,onSubmit:C,onCancel:()=>{a(!1),n(null)},projects:k.filter(s=>s.id!==r?.id),isLoading:l.isPending})]})})]})};export{Z as component};
