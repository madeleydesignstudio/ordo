import{c as Q,R as k,j as e,D as N,a as D,b as w,d as u,t as y,P as R}from"./client-D9jdpKMx.js";import{B as x}from"./button-CC9DIoTM.js";import{I as S}from"./input-ruLql0VM.js";import{L as o}from"./label-Bcvho0AR.js";import{X as q,E as z,S as K,T as X,D as E,a as O,b as F,c as _}from"./dialog-BBxruDSb.js";import{C as $}from"./calendar-DAcRjqEF.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],J=Q("Tag",G),H=[{value:"backlog",label:"Backlog",color:"text-gray-600"},{value:"todo",label:"To Do",color:"text-blue-600"},{value:"in_progress",label:"In Progress",color:"text-yellow-600"},{value:"done",label:"Done",color:"text-green-600"},{value:"on_hold",label:"On Hold",color:"text-red-600"}],U=[{value:"low",label:"Low",color:"text-green-600"},{value:"medium",label:"Medium",color:"text-yellow-600"},{value:"high",label:"High",color:"text-orange-600"},{value:"urgent",label:"Urgent",color:"text-red-600"}];function B({initialData:d={},projects:h=[],tasks:c=[],onSubmit:g,onCancel:m,isLoading:t=!1,mode:n}){const[l,j]=k.useState({name:"",status:"backlog",priority:"medium",labels:[],...d}),[i,b]=k.useState(""),M=s=>{s.preventDefault(),g(l)},r=(s,a)=>{j(p=>({...p,[s]:a}))},C=()=>{i.trim()&&!l.labels.includes(i.trim())&&(r("labels",[...l.labels,i.trim()]),b(""))},P=s=>{r("labels",l.labels.filter(a=>a!==s))},L=s=>{s.key==="Enter"&&(s.preventDefault(),C())},T=H.find(s=>s.value===l.status),f=U.find(s=>s.value===l.priority),v=h.find(s=>s.id===l.projectId),I=c.find(s=>s.id===l.parentTaskId);return e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"name",children:"Task Name *"}),e.jsx(S,{id:"name",value:l.name,onChange:s=>r("name",s.target.value),placeholder:"Enter task name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",value:l.description||"",onChange:s=>r("description",s.target.value),placeholder:"Enter task description",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"startDate",children:"Start Date"}),e.jsx(S,{id:"startDate",type:"date",value:l.startDate||"",onChange:s=>r("startDate",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"dueDate",children:"Due Date"}),e.jsx(S,{id:"dueDate",type:"date",value:l.dueDate||"",onChange:s=>r("dueDate",s.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Status"}),e.jsxs(N,{children:[e.jsx(D,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"w-full justify-start",children:[e.jsx("span",{className:`mr-2 ${T?.color}`,children:"●"}),T?.label]})}),e.jsx(w,{children:H.map(s=>e.jsxs(u,{onClick:()=>r("status",s.value),children:[e.jsx("span",{className:`mr-2 ${s.color}`,children:"●"}),s.label]},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Priority"}),e.jsxs(N,{children:[e.jsx(D,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"w-full justify-start",children:[e.jsx("span",{className:`mr-2 ${f?.color}`,children:"▲"}),f?.label]})}),e.jsx(w,{children:U.map(s=>e.jsxs(u,{onClick:()=>r("priority",s.value),children:[e.jsx("span",{className:`mr-2 ${s.color}`,children:"▲"}),s.label]},s.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Labels"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{value:i,onChange:s=>b(s.target.value),placeholder:"Add a label",onKeyPress:L}),e.jsx(x,{type:"button",onClick:C,variant:"outline",children:"Add"})]}),l.labels.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:l.labels.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-md",children:[s,e.jsx("button",{type:"button",onClick:()=>P(s),className:"hover:text-blue-600",children:e.jsx(q,{className:"h-3 w-3"})})]},s))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Project"}),e.jsxs(N,{children:[e.jsx(D,{asChild:!0,children:e.jsx(x,{variant:"outline",className:"w-full justify-start",children:v?.name||"No project assigned"})}),e.jsxs(w,{children:[e.jsx(u,{onClick:()=>r("projectId",void 0),children:"No project assigned"}),h.map(s=>e.jsx(u,{onClick:()=>r("projectId",s.id),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Parent Task"}),e.jsxs(N,{children:[e.jsx(D,{asChild:!0,children:e.jsx(x,{variant:"outline",className:"w-full justify-start",children:I?.name||"No parent task"})}),e.jsxs(w,{children:[e.jsx(u,{onClick:()=>r("parentTaskId",void 0),children:"No parent task"}),c.filter(s=>s.id!==l.id).map(s=>e.jsx(u,{onClick:()=>r("parentTaskId",s.id),children:s.name},s.id))]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(x,{type:"submit",disabled:t||!l.name.trim(),children:t?"Saving...":n==="create"?"Create Task":"Update Task"}),e.jsx(x,{type:"button",variant:"outline",onClick:m,children:"Cancel"})]})]})}const V={backlog:{label:"Backlog",color:"bg-gray-100 text-gray-700",dot:"bg-gray-500"},todo:{label:"To Do",color:"bg-blue-100 text-blue-700",dot:"bg-blue-500"},in_progress:{label:"In Progress",color:"bg-yellow-100 text-yellow-700",dot:"bg-yellow-500"},done:{label:"Done",color:"bg-green-100 text-green-700",dot:"bg-green-500"},on_hold:{label:"On Hold",color:"bg-red-100 text-red-700",dot:"bg-red-500"}},W={low:{label:"Low",color:"text-green-600",icon:"▼"},medium:{label:"Medium",color:"text-yellow-600",icon:"▶"},high:{label:"High",color:"text-orange-600",icon:"▲"},urgent:{label:"Urgent",color:"text-red-600",icon:"⚠️"}};function A(d){return d?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(d)):""}function Y({tasks:d,projects:h=[],onEdit:c,onDelete:g,isLoading:m}){return m?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((t,n)=>e.jsxs("div",{className:"border rounded-lg p-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},n))}):d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"No tasks found"}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Create your first task to get started"})]}):e.jsx("div",{className:"space-y-3",children:d.map(t=>{const n=V[t.status],l=W[t.priority],j=h.find(i=>i.id===t.projectId);return e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 line-clamp-1",children:t.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${n.dot}`}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${n.color}`,children:n.label})]}),e.jsxs("div",{className:`flex items-center gap-1 text-xs ${l.color}`,children:[e.jsx("span",{children:l.icon}),e.jsx("span",{children:l.label})]})]}),t.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-2 line-clamp-1",children:t.description})]}),e.jsxs(N,{children:[e.jsx(D,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 ml-2",children:e.jsx(z,{className:"h-4 w-4"})})}),e.jsxs(w,{align:"end",children:[e.jsxs(u,{onClick:()=>c(t),children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(u,{onClick:()=>g(t.id),className:"text-red-600",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-gray-500",children:[j&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Project:"}),e.jsx("span",{children:j.name})]}),t.startDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),e.jsxs("span",{children:["Start: ",A(t.startDate)]})]}),t.dueDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),e.jsxs("span",{children:["Due: ",A(t.dueDate)]})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["Created: ",A(t.createdAt)]})})]}),t.labels.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx(J,{className:"h-3 w-3 text-gray-400"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.labels.map(i=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-md",children:i},i))})]})]},t.id)})})}const re=function(){const[h,c]=k.useState(!1),[g,m]=k.useState(!1),[t,n]=k.useState(null),l=y.tasks.list.useQuery(),j=y.projects.list.useQuery(),i=y.tasks.create.useMutation(),b=y.tasks.update.useMutation(),M=y.tasks.delete.useMutation(),r=()=>{l.refetch()},C=async a=>{try{await i.mutateAsync({name:a.name,description:a.description,startDate:a.startDate,dueDate:a.dueDate,status:a.status,priority:a.priority,labels:a.labels,projectId:a.projectId,parentTaskId:a.parentTaskId}),c(!1),r()}catch(p){console.error("Failed to create task:",p)}},P=a=>{n(a),m(!0)},L=async a=>{if(t)try{await b.mutateAsync({id:t.id,name:a.name,description:a.description,startDate:a.startDate,dueDate:a.dueDate,status:a.status,priority:a.priority,labels:a.labels,projectId:a.projectId,parentTaskId:a.parentTaskId}),m(!1),n(null),r()}catch(p){console.error("Failed to update task:",p)}},T=async a=>{if(confirm("Are you sure you want to delete this task?"))try{await M.mutateAsync({id:a}),r()}catch(p){console.error("Failed to delete task:",p)}},f=(l.data||[]).map(a=>({...a,startDate:a.startDate?new Date(a.startDate):null,dueDate:a.dueDate?new Date(a.dueDate):null,labels:a.labels||[],createdAt:new Date(a.createdAt),updatedAt:new Date(a.updatedAt)})),v=(j.data||[]).map(a=>({id:a.id,name:a.name})),I=f.map(a=>({id:a.id,name:a.name})),s=t?{id:t.id,name:t.name,description:t.description||"",startDate:t.startDate?new Date(t.startDate).toISOString().split("T")[0]:"",dueDate:t.dueDate?new Date(t.dueDate).toISOString().split("T")[0]:"",status:t.status,priority:t.priority,labels:t.labels,projectId:t.projectId||void 0,parentTaskId:t.parentTaskId||void 0}:void 0;return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tasks"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Organize and track your tasks across projects"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:[e.jsx(R,{className:"h-4 w-4"}),"Add Task"]})]}),e.jsx(Y,{tasks:f,projects:v,onEdit:P,onDelete:T,isLoading:l.isLoading}),e.jsx(E,{open:h,onOpenChange:c,children:e.jsxs(O,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(F,{children:e.jsx(_,{children:"Create New Task"})}),e.jsx(B,{mode:"create",onSubmit:C,onCancel:()=>c(!1),projects:v,tasks:I,isLoading:i.isPending})]})}),e.jsx(E,{open:g,onOpenChange:a=>{m(a),a||n(null)},children:e.jsxs(O,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(F,{children:e.jsx(_,{children:"Edit Task"})}),e.jsx(B,{mode:"edit",initialData:s,onSubmit:L,onCancel:()=>{m(!1),n(null)},projects:v,tasks:I.filter(a=>a.id!==t?.id),isLoading:b.isPending})]})})]})};export{re as component};
