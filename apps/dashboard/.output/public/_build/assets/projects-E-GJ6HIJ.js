import{c as Q,j as e,B as P,P as M,i as V,u as q,R as i,t as v,S as H,e as I,f as A,g as E,h as k,k as O}from"./client-CIpQrpJ6.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],J=Q("Settings",G);function K(n){return n?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(n)):""}function W({projects:n,onEdit:f,onCreateProject:o,onProjectSettings:y,isLoading:c}){return c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((a,r)=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden animate-pulse",children:[e.jsx("div",{className:"h-48 bg-gray-200"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},r))}):n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"No projects found"}),e.jsx("img",{src:"https://storage.dev-0af.workers.dev/architect.png",alt:"Empty state",className:"w-1/4 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-400 text-sm mb-4",children:"Create your first project to get started"}),o&&e.jsxs(P,{onClick:o,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:[e.jsx(M,{className:"h-4 w-4"}),"Create Project"]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.map(a=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow group cursor-pointer",onClick:()=>f(a),children:[e.jsxs("div",{className:"relative h-48 bg-gradient-to-br from-blue-500 to-purple-600",children:[a.cover?e.jsx("img",{src:a.cover,alt:`${a.name} cover`,className:"w-full h-full object-cover",onError:r=>{const s=r.target;s.style.display="none"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"text-6xl opacity-20",children:a.icon||"üìÅ"})}),e.jsx("button",{className:"absolute top-3 right-3 p-2 bg-white/90 hover:bg-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",onClick:r=>{r.stopPropagation(),y?.(a.id)},title:"Project Settings",children:e.jsx(J,{className:"h-4 w-4 text-gray-700"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-2xl",children:a.icon||"üìÅ"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:a.name})})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Created ",K(a.createdAt)]})]})]},a.id)),n.length<6&&o&&Array.from({length:6-n.length}).map((a,r)=>e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors cursor-pointer group",onClick:o,children:[e.jsx("div",{className:"h-48 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"h-12 w-12 text-gray-400 group-hover:text-blue-500 transition-colors mx-auto mb-2"}),e.jsx("span",{className:"text-sm text-gray-500 group-hover:text-blue-600 transition-colors",children:"Add Project"})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6"})," ",e.jsx("div",{className:"h-5"})," "]})]},`placeholder-${r}`))]})}const Y=function(){const f=V(),o=q(),[y,c]=i.useState(!1),[a,r]=i.useState(!1),[s,u]=i.useState(null),[l,L]=i.useState(""),[m,N]=i.useState(1),h=6,b=v.projects.list.useQuery(),D=v.projects.create.useMutation(),S=v.projects.update.useMutation(),T=v.projects.delete.useMutation(),w=()=>{b.refetch()},F=async t=>{try{await D.mutateAsync({name:t.name,description:t.description,icon:t.icon,cover:t.cover,startDate:t.startDate,dueDate:t.dueDate,status:t.status,parentProjectId:t.parentProjectId}),c(!1),w()}catch(d){console.error("Failed to create project:",d)}},z=t=>{u(t),r(!0)},R=async t=>{if(s)try{await S.mutateAsync({id:s.id,name:t.name,description:t.description,icon:t.icon,cover:t.cover,startDate:t.startDate,dueDate:t.dueDate,status:t.status,parentProjectId:t.parentProjectId}),r(!1),u(null),w()}catch(d){console.error("Failed to update project:",d)}},_=async t=>{if(confirm("Are you sure you want to delete this project?"))try{await T.mutateAsync({id:t}),w()}catch(d){console.error("Failed to delete project:",d)}},U=t=>{f({to:`/project-manager/projects/${t}/settings`})},x=(b.data||[]).map(t=>({...t,startDate:t.startDate?new Date(t.startDate):null,dueDate:t.dueDate?new Date(t.dueDate):null,createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)})),g=i.useMemo(()=>l?x.filter(t=>t.name.toLowerCase().includes(l.toLowerCase())):x,[x,l]),j=Math.ceil(g.length/h),p=(m-1)*h,$=g.slice(p,p+h);i.useEffect(()=>{N(1)},[l]);const C=x.map(t=>({id:t.id,name:t.name})),B=s?{id:s.id,name:s.name,description:s.description||"",icon:s.icon||"üìÅ",cover:s.cover||"",startDate:s.startDate?new Date(s.startDate).toISOString().split("T")[0]:"",dueDate:s.dueDate?new Date(s.dueDate).toISOString().split("T")[0]:"",status:s.status,parentProjectId:s.parentProjectId||void 0}:void 0;return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Projects"})}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search projects...",value:l,onChange:t=>L(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"mb-6"}),e.jsx("div",{className:"min-h-[600px]",children:e.jsx(W,{projects:$,onEdit:z,onDelete:_,onCreateProject:()=>c(!0),onProjectSettings:U,isLoading:b.isLoading})}),j>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-xs text-gray-700",children:["Showing ",p+1," to ",Math.min(p+h,g.length)," of ",g.length," projects"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>N(t=>Math.max(t-1,1)),disabled:m===1,children:"Previous"}),e.jsxs("span",{className:"text-xs text-gray-600",children:["Page ",m," of ",j]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>N(t=>Math.min(t+1,j)),disabled:m===j,children:"Next"})]})]}),e.jsx(I,{open:y,onOpenChange:c,children:e.jsxs(A,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(E,{children:e.jsx(k,{children:"Create New Project"})}),e.jsx(O,{mode:"create",user:o,onSubmit:F,onCancel:()=>c(!1),projects:C,isLoading:D.isPending})]})}),e.jsx(I,{open:a,onOpenChange:t=>{r(t),t||u(null)},children:e.jsxs(A,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(E,{children:e.jsx(k,{children:"Edit Project"})}),e.jsx(O,{mode:"edit",user:o,initialData:B,onSubmit:R,onCancel:()=>{r(!1),u(null)},projects:C.filter(t=>t.id!==s?.id),isLoading:S.isPending})]})})]})};export{Y as component};
