import{r as i,u as h,b as x,j as e,O as j,a as c}from"./client-DTMXrvQ9.js";const y=function(){const[t,d]=i.useState(null),[u,g]=i.useState(!0),[l,m]=i.useState(!1),n=h(),o=x();i.useEffect(()=>{async function r(){console.log("=== CLIENT-SIDE AUTH CHECK START ===");try{console.log("1. Starting session check...");const a=await c.getSession();if(console.log("2. Session response:",a),!a.data?.user){console.log("3. No user found, redirecting to login"),n({to:"/login"});return}console.log("4. User found:",a.data.user);const s=a.data.user;d(s),o&&s.id&&(console.log("5. Identifying user with PostHog:",s.id),o.identify(s.id,{email:s.email,name:s.name,emailVerified:s.emailVerified,createdAt:s.createdAt}),o.capture("user_logged_in",{email:s.email,name:s.name}))}catch(a){console.error("5. Auth check error:",a),n({to:"/login"})}finally{g(!1)}}r()},[n,o]);const f=async()=>{m(!0);try{o&&t&&o.capture("user_logged_out",{email:t.email,name:t.name}),await c.signOut(),o&&o.reset(),n({to:"/login"})}catch(r){console.error("Logout error:",r),n({to:"/login"})}};return u?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):t?e.jsxs("div",{children:[e.jsx("nav",{className:"p-4 bg-gray-100 border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:t?.name||"Unknown User"}),e.jsx("div",{className:"text-gray-600",children:t?.email||"No email"})]}),t?.image&&e.jsx("img",{src:t.image,alt:"Profile",className:"w-8 h-8 rounded-full"}),e.jsx("button",{onClick:f,disabled:l,className:"px-3 py-1 text-sm bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",children:l?"Logging out...":"Logout"})]})]})}),e.jsx("main",{className:"p-4",children:e.jsx(j,{})})]}):null};export{y as component};
