import{jsx as t,jsxs as r}from"react/jsx-runtime";import{useQueryClient as f,useQuery as y,useMutation as x}from"@tanstack/react-query";import{Link as N}from"@tanstack/react-router";import{useState as c}from"react";const P=function(){const[l,o]=c(!1),[n,s]=c({name:"",description:""}),d=f(),{data:m,isLoading:u,isError:p,error:b}=y({queryKey:["projects"],queryFn:async()=>{const e=await fetch("/api/projects");if(!e.ok)throw new Error("Failed to fetch projects");return e.json()}}),a=x({mutationFn:async e=>{const i=await fetch("/api/projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!i.ok){const g=await i.json();throw new Error(g.error||"Failed to create project")}return i.json()},onSuccess:()=>{d.invalidateQueries({queryKey:["projects"]}),o(!1),s({name:"",description:""})}}),h=e=>{e.preventDefault(),a.mutate(n)};return u?t("div",{children:"Loading..."}):p?r("div",{children:["Error: ",b?.message]}):r("div",{className:"p-4",children:[r("div",{className:"flex justify-between items-center mb-6",children:[t("h1",{className:"text-2xl font-bold",children:"Projects"}),t("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Create Project"})]}),t("div",{className:"grid gap-4",children:m?.projects.map(e=>r(N,{to:"/project-manager/$projectSlug",params:{projectSlug:e.id},className:"block p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[t("h2",{className:"text-lg font-bold",children:e.name}),t("p",{children:e.description}),r("p",{className:"text-sm text-gray-500",children:["Tasks: ",e.tasks.length]})]},e.id))}),l&&t("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t("h2",{className:"text-xl font-bold mb-4",children:"Create New Project"}),r("form",{onSubmit:h,children:[r("div",{className:"mb-4",children:[t("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Name"}),t("input",{type:"text",id:"name",value:n.name,onChange:e=>s({...n,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r("div",{className:"mb-4",children:[t("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),t("textarea",{id:"description",value:n.description,onChange:e=>s({...n,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),r("div",{className:"flex justify-end gap-2",children:[t("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-100 transition-colors",children:"Cancel"}),t("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",disabled:a.isPending,children:a.isPending?"Creating...":"Create"})]})]})]})})]})};export{P as component};
